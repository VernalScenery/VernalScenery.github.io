<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>openLayer_learn | 春和景明的记事本</title><meta name="keywords" content="None"><meta name="author" content="Scenery"><meta name="copyright" content="Scenery"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="openLayer_learnObservable - 抽象基类 - 可观察类 Abstract base class; normally only used for creating subclasses and not instantiated in apps. An event target providing convenient methods for listener registra">
<meta property="og:type" content="article">
<meta property="og:title" content="openLayer_learn">
<meta property="og:url" content="https://vernalscenery.github.io/2024/07/18/openLayer_learn/index.html">
<meta property="og:site_name" content="春和景明的记事本">
<meta property="og:description" content="openLayer_learnObservable - 抽象基类 - 可观察类 Abstract base class; normally only used for creating subclasses and not instantiated in apps. An event target providing convenient methods for listener registra">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://vernalscenery.github.io/img/1.jpg">
<meta property="article:published_time" content="2024-07-17T17:57:10.000Z">
<meta property="article:modified_time" content="2024-07-25T09:37:52.515Z">
<meta property="article:author" content="Scenery">
<meta property="article:tag" content="None">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://vernalscenery.github.io/img/1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://vernalscenery.github.io/2024/07/18/openLayer_learn/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'openLayer_learn',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-25 17:37:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">春和景明的记事本</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">openLayer_learn</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-17T17:57:10.000Z" title="发表于 2024-07-18 01:57:10">2024-07-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-25T09:37:52.515Z" title="更新于 2024-07-25 17:37:52">2024-07-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">24.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>122分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="openLayer_learn"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="openLayer-learn"><a href="#openLayer-learn" class="headerlink" title="openLayer_learn"></a>openLayer_learn</h1><h2 id="Observable-抽象基类-可观察类"><a href="#Observable-抽象基类-可观察类" class="headerlink" title="Observable - 抽象基类 - 可观察类"></a>Observable - 抽象基类 - 可观察类</h2><blockquote>
<p>Abstract base class; normally only used for creating subclasses and not instantiated in apps. An event target providing convenient methods for listener registration and unregistration. A generic <code>change</code> event is always available through <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Observable-Observable.html#changed"><code>changed</code></a>.</p>
</blockquote>
<p><strong>可以实现 chang : 属性</strong></p>
<h3 id="Subclasses"><a href="#Subclasses" class="headerlink" title="Subclasses"></a>Subclasses</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="Fires-事件"><a href="#Fires-事件" class="headerlink" title="Fires(事件)"></a>Fires(事件)</h3><h4 id="chang-BaseEvent"><a href="#chang-BaseEvent" class="headerlink" title="chang(BaseEvent)"></a>chang(<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_events_Event-BaseEvent.html">BaseEvent</a>)</h4><p>Triggered when the revision counter is increased</p>
<p>这个 revision 即由 getRevision 获取的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通用更改事件。当修订计数器增加时触发。</span></span><br><span class="line">  map.on(<span class="string">&#x27;change&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event);</span><br><span class="line">    <span class="comment">//map对象的属性只要有改变，就会修改此对象的版本号，版本号变化了，此事件就会触发</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// change:size事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;change:size&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;size改变&#x27;</span>);</span><br><span class="line">    <span class="comment">//屏幕尺寸变化的回调</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// change:view事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;change:view&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;view改变&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// change:target事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;change:target&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;target改变&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// change:layerGroup事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;change:layergroup&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;target改变&#x27;</span>);</span><br><span class="line">    <span class="comment">//图层动态变化，图例动态变化</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="error-BaseEvent"><a href="#error-BaseEvent" class="headerlink" title="error(BaseEvent)"></a>error(<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_events_Event-BaseEvent.html">BaseEvent</a>)</h4><p>Triggered when an error occurs.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 地图发生错误触发</span></span><br><span class="line">  map.on(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Methods-方法"><a href="#Methods-方法" class="headerlink" title="Methods(方法)"></a>Methods(方法)</h3><h4 id="changed"><a href="#changed" class="headerlink" title="changed()"></a>changed()</h4><p>获取此对象的版本号</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取此对象的版本号。每次修改对象时，其版本号都会增加。</span></span><br><span class="line"><span class="keyword">let</span> revision = map.getRevision();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;getRevision1&#x27;</span>, revision);</span><br><span class="line">map.changed();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;getRevision12&#x27;</span>, map.getRevision());</span><br></pre></td></tr></table></figure>

<h4 id="dispatchEvent-event-gt-boolean-undefined"><a href="#dispatchEvent-event-gt-boolean-undefined" class="headerlink" title="dispatchEvent(event)=&gt; {boolean | undefined}"></a>dispatchEvent(event)=&gt; {boolean | undefined}</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> map.on(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// dispatchEvent即执行一下dblclick事件</span></span><br><span class="line">    map.dispatchEvent(<span class="string">&#x27;dblclick&#x27;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="getRevision-gt-number"><a href="#getRevision-gt-number" class="headerlink" title="getRevision()=&gt;{number}"></a>getRevision()=&gt;{number}</h4><p>获取版本号</p>
<h4 id="on-type-listener-、once-type-listener-、-un-type-listener"><a href="#on-type-listener-、once-type-listener-、-un-type-listener" class="headerlink" title="on(type, listener)、once(type, listener)、 un(type, listener)"></a>on(type, listener)、once(type, listener)、 un(type, listener)</h4><p>监听事件</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240722213956.png" alt="image.png"></p>
<h2 id="BaseObject-抽象基类"><a href="#BaseObject-抽象基类" class="headerlink" title="BaseObject - 抽象基类"></a>BaseObject - 抽象基类</h2><blockquote>
<p>Abstract base class; normally only used for creating subclasses and not instantiated in apps. Most non-trivial classes inherit from this.</p>
<p>它扩展了 <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Observable-Observable.html"><code>Observable</code></a> 可观察的属性，其中每个属性以及整个对象都是可观察的。</p>
<p>从此继承的类具有预定义属性，您可以向其中添加自己的属性。预定义属性在本文档中列为“可观察属性”，并具有自己的访问器；例如， <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html"><code>Map</code></a> 具有<code>target</code>属性，可使用 访问 <code>getTarget()</code>并使用 更改<code>setTarget()</code>。但是，并非所有属性都是可设置的。还有通用访问器<code>get()</code>和<code>set()</code>。例如，<code>get(&#39;target&#39;)</code>相当于<code>getTarget()</code>。</p>
<p>访问<code>set</code>器会触发更改事件，您可以通过注册侦听器来监控此事件。例如，<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_View-View.html"><code>View</code></a> 具有 <code>center</code>属性，因此<code>view.on(&#39;change:center&#39;, function(evt) &#123;...&#125;);</code>每当 center 属性的值发生变化时都会调用该函数。在函数内，<code>evt.target</code>将是视图，因此<code>evt.target.getCenter()</code> 将返回新的中心。</p>
<p>您可以使用 添加您自己的可观察属性 <code>object.set(&#39;prop&#39;, &#39;value&#39;)</code>，并使用 检索该属性<code>object.get(&#39;prop&#39;)</code>。您可以使用 监听该属性值的更改 <code>object.on(&#39;change:prop&#39;, listener)</code>。您可以使用 获取所有属性的列表 <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html#getProperties"><code>getProperties</code></a>。</p>
<p>Note that the observable properties are separate from standard JS properties. You can, for example, give your map object a title with <code>map.title=&#39;New title&#39;</code> and with <code>map.set(&#39;title&#39;, &#39;Another title&#39;)</code>. The first will be a <code>hasOwnProperty</code>; the second will appear in <code>getProperties()</code>. Only the second is observable.</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> BaseObject <span class="keyword">from</span> <span class="string">&#x27;ol/Object.js&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Subclasses-1"><a href="#Subclasses-1" class="headerlink" title="Subclasses"></a>Subclasses</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html">Feature</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Geolocation-Geolocation.html">Geolocation</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html">Map</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Overlay-Overlay.html">Overlay</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_View-View.html">View</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Attribution-Attribution.html">Attribution</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_FullScreen-FullScreen.html">FullScreen</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_MousePosition-MousePosition.html">MousePosition</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_OverviewMap-OverviewMap.html">OverviewMap</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Rotate-Rotate.html">Rotate</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ScaleLine-ScaleLine.html">ScaleLine</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ZoomSlider-ZoomSlider.html">ZoomSlider</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ZoomToExtent-ZoomToExtent.html">ZoomToExtent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Zoom-Zoom.html">Zoom</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_geom_Geometry-Geometry.html">Geometry</a><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_geom_GeometryCollection-GeometryCollection.html">GeometryCollection</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_geom_SimpleGeometry-SimpleGeometry.html">SimpleGeometry</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Interaction-Interaction.html">Interaction</a><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DblClickDragZoom-DblClickDragZoom.html">DblClickDragZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DoubleClickZoom-DoubleClickZoom.html">DoubleClickZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragAndDrop-DragAndDrop.html">DragAndDrop</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_KeyboardPan-KeyboardPan.html">KeyboardPan</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_KeyboardZoom-KeyboardZoom.html">KeyboardZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Link-Link.html">Link</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_MouseWheelZoom-MouseWheelZoom.html">MouseWheelZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Pointer-PointerInteraction.html">PointerInteraction</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Select-Select.html">Select</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Group-LayerGroup.html">LayerGroup</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html">Layer</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Source-Source.html">Source</a><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Image-ImageSource.html">ImageSource</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Tile-TileSource.html">TileSource</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Vector-VectorSource.html">VectorSource</a></li>
</ul>
</li>
</ul>
<h3 id="Extends"><a href="#Extends" class="headerlink" title="Extends"></a>Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Observable-Observable.html">Observable</a></li>
</ul>
<h3 id="Fires-事件-1"><a href="#Fires-事件-1" class="headerlink" title="Fires(事件)"></a>Fires(事件)</h3><h4 id="chang-BaseEvent-inherit"><a href="#chang-BaseEvent-inherit" class="headerlink" title="chang(BaseEvent)[inherit]"></a>chang(<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_events_Event-BaseEvent.html">BaseEvent</a>)[inherit]</h4><h4 id="error-BaseEvent-inherit"><a href="#error-BaseEvent-inherit" class="headerlink" title="error(BaseEvent)[inherit]"></a>error(<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_events_Event-BaseEvent.html">BaseEvent</a>)[inherit]</h4><h4 id="propertychange-ObjectEvent"><a href="#propertychange-ObjectEvent" class="headerlink" title="propertychange(ObjectEvent)"></a>propertychange(<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a>)</h4><p>Triggered when a property is changed.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当属性改变时触发</span></span><br><span class="line">  map.on(<span class="string">&#x27;propertychange&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;propertychange&#x27;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Methods-方法-1"><a href="#Methods-方法-1" class="headerlink" title="Methods(方法)"></a>Methods(方法)</h3><h4 id="changed-inherit"><a href="#changed-inherit" class="headerlink" title="changed() [inherit]"></a>changed() [inherit]</h4><h4 id="on-type-listener-、once-type-listener-、-un-type-listener-inherit"><a href="#on-type-listener-、once-type-listener-、-un-type-listener-inherit" class="headerlink" title="on(type, listener)、once(type, listener)、 un(type, listener)[inherit]"></a>on(type, listener)、once(type, listener)、 un(type, listener)[inherit]</h4><h4 id="getRevision-gt-number-inherit"><a href="#getRevision-gt-number-inherit" class="headerlink" title="getRevision()=&gt;{number}[inherit]"></a>getRevision()=&gt;{number}[inherit]</h4><h4 id="get-key"><a href="#get-key" class="headerlink" title="get(key)"></a>get(key)</h4><p>Gets a value.</p>
<h4 id="getKeys-gt-Array-lt-string-gt"><a href="#getKeys-gt-Array-lt-string-gt" class="headerlink" title="getKeys()=&gt; {Array.&lt;string&gt;}"></a>getKeys()=&gt; {Array.&lt;string&gt;}</h4><p>Get a list of object property names.</p>
<h4 id="getProperties-gt-Object-lt-string-gt"><a href="#getProperties-gt-Object-lt-string-gt" class="headerlink" title="getProperties()=&gt;{Object.&lt;string, * &gt; }"></a>getProperties()=&gt;{Object.&lt;string, * &gt; }</h4><p>Get an object of all property names and values.</p>
<h4 id="set-key-value-silent"><a href="#set-key-value-silent" class="headerlink" title="set(key, value, silent)"></a>set(key, value, silent)</h4><p>Sets a value.</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240722221042.png" alt="image.png"></p>
<p><strong>silent 设置为 true 指 在不触发事件的情况下更新</strong></p>
<h4 id="setProperties-values-silent"><a href="#setProperties-values-silent" class="headerlink" title="setProperties(values, silent)"></a>setProperties(values, silent)</h4><p>Sets a collection of key-value pairs. Note that this changes any existing properties and adds new ones (it does not remove any existing properties).</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240722221223.png" alt="image.png"></p>
<h4 id="unset-key-silent"><a href="#unset-key-silent" class="headerlink" title="unset(key, silent)"></a>unset(key, silent)</h4><p>Unsets a property.</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240722221253.png" alt="image.png"></p>
<h2 id="Collection-JS-数组的扩展"><a href="#Collection-JS-数组的扩展" class="headerlink" title="Collection - JS 数组的扩展"></a>Collection - JS 数组的扩展</h2><blockquote>
<p>标准 JS 数组的扩展版本，添加了方便的操作方法。添加和删除对 Collection 的更改会触发 Collection 事件。请注意，这不包括对 Collection_内_对象的更改；它们会触发相应对象的事件，而不是整个 Collection 的事件。</p>
</blockquote>
<h3 id="new-Collection-array-options"><a href="#new-Collection-array-options" class="headerlink" title="new Collection(array, options)"></a>new Collection(array, options)</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721809982425.png" alt="QQ_1721809982425.png"></p>
<h3 id="Fires"><a href="#Fires" class="headerlink" title="Fires"></a>Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721810023693.png"></p>
<h3 id="Extends-1"><a href="#Extends-1" class="headerlink" title="Extends"></a>Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="Observable-Properties"><a href="#Observable-Properties" class="headerlink" title="Observable Properties"></a>Observable Properties</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724163416.png" alt="image.png"></p>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724163432.png" alt="image.png"></p>
<p><strong>注意几个方法：</strong></p>
<ul>
<li><code>insertAt(index, elem)</code> ：Insert an element at the provided index.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721810153600.png" alt="QQ_1721810153600.png"></li>
<li><code>item(index)=&gt;&#123;T&#125;</code> : Get the element at the provided index.</li>
<li><code>remove(elem)=&gt;&#123;T | undefined&#125;</code> : Remove the first occurrence of an element from the collection.</li>
<li><code>removeAt(index)&#123;T | undefined&#125;</code> : Remove the element at the provided index and return it. Return <code>undefined</code> if the collection does not contain this index.</li>
<li><code>setAt(index, elem)</code> : Set the element at the provided index.</li>
</ul>
<h2 id="Map-地图"><a href="#Map-地图" class="headerlink" title="Map - 地图"></a>Map - 地图</h2><blockquote>
<p>The map is the core component of OpenLayers. For a map to render, a view, one or more layers, and a target container are needed:</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span><br><span class="line">  <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span><br><span class="line">    <span class="attr">center</span>: [<span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">    <span class="attr">zoom</span>: <span class="number">1</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">layers</span>: [</span><br><span class="line">    <span class="keyword">new</span> TileLayer(&#123;</span><br><span class="line">      <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The above snippet creates a map using a <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Tile-TileLayer.html"><code>TileLayer</code></a> to display <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_OSM-OSM.html"><code>OSM</code></a> OSM data and render it to a DOM element with the id <code>map</code>.</p>
<p>The constructor places a viewport container (with CSS class name <code>ol-viewport</code>) in the target element (see <code>getViewport()</code>), and then two further elements within the viewport: one with CSS class name <code>ol-overlaycontainer-stopevent</code> for controls and some overlays, and one with CSS class name <code>ol-overlaycontainer</code> for other overlays (see the <code>stopEvent</code> option of <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Overlay-Overlay.html"><code>Overlay</code></a> for the difference). The map itself is placed in a further element within the viewport.</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721694433855.png" alt="QQ_1721694433855.png"></p>
<p>Layers are stored as a <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html"><code>Collection</code></a> in layerGroups. A top-level group is provided by the library. This is what is accessed by <code>getLayerGroup</code> and <code>setLayerGroup</code>. Layers entered in the options are added to this group, and <code>addLayer</code> and <code>removeLayer</code> change the layer collection in the group. <code>getLayers</code> is a convenience function for <code>getLayerGroup().getLayers()</code>. Note that <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Group-LayerGroup.html"><code>LayerGroup</code></a> is a subclass of <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html"><code>BaseLayer</code></a>, so layers entered in the options or added with <code>addLayer</code> can be groups, which can contain further groups, and so on.</p>
<h3 id="Extends-2"><a href="#Extends-2" class="headerlink" title="Extends"></a>Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="new-Map-options"><a href="#new-Map-options" class="headerlink" title="new Map(options)"></a>new Map(options)</h3><ul>
<li><code>target</code><br>地图的容器，元素本身或 id 元素的 。如果在构建时未指定，则 module:ol/Map~Map # setTarget 必须调用以渲染地图 。如果通过元素传递，则容器可以位于辅助文档中。</li>
<li><code>Layers </code><br>如果未定义，将渲染没有图层的地图。请注意，图层按提供的顺序呈现，因此，例如，如果您希望矢量图层出现在切片图层的顶部，则它必须位于切片图层之后。</li>
<li><code>view</code><br>地图视图。除非在构造时或通过 指定，否则将不会获取图层源 module:ol/Map~Map #setView 。</li>
<li><code>overlays</code><br>最初添加到地图的叠加层。默认情况下，不添加叠加层。</li>
<li><code>interactions</code><br>最初添加到地图的交互。如果未指定， module:ol/interaction.defaults 则使用。</li>
<li><code>controls</code><br>最初添加到地图的控件。如果未指定， module:ol/control.defaults 则使用。</li>
<li><code>pixelRatio</code><br>设备上物理像素与设备无关像素（下降）之间的比率。（默认为 window.devicePixelRatio）Window 接口的 devicePixelRatio 返回当前显示设备的物理像素分辨率与 CSS 像素分辨率之比。此值也可以解释为像素大小的比率：一个 CSS 像素的大小与一个物理像素的大小。 简单来说，它告诉浏览器应使用多少屏幕实际像素来绘制单个 CSS 像素。</li>
<li><code>keyboardEventTarget</code><br>监听键盘事件的元素。这确定何时触发 KeyboardPan 和 KeyboardZoom 交互。例如，如果此选项设置为 document 键盘交互将始终触发。如果未指定此选项，则监听键盘事件的元素是地图目标（即用户提供的地图 div）。如果不是 document，则需要聚焦目标元素才能发出关键事件，要求目标元素具有 tabindex 属性。</li>
<li><code>maxTilesLoading</code><br>同时加载的最大数量的瓦片。（默认为 16）moveTolerance 光标必须移动的最小距离（以像素为单位）才能被检测为地图移动事件而不是单击。增加此值可以更轻松地单击地图。（默认为 1）</li>
</ul>
<h3 id="Fires-事件-2"><a href="#Fires-事件-2" class="headerlink" title="Fires(事件)"></a>Fires(事件)</h3><h4 id="BaseEvent"><a href="#BaseEvent" class="headerlink" title="BaseEvent"></a><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_events_Event-BaseEvent.html">BaseEvent</a></h4><ul>
<li><code>change</code></li>
<li><code>error</code></li>
</ul>
<h4 id="ObjectEvent"><a href="#ObjectEvent" class="headerlink" title="ObjectEvent"></a><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a></h4><ul>
<li>`change:layerGroup </li>
<li><code>change:size</code> </li>
<li><code>change:target</code> </li>
<li><code>change:view</code> </li>
<li><code>propertychang</code></li>
</ul>
<h4 id="MapBrowserEvent"><a href="#MapBrowserEvent" class="headerlink" title="MapBrowserEvent"></a><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html">MapBrowserEvent</a></h4><ul>
<li><code>click</code></li>
<li>`dblclick</li>
<li><code>singleclick</code></li>
<li><code>pointerdrag</code> : Triggered when a pointer is dragged.</li>
<li><code>pointermove</code> : Triggered when a pointer is moved. Note that on touch devices this is triggered when the map is panned, so is not the same as mousemove.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// click事件,双击触发两次,点多少次都会触发</span></span><br><span class="line">  map.on(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//双击事件，没有拖动</span></span><br><span class="line">  map.on(<span class="string">&#x27;dblclick&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;dblclick&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//真正的单击，没有拖动和双击。请注意，此事件会延迟 250 毫秒，以确保它不是双击。</span></span><br><span class="line">  map.on(<span class="string">&#x27;singleclick&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;singleclick &#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 触摸设备事件 */</span></span><br><span class="line"><span class="comment">// 地图触摸拖拽事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;pointerdrag&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;pointerdrag&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 地图触摸移动事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;pointermove&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;pointermove&#x27;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="MapEvent"><a href="#MapEvent" class="headerlink" title="MapEvent"></a><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_MapEvent-MapEvent.html">MapEvent</a></h4><ul>
<li><code>loadstart</code> : Triggered when loading of additional map data has completed.</li>
<li><code>loadend</code> : Triggered when loading of additional map data (tiles, images, features) starts.</li>
<li><code>movestart</code> : Triggered when the map starts moving.</li>
<li><code>moveend</code> : Triggered after the map is moved.</li>
<li><code>postrender</code> : Triggered after a map frame is rendered.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 地图开始移动事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;movestart&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;movestart &#x27;</span>, event);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 地图移动结束事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;moveend&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;moveend&#x27;</span>, event);</span><br><span class="line">  &#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//地图渲染完成触发</span></span><br><span class="line">  map.on(<span class="string">&#x27;postrender&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;postrender&#x27;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="RenderEvent"><a href="#RenderEvent" class="headerlink" title="RenderEvent"></a><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_render_Event-RenderEvent.html">RenderEvent</a></h4><ul>
<li><code>precompose</code><br> Triggered before layers are composed. When dispatched by the map, the event object will not have a context set. When dispatched by a layer, the event object will have a context set. Only WebGL layers currently dispatch this event.</li>
<li><code>postcompose</code><br>Triggered after layers are composed. When dispatched by the map, the event object will not have a context set. When dispatched by a layer, the event object will have a context set. Only WebGL layers currently dispatch this event.</li>
<li><code>rendercomplete</code><br> Triggered when rendering is complete, i.e. all sources and tiles have finished loading for the current viewport, and all tiles are faded in. The event object will not have a context set.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在渲染图层之前触发，没有设置上下文context</span></span><br><span class="line">  <span class="comment">//监听的是渲染的图层layer</span></span><br><span class="line">  map.on(<span class="string">&#x27;precompose&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;precompose&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//所有图层渲染完后触发，没有设置上下文context</span></span><br><span class="line">  <span class="comment">//监听的是渲染的图层layer</span></span><br><span class="line">  map.on(<span class="string">&#x27;postcompose&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;postcompose&#x27;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Observable-Properties-1"><a href="#Observable-Properties-1" class="headerlink" title="Observable Properties"></a>Observable Properties</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Settable</th>
<th><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a> type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>layerGroup</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Group-LayerGroup.html">LayerGroup</a></td>
<td>yes</td>
<td><code>change:layergroup</code></td>
<td>A layer group containing the layers in this map.</td>
</tr>
<tr>
<td><code>size</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_size.html#~Size">Size</a> | undefined</td>
<td>yes</td>
<td><code>change:size</code></td>
<td>The size in pixels of the map in the DOM.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>yes</td>
<td><code>change:target</code></td>
<td>The Element or id of the Element that the map is rendered in.</td>
</tr>
<tr>
<td><code>view</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_View-View.html">View</a></td>
<td>yes</td>
<td><code>change:view</code></td>
<td>The view that controls this map.</td>
</tr>
</tbody></table>
<h3 id="Methods-方法-2"><a href="#Methods-方法-2" class="headerlink" title="Methods(方法)"></a>Methods(方法)</h3><h4 id="add"><a href="#add" class="headerlink" title="add"></a>add</h4><ul>
<li><code>addControl(control)</code></li>
<li><code>addInteraction(interaction)</code></li>
<li><code>addLayer(layer)</code></li>
<li><code>addOverlay(overlay)</code></li>
</ul>
<h4 id="get"><a href="#get" class="headerlink" title="get"></a>get</h4><ul>
<li>getControls() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a> &lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a> &gt;}</li>
<li>getInteractions() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a> &lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Interaction-Interaction.html">Interaction</a> &gt;}</li>
<li>getLayers() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a> &lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a> &gt;}</li>
<li>getLayerGroup() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Group-LayerGroup.html">LayerGroup</a>}</li>
<li>getAllLayers() =&gt; {Array&lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html">Layer</a> &gt;}</li>
<li>getOverlays() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a> &lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Overlay-Overlay.html">Overlay</a> &gt;}</li>
<li>getOverlayById(id) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Overlay-Overlay.html">Overlay</a> | null}</li>
<li>getSize() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_size.html#~Size">Size</a> | undefined}</li>
<li>getTarget() =&gt; {HTMLElement | string | undefined}</li>
<li>getTargetElement() =&gt; {HTMLElement}</li>
<li>getView() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_View-View.html">View</a>}</li>
<li>getViewport() =&gt; {HTMLElement}</li>
</ul>
<h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4><ul>
<li>setLayers(layers)</li>
<li>setLayerGroup(layerGroup)</li>
<li>setSize(size)</li>
<li>setTarget(target)</li>
<li>setView(view)</li>
</ul>
<h4 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h4><ul>
<li>removeControl(control) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a> | undefined}</li>
<li>removeInteraction(interaction) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Interaction-Interaction.html">Interaction</a> | undefined}</li>
<li>removeLayer(layer) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a> | undefined}</li>
<li>removeOverlay(overlay) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Overlay-Overlay.html">Overlay</a> | undefined}</li>
</ul>
<h4 id="像素与坐标"><a href="#像素与坐标" class="headerlink" title="像素与坐标"></a>像素与坐标</h4><ul>
<li><p>getEventPixel(event) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_pixel.html#~Pixel">Pixel</a>}</p>
<blockquote>
<p>Returns the map pixel position for a browser event relative to the viewport.</p>
</blockquote>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mapDom.value?.addEventListener(<span class="string">&#x27;mousemove&#x27;</span>, <span class="function">(<span class="params">event: MouseEvent</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 获取到地图鼠标的位置</span></span><br><span class="line">  mousePosition = map.getEventPixel(event);</span><br><span class="line">  <span class="comment">// 鼠标移动时强制渲染地图</span></span><br><span class="line">  map.render();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>getEventCoordinate(event) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~Coordinate">Coordinate</a>}</p>
<blockquote>
<p>Returns the coordinate in user projection for a browser event.</p>
</blockquote>
</li>
<li><p>getCoordinateFromPixel(pixel) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~Coordinate">Coordinate</a>}</p>
<blockquote>
<p>Get the coordinate for a given pixel. This returns a coordinate in the user projection.</p>
</blockquote>
</li>
<li><p>getPixelFromCoordinate(coordinate) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_pixel.html#~Pixel">Pixel</a>}</p>
<blockquote>
<p>Get the pixel for a coordinate. This takes a coordinate in the user projection and returns the corresponding pixel.</p>
</blockquote>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取到当前视口的像素</span></span><br><span class="line">    <span class="keyword">let</span> eventPixel = map.getEventPixel(event.originalEvent);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;getEventPixel&#x27;</span>, eventPixel);</span><br><span class="line">    <span class="comment">//获取指定事件的投影坐标</span></span><br><span class="line">    <span class="keyword">let</span> eventCoordinate = map.getEventCoordinate(event.originalEvent);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;getEventCoordinate&#x27;</span>, eventCoordinate);</span><br><span class="line">    <span class="comment">//获取给定像素的投影坐标</span></span><br><span class="line">    <span class="keyword">let</span> coordinateFromPixel = map.getCoordinateFromPixel(event.pixel);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;getCoordinateFromPixel&#x27;</span>, coordinateFromPixel);</span><br><span class="line">    <span class="comment">//获取指定坐标的像素。这需要用户投影中的坐标并返回相应的像素</span></span><br><span class="line">    <span class="keyword">let</span> pixelFromCoordinate = map.getPixelFromCoordinate([<span class="number">113.35275651421398</span>, <span class="number">23.12185264976067</span>]);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;getPixelFromCoordinate&#x27;</span>, pixelFromCoordinate);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>getFeaturesAtPixel(pixel, options) =&gt; {Array&lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Feature.html#~FeatureLike">FeatureLike</a> &gt;}</p>
<blockquote>
<p>Get all features that intersect a pixel on the viewport.</p>
</blockquote>
</li>
<li><p>hasFeatureAtPixel(pixel, options) =&gt; {boolean}</p>
<blockquote>
<p>Detect if features intersect a pixel on the viewport. Layers included in the detection can be configured through the <code>layerFilter</code> option.</p>
</blockquote>
</li>
<li><p>forEachFeatureAtPixel(pixel, callback, opt_options) =&gt; {T | undefined}<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723091146.png" alt="image.png"></p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取与视口上的像素相交的所有要素。</span></span><br><span class="line">    <span class="keyword">let</span> feature = map.getFeaturesAtPixel(event.pixel);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;getFeaturesAtPixel&#x27;</span>, feature);</span><br><span class="line">    map.on(<span class="string">&#x27;singleclick&#x27;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//检测与视口上的像素相交的featrue</span></span><br><span class="line">      <span class="keyword">let</span> features: FeatureLike[] = [];</span><br><span class="line">      map.forEachFeatureAtPixel(</span><br><span class="line">        event.pixel,</span><br><span class="line">        <span class="function">(<span class="params">feature, layer</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(event, feature, layer);</span><br><span class="line">          features.push(feature);</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">layerFilter</span>: <span class="function"><span class="keyword">function</span> (<span class="params">layer</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//图层过滤</span></span><br><span class="line">            <span class="keyword">return</span> layer.get(<span class="string">&#x27;name&#x27;</span>) === <span class="string">&#x27;gz&#x27;</span>;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">hitTolerance</span>: <span class="number">0</span>, <span class="comment">//以 css 像素为单位的命中检测容差。将检查给定位置周围半径内的像素的featrue。</span></span><br><span class="line">          <span class="attr">checkWrapped</span>: <span class="literal">true</span>, <span class="comment">//将检查 +/- 1 世界宽度范围内的包裹几何图形</span></span><br><span class="line">        &#125;,</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><ul>
<li><p>render()</p>
<blockquote>
<p>Request a map rendering (at the next animation frame).</p>
</blockquote>
</li>
<li><p>renderSync()</p>
<blockquote>
<p>Requests an immediate render in a synchronous manner.</p>
</blockquote>
</li>
<li><p>updateSize()</p>
<blockquote>
<p>Force a recalculation of the map viewport size. This should be called when third-party code changes the size of the map viewport.</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//强制重新计算地图视口大小</span></span><br><span class="line"></span><br><span class="line">  map.updateSize();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//在下一个动画帧请求地图渲染</span></span><br><span class="line"></span><br><span class="line">  map.render();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//以同步方式请求立即渲染</span></span><br><span class="line"></span><br><span class="line">  map.renderSync();</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="View-视图"><a href="#View-视图" class="headerlink" title="View - 视图"></a>View - 视图</h2><blockquote>
<p>A View object represents a simple 2D view of the map.<br>This is the object to act upon to change the center, resolution, and rotation of the map.<br>A View has a <code>projection</code>. The projection determines the coordinate system of the center, and its units determine the units of the resolution (projection units per pixel). The default projection is Web Mercator (EPSG:3857).</p>
</blockquote>
<h3 id="new-View-options"><a href="#new-View-options" class="headerlink" title="new View(options)"></a>new View(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>center</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~Coordinate">Coordinate</a> | undefined</td>
<td>The initial center for the view. If a user projection is not set, the coordinate system for the center is specified with the <code>projection</code> option. Layer sources will not be fetched if this is not set, but the center can be set later with <code>#setCenter</code>.</td>
</tr>
<tr>
<td><code>constrainRotation</code></td>
<td>boolean | number (defaults to true)</td>
<td>Rotation constraint. <code>false</code> means no constraint. <code>true</code> means no constraint, but snap to zero near zero. A number constrains the rotation to that number of values. For example, <code>4</code> will constrain the rotation to 0, 90, 180, and 270 degrees.</td>
</tr>
<tr>
<td><code>enableRotation</code></td>
<td>boolean (defaults to true)</td>
<td>Enable rotation. If <code>false</code>, a rotation constraint that always sets the rotation to zero is used. The <code>constrainRotation</code> option has no effect if <code>enableRotation</code> is <code>false</code>.</td>
</tr>
<tr>
<td><code>extent</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a> | undefined</td>
<td>The extent that constrains the view, in other words, nothing outside of this extent can be visible on the map.</td>
</tr>
<tr>
<td><code>constrainOnlyCenter</code></td>
<td>boolean (defaults to false)</td>
<td>If true, the extent constraint will only apply to the view center and not the whole extent.</td>
</tr>
<tr>
<td><code>smoothExtentConstraint</code></td>
<td>boolean (defaults to true)</td>
<td>If true, the extent constraint will be applied smoothly, i.e. allow the view to go slightly outside of the given <code>extent</code>.</td>
</tr>
<tr>
<td><code>maxResolution</code></td>
<td>number | undefined</td>
<td>The maximum resolution used to determine the resolution constraint. It is used together with <code>minResolution</code> (or <code>maxZoom</code>) and <code>zoomFactor</code>. If unspecified it is calculated in such a way that the projection’s validity extent fits in a 256x256 px tile. If the projection is Spherical Mercator (the default) then <code>maxResolution</code> defaults to <code>40075016.68557849 / 256 = 156543.03392804097</code>.</td>
</tr>
<tr>
<td><code>minResolution</code></td>
<td>number | undefined</td>
<td>The minimum resolution used to determine the resolution constraint. It is used together with <code>maxResolution</code> (or <code>minZoom</code>) and <code>zoomFactor</code>. If unspecified it is calculated assuming 29 zoom levels (with a factor of 2). If the projection is Spherical Mercator (the default) then <code>minResolution</code> defaults to <code>40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253</code>.</td>
</tr>
<tr>
<td><code>maxZoom</code></td>
<td>number (defaults to 28)</td>
<td>The maximum zoom level used to determine the resolution constraint. It is used together with <code>minZoom</code> (or <code>maxResolution</code>) and <code>zoomFactor</code>. Note that if <code>minResolution</code> is also provided, it is given precedence over <code>maxZoom</code>.</td>
</tr>
<tr>
<td><code>minZoom</code></td>
<td>number (defaults to 0)</td>
<td>The minimum zoom level used to determine the resolution constraint. It is used together with <code>maxZoom</code> (or <code>minResolution</code>) and <code>zoomFactor</code>. Note that if <code>maxResolution</code> is also provided, it is given precedence over <code>minZoom</code>.</td>
</tr>
<tr>
<td><code>multiWorld</code></td>
<td>boolean (defaults to false)</td>
<td>If <code>false</code> the view is constrained so only one world is visible, and you cannot pan off the edge. If <code>true</code> the map may show multiple worlds at low zoom levels. Only used if the <code>projection</code> is global. Note that if <code>extent</code> is also provided it is given precedence.</td>
</tr>
<tr>
<td><code>constrainResolution</code></td>
<td>boolean (defaults to false)</td>
<td>If true, the view will always animate to the closest zoom level after an interaction; false means intermediary zoom levels are allowed.</td>
</tr>
<tr>
<td><code>smoothResolutionConstraint</code></td>
<td>boolean (defaults to true)</td>
<td>If true, the resolution min/max values will be applied smoothly, i. e. allow the view to exceed slightly the given resolution or zoom bounds.</td>
</tr>
<tr>
<td><code>showFullExtent</code></td>
<td>boolean (defaults to false)</td>
<td>Allow the view to be zoomed out to show the full configured extent. By default, when a view is configured with an extent, users will not be able to zoom out so the viewport exceeds the extent in either dimension. This means the full extent may not be visible if the viewport is taller or wider than the aspect ratio of the configured extent. If showFullExtent is true, the user will be able to zoom out so that the viewport exceeds the height or width of the configured extent, but not both, allowing the full extent to be shown.</td>
</tr>
<tr>
<td><code>projection</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_proj.html#~ProjectionLike">ProjectionLike</a> (defaults to ‘EPSG:3857’)</td>
<td>The projection. The default is Spherical Mercator.</td>
</tr>
<tr>
<td><code>resolution</code></td>
<td>number | undefined</td>
<td>The initial resolution for the view. The units are <code>projection</code> units per pixel (e.g. meters per pixel). An alternative to setting this is to set <code>zoom</code>. Layer sources will not be fetched if neither this nor <code>zoom</code> are defined, but they can be set later with <code>#setZoom</code> or <code>#setResolution</code>.</td>
</tr>
<tr>
<td><code>resolutions</code></td>
<td>Array.<number> | undefined</td>
<td>Resolutions that determine the zoom levels if specified. The index in the array corresponds to the zoom level, therefore the resolution values have to be in descending order. It also constrains the resolution by the minimum and maximum value. If set the <code>maxResolution</code>, <code>minResolution</code>, <code>minZoom</code>, <code>maxZoom</code>, and <code>zoomFactor</code> options are ignored.</td>
</tr>
<tr>
<td><code>rotation</code></td>
<td>number (defaults to 0)</td>
<td>The initial rotation for the view in radians (positive rotation clockwise, 0 means North).</td>
</tr>
<tr>
<td><code>zoom</code></td>
<td>number | undefined</td>
<td>Only used if <code>resolution</code> is not defined. Zoom level used to calculate the initial resolution for the view.</td>
</tr>
<tr>
<td><code>zoomFactor</code></td>
<td>number (defaults to 2)</td>
<td>The zoom factor used to compute the corresponding resolution.</td>
</tr>
<tr>
<td><code>padding</code></td>
<td>Array.<number> (defaults to [0, 0, 0, 0])</td>
<td>Padding (in css pixels). If the map viewport is partially covered with other content (overlays) along its edges, this setting allows to shift the center of the viewport away from that content. The order of the values is top, right, bottom, left.</td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> view = <span class="keyword">new</span> View(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>], <span class="comment">//视图中心位置</span></span><br><span class="line">    <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>, <span class="comment">//指定投影,84参考系投影</span></span><br><span class="line">    <span class="attr">zoom</span>: <span class="number">12</span>, <span class="comment">//缩放到的级别</span></span><br><span class="line">    <span class="attr">constrainRotation</span>: <span class="literal">false</span>, <span class="comment">//true/false没有约束，4将旋转限制为 0、90、180 和 270 度</span></span><br><span class="line">    <span class="attr">enableRotation</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">constrainOnlyCenter</span>: <span class="literal">false</span>, <span class="comment">// 如果为 true，则范围约束将仅适用于视图中心而不是整个范围</span></span><br><span class="line">    <span class="attr">extent</span>: [-<span class="number">180.0</span>, <span class="number">0.0</span>, <span class="number">180.0</span>, <span class="number">90.0</span>], <span class="comment">// 限制视图的范围 [左下角经度，左下角纬度，右上角经度，右上角纬度]</span></span><br><span class="line">    <span class="attr">smoothExtentConstraint</span>: <span class="literal">true</span>, <span class="comment">// 如果为true，范围约束将被平滑地应用，即允许视图稍微超出给定的extent</span></span><br><span class="line">    <span class="attr">maxResolution</span>: <span class="number">256</span>, <span class="comment">// 如果未指定，则以投影的有效范围适合 256x256 像素图块的方式计算</span></span><br><span class="line">    <span class="attr">minResolution</span>: <span class="number">256</span>, <span class="comment">// 如果未指定，则以投影的有效范围适合 256x256 像素图块的方式计算</span></span><br><span class="line">    <span class="attr">maxZoom</span>: <span class="number">5</span>, <span class="comment">//用于确定分辨率约束的最大缩放级别</span></span><br><span class="line">    <span class="attr">minZoom</span>: <span class="number">0</span>, <span class="comment">//用于确定分辨率约束的最小缩放级别</span></span><br><span class="line">    <span class="attr">multiWorld</span>: <span class="literal">false</span>, <span class="comment">//如果false视图受到约束，因此只有一个世界可见，并且您无法平移边缘。如果true地图可能以低缩放级别显示多个世界</span></span><br><span class="line">    <span class="attr">constrainResolution</span>: <span class="literal">false</span>, <span class="comment">//如果为 true，则视图将始终在交互后以最接近的缩放级别进行动画处理；false 表示允许中间缩放级别。</span></span><br><span class="line">    <span class="attr">smoothResolutionConstraint</span>: <span class="literal">true</span>, <span class="comment">//如果为 true，则视图将始终在交互后以最接近的缩放级别进行动画处理；false 表示允许中间缩放级别。</span></span><br><span class="line">    <span class="attr">showFullExtent</span>: <span class="literal">true</span>, <span class="comment">//允许缩小视图以显示完整的配置范围</span></span><br><span class="line">    <span class="attr">resolution</span>: <span class="number">2</span>, <span class="comment">//视图的初始分辨率。单位是projection每像素的单位（例如每像素米</span></span><br><span class="line">    <span class="attr">resolutions</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">30</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">2</span>], <span class="comment">//指定缩放级别的分辨率,数组中的索引对应于缩放级别，因此分辨率值必须按降序排列。</span></span><br><span class="line">    <span class="attr">rotation</span>: <span class="built_in">Math</span>.PI / <span class="number">2</span>, <span class="comment">//以弧度为单位的视图初始旋转（顺时针旋转，0 表示北）</span></span><br><span class="line">    <span class="attr">zoomFactor</span>: <span class="number">2</span>, <span class="comment">//用于计算相应分辨率的缩放因子</span></span><br><span class="line">    <span class="attr">padding</span>: [<span class="number">350</span>, <span class="number">150</span>, <span class="number">150</span>, <span class="number">150</span>], <span class="comment">//填充（以 css 像素为单位）顺序是上、右、下、左,如果地图视口沿其边缘部分被其他内容（覆盖）覆盖，则此设置允许将视口的中心从该内容移开</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Extends-3"><a href="#Extends-3" class="headerlink" title="Extends"></a>Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="Observable-Properties-2"><a href="#Observable-Properties-2" class="headerlink" title="Observable Properties"></a>Observable Properties</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723101140.png" alt="image.png"></p>
<h3 id="Fire"><a href="#Fire" class="headerlink" title="Fire"></a>Fire</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723101103.png" alt="image.png"></p>
<h3 id="Methods-1"><a href="#Methods-1" class="headerlink" title="Methods"></a>Methods</h3><h4 id="adjust"><a href="#adjust" class="headerlink" title="adjust"></a>adjust</h4><blockquote>
<p>opt_anchor 为锚点(可选值)<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723101436.png" alt="image.png"></p>
</blockquote>
<ul>
<li>adjustCenter(deltaCoordinates)</li>
<li>adjustResolution(ratio, opt_anchor)</li>
<li>adjustRotation(delta, opt_anchor)</li>
<li>adjustZoom(delta, opt_anchor)</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    view.adjustCenter([-<span class="number">10</span>, <span class="number">3</span>]); <span class="comment">// 将相对坐标添加到视图的中心</span></span><br><span class="line">    view.adjustResolution(<span class="number">3</span>) <span class="comment">//将视图分辨率乘以一个比率</span></span><br><span class="line">    view.adjustRotation(<span class="built_in">Math</span>.PI/<span class="number">2</span>,[<span class="number">130</span>,<span class="number">25</span>])<span class="comment">//向视图旋转添加一个值, [130,25]为锚点</span></span><br><span class="line">    view.adjustZoom(<span class="number">3</span>,[<span class="number">100</span>,<span class="number">25</span>])<span class="comment">// 将值添加到视图缩放级别</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="animate-var-args"><a href="#animate-var-args" class="headerlink" title="animate(var_args)"></a>animate(var_args)</h4><p>Animate the view. The view’s center, zoom (or resolution), and rotation can be animated for smooth transitions between view states. For example, to animate the view to a new zoom level:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.animate(&#123;<span class="attr">zoom</span>: view.getZoom() + <span class="number">1</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>By default, the animation lasts one second and uses in-and-out easing. You can customize this behavior by including <code>duration</code> (in milliseconds) and <code>easing</code> options (see <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_easing.html"><code>ol/easing</code></a>).</p>
<p>To chain together multiple animations, call the method with multiple animation objects. For example, to first zoom and then pan:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.animate(&#123;<span class="attr">zoom</span>: <span class="number">10</span>&#125;, &#123;<span class="attr">center</span>: [<span class="number">0</span>, <span class="number">0</span>]&#125;);</span><br></pre></td></tr></table></figure>

<p>If you provide a function as the last argument to the animate method, it will get called at the end of an animation series. The callback will be called with <code>true</code> if the animation series completed on its own or <code>false</code> if it was cancelled.</p>
<p>Animations are cancelled by user interactions (e.g. dragging the map) or by calling <code>view.setCenter()</code>, <code>view.setResolution()</code>, or <code>view.setRotation()</code> (or another method that calls one of these).</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723101912.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; easeIn, easeOut &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/easing&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    view.animate(</span><br><span class="line">      &#123; <span class="attr">zoom</span>: <span class="number">10</span>, <span class="attr">rotation</span>: <span class="built_in">Math</span>.PI / <span class="number">2</span>, <span class="attr">duration</span>: <span class="number">2000</span> &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">center</span>: [<span class="number">116.36564254760744</span>, <span class="number">39.90486412650293</span>],</span><br><span class="line">        <span class="attr">easing</span>: easeOut,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">10000</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">(<span class="params">flag</span>) =&gt;</span> &#123; <span class="comment">// 回调函数</span></span><br><span class="line">        <span class="keyword">if</span> (flag) <span class="built_in">console</span>.log(<span class="string">&#x27;动画完成&#x27;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">console</span>.log(<span class="string">&#x27;动画取消&#x27;</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//取消动画</span></span><br><span class="line">      view.cancelAnimations();</span><br><span class="line">    &#125;, <span class="number">5000</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="fit-geometryOrExtent-options"><a href="#fit-geometryOrExtent-options" class="headerlink" title="fit(geometryOrExtent, options)"></a>fit(geometryOrExtent, options)</h4><blockquote>
<p>Fit the given geometry or extent based on the given map size and border. The size is pixel dimensions of the box to fit the extent into. In most cases you will want to use the map size, that is <code>map.getSize()</code>. Takes care of the map angle.</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723103252.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">let</span> extent = [<span class="number">106.36564254760744</span>, <span class="number">30.90486412650293</span>, <span class="number">116.36564254760744</span>, <span class="number">39.90486412650293</span>];</span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    view.fit(extent, &#123;</span><br><span class="line">      <span class="comment">//根据给定的地图大小和边界拟合给定的几何图形或范围</span></span><br><span class="line">      <span class="attr">duration</span>: <span class="number">3000</span>,</span><br><span class="line">      <span class="attr">callback</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;fit函数执行完毕&#x27;</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="get、set"><a href="#get、set" class="headerlink" title="get、set"></a>get、set</h4><ul>
<li><p>get/set 属性名</p>
</li>
<li><p>getAnimating() =&gt; {boolean}</p>
<blockquote>
<p>Determine if the view is being animated.</p>
</blockquote>
</li>
<li><p>getZoomForResolution(resolution) =&gt; {number | undefined}</p>
<blockquote>
<p>Get the zoom level for a resolution.</p>
</blockquote>
</li>
<li><p>getResolutionForZoom(zoom) =&gt; {number}</p>
<blockquote>
<p>Get the resolution for a zoom level.</p>
</blockquote>
</li>
<li><p>getResolutionForExtent(extent, size) =&gt; {number}</p>
<blockquote>
<p>Get the resolution for a provided extent (in map units) and size (in pixels).</p>
</blockquote>
</li>
</ul>
<h4 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h4><ul>
<li><p>beginInteraction()</p>
<blockquote>
<p>Notify the View that an interaction has started. The view state will be resolved to a stable one if needed (depending on its constraints).</p>
</blockquote>
</li>
<li><p>endInteraction(duration, resolutionDirection, anchor)</p>
<blockquote>
<p>Notify the View that an interaction has ended. The view state will be resolved to a stable one if needed (depending on its constraints).<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723103547.png" alt="image.png"></p>
</blockquote>
</li>
<li><p>calculateExtent(size) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a>}</p>
<blockquote>
<p>Calculate the extent for the current view state and the passed box size.</p>
</blockquote>
</li>
<li><p>centerOn(coordinate, size, position)</p>
<blockquote>
<p>Center on coordinate and view position.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723103700.png" alt="image.png"></p>
</blockquote>
</li>
</ul>
<h2 id="Control-控件"><a href="#Control-控件" class="headerlink" title="Control - 控件"></a>Control - 控件</h2><h3 id="Control-父类"><a href="#Control-父类" class="headerlink" title="Control - 父类"></a>Control - 父类</h3><blockquote>
<p>A control is a visible widget with a DOM element in a fixed position on the screen. They can involve user input (buttons), or be informational only; the position is determined using CSS. By default these are placed in the container with CSS class name <code>ol-overlaycontainer-stopevent</code>, but can use any outside DOM element.</p>
<p>This is the base class for controls. You can use it for simple custom controls by creating the element with listeners, creating an instance:</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myControl = <span class="keyword">new</span> Control(&#123;<span class="attr">element</span>: myElement&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>and then adding this to the map.</p>
<p>The main advantage of having this as a control rather than a simple separate DOM element is that preventing propagation is handled for you. Controls will also be objects in a <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html"><code>Collection</code></a>, so you can use their methods.</p>
<p>You can also extend this base for your own control class. See examples/custom-controls for an example of how to do this.</p>
</blockquote>
<h4 id="Extends-4"><a href="#Extends-4" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h4 id="Subclasses-2"><a href="#Subclasses-2" class="headerlink" title="Subclasses"></a>Subclasses</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Attribution-Attribution.html">Attribution</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_FullScreen-FullScreen.html">FullScreen</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_MousePosition-MousePosition.html">MousePosition</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_OverviewMap-OverviewMap.html">OverviewMap</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Rotate-Rotate.html">Rotate</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ScaleLine-ScaleLine.html">ScaleLine</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ZoomSlider-ZoomSlider.html">ZoomSlider</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ZoomToExtent-ZoomToExtent.html">ZoomToExtent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Zoom-Zoom.html">Zoom</a></li>
</ul>
<h4 id="new-control-option"><a href="#new-control-option" class="headerlink" title="new control(option)"></a>new control(option)</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723110633.png" alt="image.png"></p>
<h4 id="Fires-1"><a href="#Fires-1" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723110646.png" alt="image.png"></p>
<h4 id="Methods-2"><a href="#Methods-2" class="headerlink" title="Methods"></a>Methods</h4><ul>
<li><p>setMap(map)</p>
<blockquote>
<p>Remove the control from its current map and attach it to the new map. Pass <code>null</code> to just remove the control from the current map. Subclasses may set up event handlers to get notified about changes to the map here.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723110909.png" alt="image.png"></p>
</blockquote>
</li>
<li><p>getMap() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html">Map</a> | null}</p>
</li>
<li><p>setTarget(target)</p>
<blockquote>
<p>This function is used to set a target element for the control. It has no effect if it is called after the control has been added to the map (i.e. after <code>setMap</code> is called on the control). If no <code>target</code> is set in the options passed to the control constructor and if <code>setTarget</code> is not called then the control is added to the map’s overlay container.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723111139.png" alt="image.png"></p>
</blockquote>
</li>
<li><p>render(mapEvent)</p>
<blockquote>
<p>Renders the control.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723111108.png" alt="image.png"></p>
</blockquote>
</li>
</ul>
<h3 id="Zoom-导航控件"><a href="#Zoom-导航控件" class="headerlink" title="Zoom - 导航控件"></a>Zoom - 导航控件</h3><h4 id="Zoom"><a href="#Zoom" class="headerlink" title="Zoom"></a>Zoom</h4><blockquote>
<p>A control with 2 buttons, one for zoom in and one for zoom out. This control is one of the default controls of a map. To style this control use css selectors <code>.ol-zoom-in</code> and <code>.ol-zoom-out</code>.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723111323.png" alt="image.png"></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> zoom = <span class="keyword">new</span> Zoom(&#123;</span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;ol-zoom-custom&#x27;</span>, <span class="comment">//CSS 类名</span></span><br><span class="line">    <span class="attr">duration</span>: <span class="number">1000</span>,</span><br><span class="line">    <span class="attr">zoomInLabel</span>: <span class="string">&#x27;+&#x27;</span>, <span class="comment">//放大的文本标签</span></span><br><span class="line">    <span class="attr">zoomOutLabel</span>: <span class="string">&#x27;-&#x27;</span>, <span class="comment">//缩小的文本标签</span></span><br><span class="line">    <span class="attr">zoomInTipLabel</span>: <span class="string">&#x27;放大&#x27;</span>, <span class="comment">//用于按钮提示的文本标签</span></span><br><span class="line">    <span class="attr">zoomOutTipLabel</span>: <span class="string">&#x27;缩小&#x27;</span>, <span class="comment">//用于按钮提示的文本标签</span></span><br><span class="line">    <span class="attr">delta</span>: <span class="number">5</span>, <span class="comment">//每次单击时应用的缩放增量</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(zoom);</span><br></pre></td></tr></table></figure>

<h4 id="ZoomSlider"><a href="#ZoomSlider" class="headerlink" title="ZoomSlider"></a>ZoomSlider</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723112714.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> slider = <span class="keyword">new</span> ZoomSlider(&#123;</span><br><span class="line">    <span class="attr">duration</span>: <span class="number">1000</span>, <span class="comment">//以毫秒为单位的动画持续时间</span></span><br><span class="line">    <span class="comment">//应重新呈现控件时调用的函数</span></span><br><span class="line">    <span class="attr">render</span>: <span class="function">(<span class="params">mapEvent</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(mapEvent);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(slider);</span><br></pre></td></tr></table></figure>

<h4 id="ZoomToExtent"><a href="#ZoomToExtent" class="headerlink" title="ZoomToExtent"></a>ZoomToExtent</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723113735.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> extent = <span class="keyword">new</span> ZoomToExtent(&#123;</span><br><span class="line">    <span class="comment">// 缩放至特定位置控件</span></span><br><span class="line">    <span class="attr">extent</span>: [<span class="number">813079.7791264898</span>, <span class="number">5929220.284081122</span>, <span class="number">848966.9639063801</span>, <span class="number">5936863.986909639</span>],</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;T&#x27;</span>,</span><br><span class="line">    <span class="attr">tipLabel</span>: <span class="string">&#x27;复位&#x27;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(extent);</span><br></pre></td></tr></table></figure>

<h3 id="基础控件实现"><a href="#基础控件实现" class="headerlink" title="基础控件实现"></a>基础控件实现</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721715631048.png" alt="QQ_1721715631048.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 缩小</span></span><br><span class="line"><span class="keyword">const</span> zoomOut = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">let</span> zoom = view?.getZoom();</span><br><span class="line">  <span class="keyword">if</span> (zoom) view?.setZoom(zoom - <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 放大</span></span><br><span class="line"><span class="keyword">const</span> zoomIn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">let</span> zoom = view?.getZoom();</span><br><span class="line">  <span class="keyword">if</span> (zoom) view?.setZoom(zoom + <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 平移</span></span><br><span class="line"><span class="keyword">const</span> translate = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="comment">//使用proj转换经纬度的坐标为平面坐标</span></span><br><span class="line">  <span class="keyword">let</span> lonLat = fromLonLat([<span class="number">116.36444091796875</span>, <span class="number">39.91184298474967</span>], <span class="string">&#x27;EPSG:4326&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(lonLat);</span><br><span class="line">  <span class="comment">//设置当前视图的中心位置与缩放级别</span></span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    view.setCenter([<span class="number">116.36444091796875</span>, <span class="number">39.91184298474967</span>]);</span><br><span class="line">    view.setZoom(<span class="number">12</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 旋转</span></span><br><span class="line"><span class="keyword">const</span> rotate = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    <span class="keyword">let</span> rotation = view.getRotation();</span><br><span class="line">    <span class="comment">//设置当前视图旋转的度数，度数是弧度制</span></span><br><span class="line">    view.setRotation(rotation + <span class="built_in">Math</span>.PI / <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复位</span></span><br><span class="line"><span class="keyword">const</span> reset = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    view.setZoom(zoom);</span><br><span class="line">    view.setRotation(rotation);</span><br><span class="line">    view.setCenter(center);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="图层选择实现"><a href="#图层选择实现" class="headerlink" title="图层选择实现"></a>图层选择实现</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721717903399.png" alt="QQ_1721717903399.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-checkbox-group</span> <span class="attr">v-model</span>=<span class="string">&quot;checkList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in layerList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;(checked: boolean) =&gt; layerCtl(checked, i)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-checkbox-group</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import &#123; Zoom, ZoomSlider, ZoomToExtent &#125; from &#x27;ol/control&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import OSM from &#x27;ol/source/OSM.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; defaults as defaultControls &#125; from &#x27;ol/control.js&#x27;;</span><br><span class="line">import type MapEvent from &#x27;ol/MapEvent&#x27;;</span><br><span class="line">import VectorSource from &#x27;ol/source/Vector&#x27;;</span><br><span class="line">import GeoJSON from &#x27;ol/format/GeoJSON&#x27;;</span><br><span class="line">import &#123; ImageWMS, XYZ &#125; from &#x27;ol/source&#x27;;</span><br><span class="line">import ImageLayer from &#x27;ol/layer/Image&#x27;;</span><br><span class="line">import VectorLayer from &#x27;ol/layer/Vector&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line">// 选中的图层</span><br><span class="line">const checkList = ref&lt;string[]&gt;([]);</span><br><span class="line">// 所有图层</span><br><span class="line">const layerList = ref&lt;string[]&gt;([]);</span><br><span class="line"></span><br><span class="line">// 图层选择</span><br><span class="line">const layerCtl = (checked: boolean, index: number) =&gt; &#123;</span><br><span class="line">  let layers = map.getLayers();</span><br><span class="line">  layers?.getArray()[index].setVisible(checked);</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  // 加载 OSM</span><br><span class="line">  const osmLayer = new TileLayer(&#123;</span><br><span class="line">    source: new OSM(),</span><br><span class="line">  &#125;);</span><br><span class="line">  osmLayer.set(&#x27;name&#x27;, &#x27;OSM&#x27;);</span><br><span class="line">  // 加载天地图</span><br><span class="line">  const tileLayer = new TileLayer(&#123;</span><br><span class="line">    visible: true,</span><br><span class="line">    source: new XYZ(&#123; url: &#x27; http://wprd0 &#123;1-4&#125;.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;z=&#123;z&#125;&#x27; &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  tileLayer.set(&#x27;name&#x27;, &#x27;天地图&#x27;);</span><br><span class="line">  // 加载 WMS 服务</span><br><span class="line">  const imageLayer = new ImageLayer(&#123;</span><br><span class="line">    source: new ImageWMS(&#123;</span><br><span class="line">      url: &#x27; http://localhost:8080/geoserver/DTQ/wms &#x27;,</span><br><span class="line">      params: &#123; layers: &#x27;DTQ:D4DTQYC&#x27; &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  imageLayer.set(&#x27;name&#x27;, &#x27;D4DTQYC&#x27;);</span><br><span class="line"></span><br><span class="line">  // 加载 WFS 服务</span><br><span class="line">  const FeatureLayer = new VectorLayer(&#123;</span><br><span class="line">    source: new VectorSource(&#123;</span><br><span class="line">      url: &#x27; http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3AL4DTQDGX01&amp;maxFeatures=50&amp;outputFormat=application%2Fjson &#x27;,</span><br><span class="line">      format: new GeoJSON(),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  FeatureLayer.set(&#x27;name&#x27;, &#x27;L4DTQDGX01&#x27;);</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: [119.316, 32.13],</span><br><span class="line">      projection: &#x27;EPSG:4326&#x27;,</span><br><span class="line">      zoom: 13, // 默认缩放等级</span><br><span class="line">      maxZoom: 20, // 最大缩放等级</span><br><span class="line">      minZoom: 5, // 最小缩放等级</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [osmLayer, tileLayer, imageLayer, FeatureLayer],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 获取 map 中图层</span><br><span class="line">  const allLayer = map.getAllLayers();</span><br><span class="line">  allLayer.forEach((e) =&gt; &#123;</span><br><span class="line">    layerList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">    checkList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 220px;</span><br><span class="line">  top: 20px;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="MousePosition-位置控件"><a href="#MousePosition-位置控件" class="headerlink" title="MousePosition - 位置控件"></a>MousePosition - 位置控件</h3><blockquote>
<p>A control to show the 2D coordinates of the mouse cursor. By default, these are in the view projection, but can be in any supported projection. By default the control is shown in the top right corner of the map, but this can be changed by using the css selector <code>.ol-mouse-position</code>.</p>
<p>On touch devices, which usually do not have a mouse cursor, the coordinates of the currently touched position are shown.</p>
</blockquote>
<p><strong>注意</strong>：自定义挂载元素时 className = “<strong>custom</strong>-mouse-position”</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;mouse-position&quot;</span> ref=<span class="string">&quot;position&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="keyword">let</span> mousePosition = <span class="keyword">new</span> MousePosition(&#123;</span><br><span class="line">        <span class="attr">className</span>: <span class="string">&quot;custom-mouse-position&quot;</span>,</span><br><span class="line">        ...</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="Extends-5"><a href="#Extends-5" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li>[Control]( <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html</a></li>
</ul>
<h4 id="new-MousePosition-options"><a href="#new-MousePosition-options" class="headerlink" title="new MousePosition(options)"></a>new MousePosition(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-mouse-position’)</td>
<td>CSS class name.</td>
</tr>
<tr>
<td><code>coordinateFormat</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat">CoordinateFormat</a> | undefined</td>
<td>Coordinate format.</td>
</tr>
<tr>
<td><code>projection</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_proj.html#~ProjectionLike">ProjectionLike</a> | undefined</td>
<td>Projection. Default is the view projection.</td>
</tr>
<tr>
<td><code>render</code></td>
<td>function | undefined</td>
<td>Function called when the control should be re-rendered. This is called in a <code>requestAnimationFrame</code> callback.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>placeholder</code></td>
<td>string | undefined</td>
<td>Markup to show when the mouse position is not available (e.g. when the pointer leaves the map viewport). By default, a non-breaking space is rendered initially and the last position is retained when the mouse leaves the viewport. When a string is provided (e.g. <code>&#39;no position&#39;</code> or <code>&#39;&#39;</code> for an empty string) it is used as a placeholder.</td>
</tr>
<tr>
<td><code>wrapX</code></td>
<td>boolean (defaults to true)</td>
<td>Wrap the world horizontally on the projection’s antimeridian, if it is a global projection.</td>
</tr>
</tbody></table>
<h4 id="Observable-Properties-3"><a href="#Observable-Properties-3" class="headerlink" title="Observable Properties"></a>Observable Properties</h4><p><strong>可观察属性即可以使用<code>change:属性字段</code></strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Settable</th>
<th><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a> type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>coordinateFormat</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat">CoordinateFormat</a> | undefined</td>
<td>yes</td>
<td><code>change:coordinateformat</code></td>
<td>The format to render the current position in.</td>
</tr>
<tr>
<td><code>projection</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_proj_Projection-Projection.html">Projection</a> | undefined</td>
<td>yes</td>
<td><code>change:projection</code></td>
<td>The projection to report mouse position in.</td>
</tr>
</tbody></table>
<h4 id="Fires-2"><a href="#Fires-2" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721719811685.png" alt="QQ_1721719811685.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721721551347.png" alt="QQ_1721721551347.png"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div id=<span class="string">&quot;map&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mouse-position&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;position&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> position = ref&lt;HTMLElement | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> mousePosition = <span class="keyword">new</span> MousePosition(&#123;</span><br><span class="line">    <span class="comment">//坐标格式</span></span><br><span class="line">    <span class="attr">coordinateFormat</span>: createStringXY(<span class="number">9</span>),</span><br><span class="line">    <span class="comment">//坐标的投影默认使用的是 view 视图的投影</span></span><br><span class="line">    <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span><br><span class="line">    <span class="comment">//坐标信息显示样式类名，默认是&#x27;ol-mouse-position&#x27;</span></span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;custom-mouse-position&#x27;</span>,</span><br><span class="line">    <span class="comment">//指定鼠标控件挂载的位置</span></span><br><span class="line">    <span class="attr">target</span>: position.value <span class="keyword">as</span> HTMLElement,</span><br><span class="line">    <span class="comment">//未定义坐标的标记</span></span><br><span class="line">    <span class="attr">placeholder</span>: <span class="string">&#x27;未识别鼠标位置&#x27;</span>,</span><br><span class="line">    <span class="comment">// 重新呈现控件时调用的函数</span></span><br><span class="line">    <span class="comment">// render: (MapEvent) =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//   console.log(MapEvent);</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(mousePosition);</span><br></pre></td></tr></table></figure>

<p><strong>其中createStringXY（）是格式化坐标的，让其精确到几位，更多格式化坐标函数见 <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat">CoordinateFormat</a></strong></p>
<p>eg:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createStringXY&#125; <span class="keyword">from</span> <span class="string">&#x27;ol/coordinate.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> coord = [<span class="number">7.85</span>, <span class="number">47.983333</span>];</span><br><span class="line"><span class="keyword">const</span> stringifyFunc = createStringXY(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">const</span> out = stringifyFunc(coord);</span><br><span class="line"><span class="comment">// out is now &#x27;7.85, 47.98&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="OverviewMap-鹰眼控件"><a href="#OverviewMap-鹰眼控件" class="headerlink" title="OverviewMap-鹰眼控件"></a>OverviewMap-鹰眼控件</h3><blockquote>
<p>创建一个新的控件，其中的地图可作为另一个定义地图的总览图。</p>
</blockquote>
<h4 id="Extends-6"><a href="#Extends-6" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a></li>
</ul>
<h4 id="new-OverviewMap-options"><a href="#new-OverviewMap-options" class="headerlink" title="new OverviewMap(options)"></a>new OverviewMap(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-overviewmap’)</td>
<td>CSS class name.</td>
</tr>
<tr>
<td><code>collapsed</code></td>
<td>boolean (defaults to true)</td>
<td>Whether the control should start collapsed or not (expanded).</td>
</tr>
<tr>
<td><code>collapseLabel</code></td>
<td>string | HTMLElement (defaults to ‘‹’)</td>
<td>Text label to use for the expanded overviewmap button. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>collapsible</code></td>
<td>boolean (defaults to true)</td>
<td>Whether the control can be collapsed or not.</td>
</tr>
<tr>
<td><code>label</code></td>
<td>string | HTMLElement (defaults to ‘›’)</td>
<td>Text label to use for the collapsed overviewmap button. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>layers</code></td>
<td>Array&lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a> &gt; | <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a> &lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a> &gt; | undefined</td>
<td>Layers for the overview map.</td>
</tr>
<tr>
<td><code>render</code></td>
<td>function | undefined</td>
<td>Function called when the control should be re-rendered. This is called in a <code>requestAnimationFrame</code> callback.</td>
</tr>
<tr>
<td><code>rotateWithView</code></td>
<td>boolean (defaults to false)</td>
<td>Whether the control view should rotate with the main map view.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>tipLabel</code></td>
<td>string (defaults to ‘Overview map’)</td>
<td>Text label to use for the button tip.</td>
</tr>
</tbody></table>
<p>| <code>view</code></p>
<pre><code>     | [View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html) \| undefined | Custom view for the overview map (should use same projection as main map). If not provided, a default view with the same projection as the main map will be used. |
</code></pre>
<h4 id="Fires-3"><a href="#Fires-3" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721721154634.png" alt="QQ_1721721154634.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721721528028.png" alt="QQ_1721721528028.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="keyword">const</span> overviewMap = <span class="keyword">new</span> OverviewMap(&#123;</span><br><span class="line">    <span class="comment">//鹰眼控件样式（默认为 ol-overviewmap）</span></span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;ol-overviewmap ol-custom-overviewmap&#x27;</span>,</span><br><span class="line">    <span class="attr">layers</span>: [</span><br><span class="line">      <span class="keyword">new</span> TileLayer(&#123;</span><br><span class="line">        <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">//当前的鹰眼图会跟随当前的视图旋转</span></span><br><span class="line">    <span class="attr">rotateWithView</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">collapseLabel</span>: <span class="string">&#x27;\u00BB&#x27;</span>,</span><br><span class="line">    <span class="comment">//鹰眼控件折叠时功能按钮上的标识</span></span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;\u00AB&#x27;</span>,</span><br><span class="line">    <span class="comment">//初始为展开显示方式</span></span><br><span class="line">    <span class="attr">collapsed</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">map.addControl(overviewMap);</span><br></pre></td></tr></table></figure>

<h3 id="FullScreen-全屏控件"><a href="#FullScreen-全屏控件" class="headerlink" title="FullScreen - 全屏控件"></a>FullScreen - 全屏控件</h3><h4 id="Extends-7"><a href="#Extends-7" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a></li>
</ul>
<h4 id="new-FullScreen-options"><a href="#new-FullScreen-options" class="headerlink" title="new FullScreen(options)"></a>new FullScreen(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-full-screen’)</td>
<td>CSS class name.</td>
</tr>
<tr>
<td><code>label</code></td>
<td>string | Text | HTMLElement (defaults to ‘\u2922’)</td>
<td>Text label to use for the button. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>labelActive</code></td>
<td>string | Text | HTMLElement (defaults to ‘\u00d7’)</td>
<td>Text label to use for the button when full-screen is active. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>activeClassName</code></td>
<td>string (defaults to className + ‘-true’)</td>
<td>CSS class name for the button when full-screen is active.</td>
</tr>
<tr>
<td><code>inactiveClassName</code></td>
<td>string (defaults to className + ‘-false’)</td>
<td>CSS class name for the button when full-screen is inactive.</td>
</tr>
<tr>
<td><code>tipLabel</code></td>
<td>string (defaults to ‘Toggle full-screen’)</td>
<td>Text label to use for the button tip.</td>
</tr>
<tr>
<td><code>keys</code></td>
<td>boolean (defaults to false)</td>
<td>Full keyboard access.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>source</code></td>
<td>HTMLElement | string | undefined</td>
<td>The element to be displayed fullscreen. When not provided, the element containing the map viewport will be displayed fullscreen.</td>
</tr>
</tbody></table>
<h4 id="Fires-4"><a href="#Fires-4" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721722148792.png" alt="QQ_1721722148792.png"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fullScreen = <span class="keyword">new</span> FullScreen(&#123; <span class="attr">tipLabel</span>: <span class="string">&#x27;全屏&#x27;</span> &#125;);</span><br><span class="line">map.addControl(fullScreen);</span><br></pre></td></tr></table></figure>

<h3 id="测量控件"><a href="#测量控件" class="headerlink" title="测量控件"></a>测量控件</h3><h4 id="unByKey-key"><a href="#unByKey-key" class="headerlink" title="unByKey(key)"></a>unByKey(key)</h4><blockquote>
<p>Removes an event listener using the key returned by <code>on()</code> or <code>once()</code>.</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724092408.png" alt="image.png"></p>
<p><strong>注意：map 不要用 ref 包</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;measureCtl(&#x27;Polygon&#x27;)&quot;</span>&gt;</span>面积<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;measureCtl(&#x27;LineString&#x27;)&quot;</span>&gt;</span>距离<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import &#123; Zoom, ZoomSlider, ZoomToExtent &#125; from &#x27;ol/control&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import OSM from &#x27;ol/source/OSM.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; defaults as defaultControls &#125; from &#x27;ol/control.js&#x27;;</span><br><span class="line">import * as sphere from &#x27;ol/sphere&#x27;;</span><br><span class="line">import &#123; Circle, Geometry, LineString, Polygon &#125; from &#x27;ol/geom&#x27;;</span><br><span class="line">import Feature from &#x27;ol/Feature&#x27;;</span><br><span class="line">import &#123; MapBrowserEvent, Overlay &#125; from &#x27;ol&#x27;;</span><br><span class="line">import VectorLayer from &#x27;ol/layer/Vector&#x27;;</span><br><span class="line">import VectorSource from &#x27;ol/source/Vector&#x27;;</span><br><span class="line">import Style from &#x27;ol/style/Style&#x27;;</span><br><span class="line">import Fill from &#x27;ol/style/Fill&#x27;;</span><br><span class="line">import Stroke from &#x27;ol/style/Stroke&#x27;;</span><br><span class="line">import CircleStyle from &#x27;ol/style/Circle.js&#x27;;</span><br><span class="line">import Draw, &#123; DrawEvent &#125; from &#x27;ol/interaction/Draw.js&#x27;;</span><br><span class="line">import type &#123; Type &#125; from &#x27;ol/geom/Geometry&#x27;;</span><br><span class="line">import type &#123; EventsKey &#125; from &#x27;ol/events&#x27;;</span><br><span class="line">import &#123; unByKey &#125; from &#x27;ol/Observable&#x27;;</span><br><span class="line">import type &#123; Interaction &#125; from &#x27;ol/interaction&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line"></span><br><span class="line">let sketch: Feature | null; // 当前绘制的要素（Currently drawn feature.）</span><br><span class="line">let helpTooltipElement: HTMLElement; // 帮助提示框对象（The help tooltip element.）</span><br><span class="line">let helpTooltip: Overlay; // 帮助提示框显示的信息（Overlay to show the help messages.）</span><br><span class="line">let measureTooltipElement: HTMLElement | null; // 测量工具提示框对象（The measure tooltip element. ）</span><br><span class="line">let measureTooltip: Overlay; // 测量工具中显示的测量值（Overlay to show the measurement.）</span><br><span class="line">let continuePolygonMsg: string = &#x27;Click to continue drawing the polygon&#x27;; // 当用户正在绘制多边形时的提示信息文本</span><br><span class="line">let continueLineMsg: string = &#x27;Click to continue drawing the line&#x27;; // 当用户正在绘制线时的提示信息文本</span><br><span class="line">let listener: EventsKey | undefined; // 事件监听</span><br><span class="line">let draw: Draw; // 绘制交互</span><br><span class="line"></span><br><span class="line">// 测量长度输出</span><br><span class="line">const formatLength = (line: LineString) =&gt; &#123;</span><br><span class="line">  //使用测地学方法测量</span><br><span class="line">  const sourceProj = map.getView().getProjection(); //地图数据源投影坐标系</span><br><span class="line">  let length = sphere.getLength(line, &#123;</span><br><span class="line">    projection: sourceProj,</span><br><span class="line">    radius: 6378137, // 地球半径</span><br><span class="line">  &#125;);</span><br><span class="line">  let output;</span><br><span class="line">  if (length &gt; 100) &#123;</span><br><span class="line">    output = Math.round((length / 1000) * 100) / 100 + &#x27; &#x27; + &#x27;km&#x27;; //换算成 KM 单位</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    output = Math.round(length * 100) / 100 + &#x27; &#x27; + &#x27;m&#x27;; //m 为单位</span><br><span class="line">  &#125;</span><br><span class="line">  return output; //返回线的长度</span><br><span class="line">&#125;;</span><br><span class="line">// 测量面积输出</span><br><span class="line">const formatArea = (polygon: Polygon) =&gt; &#123;</span><br><span class="line">  //使用测地学方法测量</span><br><span class="line">  const sourceProj = map.getView().getProjection(); //地图数据源投影坐标系</span><br><span class="line">  let geom = polygon.clone().transform(sourceProj, &#x27;EPSG:4326&#x27;); //将多边形要素坐标系投影为 EPSG:4326</span><br><span class="line">  let area = Math.abs(sphere.getArea(geom, &#123; projection: sourceProj, radius: 6378137 &#125;)); //获取面积</span><br><span class="line">  let output;</span><br><span class="line">  if (area &gt; 10000) &#123;</span><br><span class="line">    output = Math.round((area / 1000000) * 100) / 100 + &#x27; &#x27; + &#x27;km&lt;sup&gt;2&lt;/sup&gt;&#x27;; //换算成 KM 单位</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    output = Math.round(area * 100) / 100 + &#x27; &#x27; + &#x27;m&lt;sup&gt;2&lt;/sup&gt;&#x27;; //m 为单位</span><br><span class="line">  &#125;</span><br><span class="line">  return output; //返回多边形的面积</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 创建一个新的帮助提示框（tooltip）- 未画之前的提示框</span><br><span class="line">const createHelpTooltip = () =&gt; &#123;</span><br><span class="line">  // 移除已有元素</span><br><span class="line">  if (helpTooltipElement) &#123;</span><br><span class="line">    helpTooltipElement.parentNode?.removeChild(helpTooltipElement);</span><br><span class="line">  &#125;</span><br><span class="line">  helpTooltipElement = document.createElement(&#x27;div&#x27;);</span><br><span class="line">  helpTooltipElement.className = &#x27;tooltip hidden&#x27;;</span><br><span class="line"></span><br><span class="line">  //提示框的覆盖层</span><br><span class="line">  helpTooltip = new Overlay(&#123;</span><br><span class="line">    element: helpTooltipElement,</span><br><span class="line">    offset: [15, 0],</span><br><span class="line">    positioning: &#x27;center-left&#x27;,</span><br><span class="line">  &#125;);</span><br><span class="line">  // 只是添加 Overlay 但是还没设置坐标 所以不会显示</span><br><span class="line">  map.addOverlay(helpTooltip);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 创建一个新的测量工具提示框（tooltip）- 画时的提示框</span><br><span class="line">const createMeasureTooltip = () =&gt; &#123;</span><br><span class="line">  // 移除已有元素</span><br><span class="line">  if (measureTooltipElement) &#123;</span><br><span class="line">    measureTooltipElement.parentNode?.removeChild(measureTooltipElement);</span><br><span class="line">  &#125;</span><br><span class="line">  measureTooltipElement = document.createElement(&#x27;div&#x27;);</span><br><span class="line">  measureTooltipElement.className = &#x27;tooltip tooltip-measure&#x27;;</span><br><span class="line">  //提示框的覆盖层</span><br><span class="line">  measureTooltip = new Overlay(&#123;</span><br><span class="line">    element: measureTooltipElement,</span><br><span class="line">    offset: [0, -15],</span><br><span class="line">    positioning: &#x27;bottom-center&#x27;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 只是添加 Overlay 但是还没设置坐标 所以不会显示</span><br><span class="line">  map.addOverlay(measureTooltip);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 动态显示帮助提示框内容</span><br><span class="line">const pointerMoveHandler = (event: MapBrowserEvent&lt;any&gt;) =&gt; &#123;</span><br><span class="line">  // 指示地图当前是否正在被拖动 dragging&#123;boolean&#125;</span><br><span class="line">  if (event.dragging) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  //当前默认提示信息</span><br><span class="line">  let helpMsg = &#x27;Click to start drawing&#x27;;</span><br><span class="line">  //判断绘制几何类型设置相应的帮助提示信息</span><br><span class="line">  let geom = sketch?.getGeometry();</span><br><span class="line">  if (geom instanceof Polygon) &#123;</span><br><span class="line">    helpMsg = continuePolygonMsg; //绘制多边形时提示相应内容</span><br><span class="line">  &#125; else if (geom instanceof LineString) &#123;</span><br><span class="line">    helpMsg = continueLineMsg; //绘制线时提示相应内容</span><br><span class="line">  &#125;</span><br><span class="line">  helpTooltipElement.innerHTML = helpMsg; //将提示信息设置到对话框中显示</span><br><span class="line">  // helpTooltip 为 Overlay 对象</span><br><span class="line">  helpTooltip.setPosition(event.coordinate); //设置帮助提示框的位置</span><br><span class="line">  //$(helpTooltipElement).removeClass(&#x27;hidden&#x27;);//移除帮助提示框的隐藏样式进行显示</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 加载交互绘制控件函数</span><br><span class="line">const addMeasure = (measureType: Type, source: VectorSource&lt;Feature&lt;Geometry&gt;&gt;) =&gt; &#123;</span><br><span class="line">  draw = new Draw(&#123;</span><br><span class="line">    source: source, //测量绘制层数据源</span><br><span class="line">    type: measureType, //几何图形类型</span><br><span class="line">    style: new Style(&#123;</span><br><span class="line">      //绘制几何图形的样式</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;rgba(255, 255, 255, 0.8)&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;rgba(0, 0, 0, 0.5)&#x27;,</span><br><span class="line">        lineDash: [10, 10],</span><br><span class="line">        width: 2,</span><br><span class="line">      &#125;),</span><br><span class="line">      image: new CircleStyle(&#123;</span><br><span class="line">        radius: 7,</span><br><span class="line">        fill: new Fill(&#123;</span><br><span class="line">          color: &#x27; #ffcc33 &#x27;,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  //将绘制交互事件添加到地图中</span><br><span class="line">  map.addInteraction(draw);</span><br><span class="line">  //创建测量工具提示框</span><br><span class="line">  createMeasureTooltip();</span><br><span class="line">  //创建帮助提示框</span><br><span class="line">  createHelpTooltip();</span><br><span class="line"></span><br><span class="line">  //绑定交互绘制工具开始绘制的事件</span><br><span class="line">  draw.on(&#x27;drawstart&#x27;, (event: DrawEvent) =&gt; &#123;</span><br><span class="line">    sketch = event.feature; //绘制的要素</span><br><span class="line">    let tooltipCoord = event.target.coordinate; // 绘制的坐标</span><br><span class="line">    //绑定 change 事件，根据绘制几何类型得到测量长度值或面积值，并将其设置到测量工具提示框中显示</span><br><span class="line">    listener = sketch?.getGeometry()?.on(&#x27;change&#x27;, (event) =&gt; &#123;</span><br><span class="line">      let geom = event.target; //绘制几何要素</span><br><span class="line">      let output;</span><br><span class="line">      if (geom instanceof Polygon) &#123;</span><br><span class="line">        output = formatArea(geom); // 面积值</span><br><span class="line">        //获取一个在几何体中内部的坐标点</span><br><span class="line">        tooltipCoord = geom.getInteriorPoint().getCoordinates(); //坐标</span><br><span class="line">      &#125; else if (geom instanceof LineString) &#123;</span><br><span class="line">        output = formatLength(geom); //长度值</span><br><span class="line">        //测量长度获取到线的最后一个坐标</span><br><span class="line">        tooltipCoord = geom.getLastCoordinate(); //坐标</span><br><span class="line">      &#125;</span><br><span class="line">      if (measureTooltipElement &amp;&amp; output) measureTooltipElement.innerHTML = output; //将测量值设置到测量工具提示框中显示</span><br><span class="line">      measureTooltip.setPosition(tooltipCoord); //设置测量工具提示框的显示位置</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  //绑定交互绘制工具结束绘制的事件</span><br><span class="line">  draw.on(&#x27;drawend&#x27;, (event: DrawEvent) =&gt; &#123;</span><br><span class="line">    if (measureTooltipElement) measureTooltipElement.className = &#x27;tooltip tooltip-static&#x27;; //设置测量提示框的样式</span><br><span class="line">    measureTooltip.setOffset([0, -7]);</span><br><span class="line">    sketch = null; // 置空当前绘制的要素对象</span><br><span class="line">    measureTooltipElement = null; // 置空测量工具提示框对象 - 画图时的提示框 然后在重新创建一个</span><br><span class="line">    createMeasureTooltip(); //重新创建一个测试工具提示框显示结果</span><br><span class="line">    if (listener) &#123;</span><br><span class="line">      unByKey(listener); // 解除监听事件 Removes an event listener using the key returned by on() or once().</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 按钮点击事件</span><br><span class="line">const measureCtl = (measureType: Type) =&gt; &#123;</span><br><span class="line">  if (draw) &#123;</span><br><span class="line">    map.removeInteraction(draw);</span><br><span class="line">  &#125;</span><br><span class="line">  //定义一个数据源 用来画线和面元素</span><br><span class="line">  const source = new VectorSource();</span><br><span class="line">  const vectorLayer = new VectorLayer(&#123;</span><br><span class="line">    source: source,</span><br><span class="line">    style: new Style(&#123;</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;rgba(255, 255, 255, 0.2)&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27; #ffcc33 &#x27;,</span><br><span class="line">        width: 2,</span><br><span class="line">      &#125;),</span><br><span class="line">      image: new CircleStyle(&#123;</span><br><span class="line">        radius: 5,</span><br><span class="line">        stroke: new Stroke(&#123;</span><br><span class="line">          color: &#x27;rgba(0, 0, 0, 0.7)&#x27;,</span><br><span class="line">        &#125;),</span><br><span class="line">        fill: new Fill(&#123;</span><br><span class="line">          color: &#x27;rgba(255, 255, 255, 0.5)&#x27;,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(vectorLayer);</span><br><span class="line"></span><br><span class="line">  //地图容器绑定鼠标移动事件，动态显示帮助提示框内容</span><br><span class="line">  map.on(&#x27;pointermove&#x27;, pointerMoveHandler);</span><br><span class="line"></span><br><span class="line">  //根据不同类型添加绘制的交互</span><br><span class="line">  addMeasure(measureType, source);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;, //指定挂载 dom，注意必须是 id</span><br><span class="line">    layers: [</span><br><span class="line">      new TileLayer(&#123;</span><br><span class="line">        source: new OSM(), //加载 OpenStreetMap</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    //配置视图</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: [113.24981689453125, 23.126468438108688], //视图中心位置</span><br><span class="line">      projection: &#x27;EPSG:4326&#x27;, //指定投影</span><br><span class="line">      zoom: 12, //缩放到的级别</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 0.5em;</span><br><span class="line">  right: 0.5em;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 提示框的样式信息</span><br><span class="line">*/</span><br><span class="line">#map :deep(.tooltip) &#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  background: rgba(0, 0, 0, 0.5);</span><br><span class="line">  border-radius: 4px;</span><br><span class="line">  color: white;</span><br><span class="line">  padding: 4px 8px;</span><br><span class="line">  opacity: 0.7;</span><br><span class="line">  white-space: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 正在测的数字 */</span><br><span class="line">#map :deep(.tooltip-measure) &#123;</span><br><span class="line">  opacity: 1;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 已经测的结果 */</span><br><span class="line">#map :deep(.tooltip-static) &#123;</span><br><span class="line">  background-color: #ffcc33 ;</span><br><span class="line">  color: black;</span><br><span class="line">  border: 1px solid white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#map :deep(.tooltip-measure:before) #map :deep(.tooltip-static:before) &#123;</span><br><span class="line">  border-top: 6px solid rgba(0, 0, 0, 0.5);</span><br><span class="line">  border-right: 6px solid transparent;</span><br><span class="line">  border-left: 6px solid transparent;</span><br><span class="line">  content: &#x27;&#x27;;</span><br><span class="line">  position: absolute;</span><br><span class="line">  bottom: -6px;</span><br><span class="line">  margin-left: -7px;</span><br><span class="line">  left: 50%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#map :deep(.tooltip-static:before) &#123;</span><br><span class="line">  border-top-color: #ffcc33 ;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="动画控件"><a href="#动画控件" class="headerlink" title="动画控件"></a>动画控件</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786658806.png" alt="QQ_1721786658806.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;rotateLocation&quot;</span>&gt;</span>旋转定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;elasticLocation&quot;</span>&gt;</span>弹性定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;reboundLocation&quot;</span>&gt;</span>反弹定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;warning&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;flyLocation&quot;</span>&gt;</span>飞行定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;aroundRotate&quot;</span>&gt;</span>围绕旋转<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Zoom, ZoomSlider, ZoomToExtent &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; defaults <span class="keyword">as</span> defaultControls &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type MapEvent <span class="keyword">from</span> <span class="string">&#x27;ol/MapEvent&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; fromLonLat &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/proj&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; easeIn, easeOut &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/easing&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">//注意参考系</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> beijing = fromLonLat([<span class="number">116.3898468017578</span>, <span class="number">39.91026292816486</span>], <span class="string">&#x27;EPSG:4326&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> guangzhou = fromLonLat([<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>], <span class="string">&#x27;EPSG:4326&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 旋转定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> rotateLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> center = view.getCenter();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">if</span> (center) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//动画结束时的视图中心,即当前视图中心同目标视图中心连线的中心点</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">center</span>: [center[<span class="number">0</span>], center[<span class="number">1</span>]],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">rotation</span>: <span class="built_in">Math</span>.PI, <span class="comment">//动画结束时的旋转角度，即180度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">easing</span>: easeIn, <span class="comment">//按每一帧动画控制的动画速度，即开始缓慢并逐渐加快速度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">center</span>: beijing, <span class="comment">//动画结束时的视图中心</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">rotation</span>: <span class="number">2</span> * <span class="built_in">Math</span>.PI, <span class="comment">//动画结束时的旋转角度，即360度回正</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">easing</span>: easeOut, <span class="comment">//按每一帧动画控制的动画速度，即开始快速并逐渐减速</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 弹性定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> elasticLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 弹性伸缩值</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="keyword">function</span> <span class="title">elastic</span>(<span class="params">t: number</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//函数-10*sin(t-0.075)**t*t+1</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">return</span> <span class="built_in">Math</span>.pow(<span class="number">2</span>, -<span class="number">10</span> * t) * <span class="built_in">Math</span>.sin(((t - <span class="number">0.075</span>) * (<span class="number">2</span> * <span class="built_in">Math</span>.PI)) / <span class="number">0.3</span>) + <span class="number">1</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> center = view.getCenter();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">if</span> (center) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: beijing, <span class="comment">///动画结束时的视图中心</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">duration</span>: <span class="number">3000</span>, <span class="comment">//动画的持续时间（以毫秒为单位）</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">easing</span>: elastic, <span class="comment">//按每一帧动画控制的动画持续时间函数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 反弹定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> reboundLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 反弹值</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="keyword">function</span> <span class="title">bounce</span>(<span class="params">t: number</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">var</span> s = <span class="number">7.5625</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      p = <span class="number">2.75</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      l;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (t &lt; <span class="number">1</span> / p) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      l = s * t * t;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">if</span> (t &lt; <span class="number">2</span> / p) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        t -= <span class="number">1.5</span> / p;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        l = s * t * t + <span class="number">0.75</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">if</span> (t &lt; <span class="number">2.5</span> / p) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          t -= <span class="number">2.25</span> / p;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          l = s * t * t + <span class="number">0.9375</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          t -= <span class="number">2.625</span> / p;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          l = s * t * t + <span class="number">0.984375</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">return</span> l;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  view.animate(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">center</span>: guangzhou, <span class="comment">///动画结束时的视图中心</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">duration</span>: <span class="number">3000</span>, <span class="comment">//动画的持续时间（以毫秒为单位）</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">easing</span>: bounce, <span class="comment">//按每一帧动画控制的动画持续时间函数)</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 飞行定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> flyLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> zoom = view.getZoom();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> duration = <span class="number">3000</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//动画完成的回调函数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">complete: boolean</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (complete) <span class="built_in">console</span>.log(<span class="string">&#x27;动画完成&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">if</span> (zoom) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第一个动画</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">center</span>: guangzhou,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">duration</span>: duration,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      callback,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第二个动画</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">zoom</span>: zoom - <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">duration</span>: duration / <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">zoom</span>: zoom,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">duration</span>: duration / <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      callback,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 围绕旋转</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> aroundRotate = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">var</span> rotation = view.getRotation();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第一个过程</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">rotation</span>: rotation + <span class="built_in">Math</span>.PI, <span class="comment">//第一次动画旋转角度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">anchor</span>: guangzhou, <span class="comment">//自旋的中心点</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">easing</span>: easeIn, <span class="comment">////按每一帧动画控制的动画速度，即开始缓慢并逐渐加快速度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第二个过程</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">rotation</span>: rotation + <span class="number">2</span> * <span class="built_in">Math</span>.PI, <span class="comment">//动画结束时的旋转角度，即360度回正</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">anchor</span>: guangzhou, <span class="comment">// 旋转中心点</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">easing</span>: easeOut, <span class="comment">///按每一帧动画控制的动画速度，即开始快速并逐渐减速</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>], <span class="comment">//视图中心位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">12</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    ],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-class">.MapTool</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">top</span>: <span class="number">0.5em</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">right</span>: <span class="number">0.5em</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ScaleLine-比例尺控件"><a href="#ScaleLine-比例尺控件" class="headerlink" title="ScaleLine - 比例尺控件"></a>ScaleLine - 比例尺控件</h3><blockquote>
<p> By default the scale line will show in the bottom left portion of the map, but this can be changed by using the css selector <code>.ol-scale-line</code>. When specifying <code>bar</code> as <code>true</code>, a scalebar will be rendered instead of a scaleline. For cartesian measurements of the scaleline, you need to set the <code>getPointResolution</code> method of your projection to simply return the input value, e.g. <code>projection.setGetPointResolution(r =&gt; r);</code></p>
</blockquote>
<h4 id="Extends-8"><a href="#Extends-8" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a></li>
</ul>
<h4 id="Observable-Properties-4"><a href="#Observable-Properties-4" class="headerlink" title="Observable Properties"></a>Observable Properties</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Settable</th>
<th><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a> type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>units</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ScaleLine.html#~Units">Units</a></td>
<td>yes</td>
<td><code>change:units</code></td>
<td>The units to use in the scale line.</td>
</tr>
</tbody></table>
<h4 id="new-ScaleLine-options"><a href="#new-ScaleLine-options" class="headerlink" title="new ScaleLine(options)"></a>new ScaleLine(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string | undefined</td>
<td>CSS class name. The default is <code>ol-scale-bar</code> when configured with <code>bar: true</code>. Otherwise the default is <code>ol-scale-line</code>.</td>
</tr>
<tr>
<td><code>minWidth</code></td>
<td>number (defaults to 64)</td>
<td>Minimum width in pixels at the OGC default dpi. The width will be adjusted to match the dpi used.</td>
</tr>
<tr>
<td><code>maxWidth</code></td>
<td>number | undefined</td>
<td>Maximum width in pixels at the OGC default dpi. The width will be adjusted to match the dpi used.</td>
</tr>
<tr>
<td><code>render</code></td>
<td>function | undefined</td>
<td>Function called when the control should be re-rendered. This is called in a <code>requestAnimationFrame</code> callback.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>units</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ScaleLine.html#~Units">Units</a> (defaults to ‘metric’)</td>
<td>Units.</td>
</tr>
<tr>
<td><code>bar</code></td>
<td>boolean (defaults to false)</td>
<td>Render scalebars instead of a line.</td>
</tr>
<tr>
<td><code>steps</code></td>
<td>number (defaults to 4)</td>
<td>Number of steps the scalebar should use. Use even numbers for best results. Only applies when <code>bar</code> is <code>true</code>.</td>
</tr>
<tr>
<td><code>text</code></td>
<td>boolean (defaults to false)</td>
<td>Render the text scale above of the scalebar. Only applies when <code>bar</code> is <code>true</code>.</td>
</tr>
<tr>
<td><code>dpi</code></td>
<td>number | undefined</td>
<td>dpi of output device such as printer. Only applies when <code>bar</code> is <code>true</code>. If undefined the OGC default screen pixel size of 0.28mm will be assumed.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="Fires-5"><a href="#Fires-5" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724091945.png" alt="image.png"></p>
<p><code>bar:true</code>时</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786686345.png" alt="QQ_1721786686345.png"></p>
<p><code>bar:false</code>时</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786717387.png" alt="QQ_1721786717387.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加比例尺控件</span></span><br><span class="line"><span class="keyword">const</span> addScaleLineCtl = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> scaleLineControl = <span class="keyword">new</span> ScaleLine(&#123;</span><br><span class="line">    <span class="comment">//设置比例尺单位，degrees、imperial、us、nautical、metric（度量单位）</span></span><br><span class="line">    <span class="attr">units</span>: <span class="string">&#x27;metric&#x27;</span>,</span><br><span class="line">    <span class="attr">bar</span>: <span class="literal">true</span>, <span class="comment">// 渲染比例尺而不是一条线</span></span><br><span class="line">    <span class="attr">text</span>: <span class="literal">true</span>, <span class="comment">// 渲染比例尺上方的文本比例。仅适用于bar is true</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(scaleLineControl);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="图层探索"><a href="#图层探索" class="headerlink" title="图层探索"></a>图层探索</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786327484.png" alt="QQ_1721786327484.png"></p>
<p><code>let ctx = event.context;</code>是获取 canvas 画布</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;mapDom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Zoom, ZoomSlider, ZoomToExtent &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; defaults <span class="keyword">as</span> defaultControls &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type MapEvent <span class="keyword">from</span> <span class="string">&#x27;ol/MapEvent&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; XYZ &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type Layer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Layer&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; Pixel &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/pixel&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type RenderEvent <span class="keyword">from</span> <span class="string">&#x27;ol/render/Event&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> mapDom = ref&lt;HTMLElement | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> addLayerSearch = <span class="function">(<span class="params">layer: Layer</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 探查半径</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> radius = <span class="number">75</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 添加键盘按下事件监听，用来控制探查范围的大小</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="built_in">document</span>.addEventListener(<span class="string">&#x27;keydown&#x27;</span>, <span class="function">(<span class="params">event: KeyboardEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (event.keyCode === <span class="number">38</span>) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      radius = <span class="built_in">Math</span>.min(radius + <span class="number">5</span>, <span class="number">150</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// 不会触发点击事件 - click, singleclick, doubleclick</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      event.preventDefault();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (event.keyCode == <span class="number">40</span>) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      radius = <span class="built_in">Math</span>.max(radius - <span class="number">5</span>, <span class="number">25</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      event.preventDefault();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 实时得到鼠标的像素位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> mousePosition: Pixel;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  mapDom.value?.addEventListener(<span class="string">&#x27;mousemove&#x27;</span>, <span class="function">(<span class="params">event: MouseEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取到地图鼠标的位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    mousePosition = map.getEventPixel(event);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 鼠标移动时强制渲染地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  mapDom.value?.addEventListener(<span class="string">&#x27;mouseout&#x27;</span>, <span class="function">(<span class="params">event: MouseEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取到地图鼠标的位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    mousePosition = map.getEventPixel(event);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 鼠标移出map就强制渲染</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 在渲染层之前,做剪裁</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  layer.on(<span class="string">&#x27;prerender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取canvas画布</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> ctx = event.context;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取屏幕的像素比</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> pixelRatio = event?.frameState?.pixelRatio;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (ctx <span class="keyword">instanceof</span> CanvasRenderingContext2D &amp;&amp; pixelRatio) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      ctx.save();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      ctx.beginPath();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">if</span> (mousePosition) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//只显示一个围绕着鼠标的圆圈</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.arc(mousePosition[<span class="number">0</span>] * pixelRatio, mousePosition[<span class="number">1</span>] * pixelRatio, radius * pixelRatio, <span class="number">0</span>, <span class="number">2</span> * <span class="built_in">Math</span>.PI);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.lineWidth = <span class="number">5</span> * pixelRatio;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.strokeStyle = <span class="string">&#x27;rgba(0,0,0,0.5)&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.stroke();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//图层的其他地方通过canvas的上下文对象裁剪掉，只保留绘制的圆形的部分</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      ctx.clip();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 呈现层后,恢复画布的背景</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  layer.on(<span class="string">&#x27;postrender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> ctx = event.context;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (ctx <span class="keyword">instanceof</span> CanvasRenderingContext2D) ctx.restore();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 加载OSM</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> osmLayer = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 加载天地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> tileLayer = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">visible</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> XYZ(&#123; <span class="attr">url</span>: <span class="string">&#x27;http://wprd0&#123;1-4&#125;.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;z=&#123;z&#125;&#x27;</span> &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">12</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [tileLayer, osmLayer],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  addLayerSearch(osmLayer);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br></pre></td></tr></table></figure>

<h2 id="Layer-Source-各种数据"><a href="#Layer-Source-各种数据" class="headerlink" title="Layer + Source - 各种数据"></a>Layer + Source - 各种数据</h2><blockquote>
<p>Openlayers 将地图渲染分为图层（layer）与数据源（source）分离，图层是渲染地图数的地图容器，而数据源则作为 GIS 数据的载体，图层要与数据源匹配设置</p>
</blockquote>
<h3 id="BaseLayer-抽象基类"><a href="#BaseLayer-抽象基类" class="headerlink" title="BaseLayer - 抽象基类"></a>BaseLayer - 抽象基类</h3><blockquote>
<p>抽象基类；通常仅用于创建子类，而不是在应用中实例化。请注意，对于<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html"><code>BaseLayer</code></a>其所有子类，在选项中设置的任何属性均设置为<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html"><code>BaseObject</code></a>层对象上的属性，因此是可观察的，并且具有 get/set 访问器。</p>
</blockquote>
<p><code>import BaseLayer from &#39;ol/layer/Base.js&#39;;</code></p>
<h4 id="new-BaseLayer-options"><a href="#new-BaseLayer-options" class="headerlink" title="new BaseLayer(options)"></a>new BaseLayer(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-layer’)</td>
<td>A CSS class name to set to the layer element.</td>
</tr>
<tr>
<td><code>opacity</code></td>
<td>number (defaults to 1)</td>
<td>Opacity (0, 1).</td>
</tr>
<tr>
<td><code>visible</code></td>
<td>boolean (defaults to true)</td>
<td>Visibility.</td>
</tr>
<tr>
<td><code>extent</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a> | undefined</td>
<td>The bounding extent for layer rendering. The layer will not be rendered outside of this extent.</td>
</tr>
<tr>
<td><code>zIndex</code></td>
<td>number | undefined</td>
<td>The z-index for layer rendering. At rendering time, the layers will be ordered, first by Z-index and then by position. When <code>undefined</code>, a <code>zIndex</code> of 0 is assumed for layers that are added to the map’s <code>layers</code> collection, or <code>Infinity</code> when the layer’s <code>setMap()</code> method was used.</td>
</tr>
<tr>
<td><code>minResolution</code></td>
<td>number | undefined</td>
<td>The minimum resolution (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxResolution</code></td>
<td>number | undefined</td>
<td>The maximum resolution (exclusive) below which this layer will be visible.</td>
</tr>
<tr>
<td><code>minZoom</code></td>
<td>number | undefined</td>
<td>The minimum view zoom level (exclusive) above which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxZoom</code></td>
<td>number | undefined</td>
<td>The maximum view zoom level (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>background</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base.html#~BackgroundColor">BackgroundColor</a> | undefined</td>
<td>Background color for the layer. If not specified, no background will be rendered.</td>
</tr>
<tr>
<td><code>properties</code></td>
<td>Object.&lt;string, *&gt; | undefined</td>
<td>Arbitrary observable properties. Can be accessed with <code>#get()</code> and <code>#set()</code>.</td>
</tr>
</tbody></table>
<p><strong>特别注意</strong><br><code>extent</code> : 图层渲染的边界范围。图层不会在此范围之外渲染<br><code>zIndex</code> : 图层渲染的级别，跟css样式的dom渲染级别是一样的，层级越大就显示在上一层<br><code>properties</code> : 任意可观察的属性。可以通过 <code>#get()</code>和访问<code>#set()</code>。<br><code>visible</code>: 图层的可见性，不可见图层不再请求数据</p>
<h4 id="Fires-6"><a href="#Fires-6" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721788337157.png" alt="QQ_1721788337157.png"></p>
<h4 id="Extends-9"><a href="#Extends-9" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h4 id="Subclasses-3"><a href="#Subclasses-3" class="headerlink" title="Subclasses"></a>Subclasses</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Group-LayerGroup.html">LayerGroup</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html">Layer</a></li>
</ul>
<h3 id="Layer-图层父类"><a href="#Layer-图层父类" class="headerlink" title="Layer - 图层父类"></a>Layer - 图层父类</h3><blockquote>
<p>所有图层类型均由其派生的基类。</p>
</blockquote>
<h4 id="new-Layer-options"><a href="#new-Layer-options" class="headerlink" title="new Layer(options)"></a>new Layer(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-layer’)</td>
<td>A CSS class name to set to the layer element.</td>
</tr>
<tr>
<td><code>opacity</code></td>
<td>number (defaults to 1)</td>
<td>Opacity (0, 1).</td>
</tr>
<tr>
<td><code>visible</code></td>
<td>boolean (defaults to true)</td>
<td>Visibility.</td>
</tr>
<tr>
<td><code>extent</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a> | undefined</td>
<td>The bounding extent for layer rendering. The layer will not be rendered outside of this extent.</td>
</tr>
<tr>
<td><code>zIndex</code></td>
<td>number | undefined</td>
<td>The z-index for layer rendering. At rendering time, the layers will be ordered, first by Z-index and then by position. When <code>undefined</code>, a <code>zIndex</code> of 0 is assumed for layers that are added to the map’s <code>layers</code> collection, or <code>Infinity</code> when the layer’s <code>setMap()</code> method was used.</td>
</tr>
<tr>
<td><code>minResolution</code></td>
<td>number | undefined</td>
<td>The minimum resolution (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxResolution</code></td>
<td>number | undefined</td>
<td>The maximum resolution (exclusive) below which this layer will be visible.</td>
</tr>
<tr>
<td><code>minZoom</code></td>
<td>number | undefined</td>
<td>The minimum view zoom level (exclusive) above which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxZoom</code></td>
<td>number | undefined</td>
<td>The maximum view zoom level (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>source</code></td>
<td>SourceType | undefined</td>
<td>Source for this layer. If not provided to the constructor, the source can be set by calling <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html#setSource"><code>layer.setSource(source)</code></a> after construction.</td>
</tr>
<tr>
<td><code>map</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html">Map</a> | null | undefined</td>
<td>Map.</td>
</tr>
<tr>
<td><code>render</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer.html#~RenderFunction">RenderFunction</a> | undefined</td>
<td>Render function. Takes the frame state as input and is expected to return an HTML element. Will overwrite the default rendering for the layer.</td>
</tr>
<tr>
<td><code>properties</code></td>
<td>Object.&lt;string, *&gt; | undefined</td>
<td>Arbitrary observable properties. Can be accessed with <code>#get()</code> and <code>#set()</code>.</td>
</tr>
</tbody></table>
<h4 id="Fires-7"><a href="#Fires-7" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724140128.png" alt="image.png"></p>
<p><strong>注意几个事件：</strong></p>
<ul>
<li>A generic <code>change</code> event is fired when <strong>the state of the source changes.</strong> </li>
<li>A <code>sourceready</code> event is fired when <strong>the layer’s source is ready.</strong></li>
<li><code>prerender</code> Triggered <strong>before a layer is rendered.</strong></li>
<li><code>postrender</code> Triggered <strong>after a layer is rendered.。</strong></li>
</ul>
<p><strong>所有图层都有上面这几个事件</strong></p>
<h4 id="Subclasses-4"><a href="#Subclasses-4" class="headerlink" title="Subclasses"></a>Subclasses</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_BaseImage-BaseImageLayer.html">BaseImageLayer</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_BaseTile-BaseTileLayer.html">BaseTileLayer</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_BaseVector-BaseVectorLayer.html">BaseVectorLayer</a></li>
</ul>
<h4 id="Extends-10"><a href="#Extends-10" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a></li>
</ul>
<h4 id="Observable-Properties-5"><a href="#Observable-Properties-5" class="headerlink" title="Observable Properties"></a>Observable Properties</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Settable</th>
<th><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a> type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>extent</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a> | undefined</td>
<td>yes</td>
<td><code>change:extent</code></td>
<td>The layer extent.</td>
</tr>
<tr>
<td><code>maxResolution</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:maxresolution</code></td>
<td>The maximum resolution of the layer.</td>
</tr>
<tr>
<td><code>maxZoom</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:maxzoom</code></td>
<td>The maximum zoom level of the layer.</td>
</tr>
<tr>
<td><code>minResolution</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:minresolution</code></td>
<td>The minimum resolution of the layer.</td>
</tr>
<tr>
<td><code>minZoom</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:minzoom</code></td>
<td>The minimum zoom level of the layer.</td>
</tr>
<tr>
<td><code>opacity</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:opacity</code></td>
<td>The opacity of the layer.</td>
</tr>
<tr>
<td><code>source</code></td>
<td>SourceType | null</td>
<td>yes</td>
<td><code>change:source</code></td>
<td>The layer source (or <code>null</code> if not yet set).</td>
</tr>
<tr>
<td><code>visible</code></td>
<td>boolean</td>
<td>yes</td>
<td><code>change:visible</code></td>
<td>The value of the <code>visible</code> property of the layer.</td>
</tr>
<tr>
<td><code>zIndex</code></td>
<td>number | undefined</td>
<td>yes</td>
<td><code>change:zindex</code></td>
<td>The Z-index of the layer.</td>
</tr>
</tbody></table>
<h3 id="Source-抽象基类"><a href="#Source-抽象基类" class="headerlink" title="Source 抽象基类"></a>Source 抽象基类</h3><blockquote>
<p>Abstract base class; normally only used for creating subclasses and not instantiated in apps. Base class for <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html"><code>Layer</code></a> sources.<br>A generic <code>change</code> event is triggered when the state of the source changes.</p>
</blockquote>
<h4 id="new-Source-options"><a href="#new-Source-options" class="headerlink" title="new Source(options)"></a>new Source(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>attributions</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Source.html#~AttributionLike">AttributionLike</a> | undefined</td>
<td>Attributions.</td>
</tr>
<tr>
<td><code>attributionsCollapsible</code></td>
<td>boolean (defaults to true)</td>
<td>Attributions are collapsible.</td>
</tr>
<tr>
<td><code>projection</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_proj.html#~ProjectionLike">ProjectionLike</a> | undefined</td>
<td>Projection. Default is the view projection.</td>
</tr>
<tr>
<td><code>state</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Source.html#~State">State</a> (defaults to ‘ready’)</td>
<td>State.</td>
</tr>
<tr>
<td><code>wrapX</code></td>
<td>boolean (defaults to false)</td>
<td>WrapX.</td>
</tr>
<tr>
<td><code>interpolate</code></td>
<td>boolean (defaults to false)</td>
<td>Use interpolated values when resampling. By default, the nearest neighbor is used when resampling.</td>
</tr>
</tbody></table>
<h4 id="Fires-8"><a href="#Fires-8" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721888439132.png" alt="QQ_1721888439132.png"></p>
<h4 id="Subclasses-5"><a href="#Subclasses-5" class="headerlink" title="Subclasses"></a>Subclasses</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Image-ImageSource.html">ImageSource</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Tile-TileSource.html">TileSource</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Vector-VectorSource.html">VectorSource</a></li>
</ul>
<h4 id="Extends-11"><a href="#Extends-11" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="ImageLayer-影像数据"><a href="#ImageLayer-影像数据" class="headerlink" title="ImageLayer - 影像数据"></a>ImageLayer - 影像数据</h3><p>使用 layer.image+source.image 方式加载，从浏览器加载情况看，影像就是一张 image</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721802838212.png" alt="QQ_1721802838212.png|711"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 影像数据</span></span><br><span class="line"><span class="keyword">const</span> imageLayer = <span class="keyword">new</span> ImageLayer(&#123;</span><br><span class="line">  <span class="attr">source</span>: <span class="keyword">new</span> ImageArcGISRest(&#123;</span><br><span class="line">    <span class="attr">ratio</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://sampleserver6.arcgisonline.com/ArcGIS/rest/services/&#x27;</span> + <span class="string">&#x27;USA/MapServer&#x27;</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">opacity</span>: <span class="number">0.5</span>, <span class="comment">//透明度</span></span><br><span class="line">  <span class="attr">visible</span>: <span class="literal">true</span>, <span class="comment">//图层的可见性，不可见图层不再请求数据</span></span><br><span class="line">  <span class="attr">extent</span>: [-<span class="number">18372064.265054375</span>, <span class="number">642477.8989716391</span>, -<span class="number">3622231.734945626</span>, <span class="number">8495720.10102836</span>], <span class="comment">//图层渲染范围,该层将不会在此范围之外渲染。</span></span><br><span class="line">  <span class="attr">zIndex</span>: <span class="number">1</span>, <span class="comment">//图层渲染的级别，跟css样式的dom渲染级别是一样的，层级越大就显示在上一层</span></span><br><span class="line">  <span class="attr">properties</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;ArcGISRest&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//图层渲染之前触发</span></span><br><span class="line">  imageLayer.on(<span class="string">&#x27;prerender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//在图层渲染完成之后触发</span></span><br><span class="line">  imageLayer.on(<span class="string">&#x27;postrender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="tileLayer-瓦片地图"><a href="#tileLayer-瓦片地图" class="headerlink" title="tileLayer - 瓦片地图"></a>tileLayer - 瓦片地图</h3><p>使用 layer.tile+source.tile 加载.。从浏览器加载可以看出，滚动鼠标浏览器在不断请求，由此可见矢量瓦片由很多个大小相同的图片组成，一般图片大小是 512*512 或 256*256</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>瓦片地图的工作原理如下：</p>
<p><strong>切割地图</strong>： 地图数据被分成许多小块，每个小块都被称为一个瓦片。瓦片通常是正方形，具有固定的尺寸，例如256x256像素。</p>
<p><strong>动态加载</strong>： 当用户在地图上进行平移或缩放操作时，OpenLayers 会动态加载新的瓦片。这些瓦片是根据用户当前视图的位置和缩放级别动态生成的。</p>
<p><strong>缓存</strong>： 为了提高性能，OpenLayers 通常会在用户浏览地图时缓存已经加载的瓦片。这样，当用户再次浏览同一区域时，OpenLayers 可以直接使用缓存中的瓦片，而不需要重新下载。</p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721803179122.png" alt="QQ_1721803179122.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tileLayer = <span class="keyword">new</span> TileLayer(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span><br><span class="line">    <span class="attr">zIndex</span>: <span class="number">0</span>, <span class="comment">//图层渲染级别</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//图层渲染之前触发</span></span><br><span class="line">  tileLayer.on(<span class="string">&#x27;prerender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//在图层渲染完成之后触发</span></span><br><span class="line">  tileLayer.on(<span class="string">&#x27;postrender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="VectorLayer-矢量地图"><a href="#VectorLayer-矢量地图" class="headerlink" title="VectorLayer - 矢量地图"></a>VectorLayer - 矢量地图</h3><p>一般使用 layer.vector+source.vector 方式加载。</p>
<p>矢量数据源一般有两种设置方式：</p>
<ul>
<li>一种是features 方法，静态加载矢量地图(如 <strong>geojson</strong>)，或者调用 addFeatrue()，addFeatrues()方法动态加载矢量地图；</li>
<li>另外一种是 url+format 方法，即设置矢量地图的 url 地址与数据格式 format 来加载矢量地图</li>
</ul>
<h4 id="方式1-："><a href="#方式1-：" class="headerlink" title="方式1 ："></a>方式1 ：</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721807569332.png" alt="QQ_1721807569332.png|695"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加静态矢量数据</span></span><br><span class="line"><span class="keyword">const</span> addStaticVector = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 静态矢量数据</span></span><br><span class="line">  <span class="keyword">let</span> geojson = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;FeatureCollection&#x27;</span>,</span><br><span class="line">    <span class="attr">features</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">geometry</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;Point&#x27;</span>,</span><br><span class="line">          <span class="attr">coordinates</span>: [<span class="number">87.16552734375</span>, <span class="number">39.470125122358176</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">geometry</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;LineString&#x27;</span>,</span><br><span class="line">          <span class="attr">coordinates</span>: [</span><br><span class="line">            [<span class="number">79.16748046874999</span>, <span class="number">37.61423141542417</span>],</span><br><span class="line">            [<span class="number">81.27685546875</span>, <span class="number">42.00032514831621</span>],</span><br><span class="line">            [<span class="number">84.111328125</span>, <span class="number">41.52502957323801</span>],</span><br><span class="line">            [<span class="number">84.66064453125</span>, <span class="number">43.229195113965005</span>],</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">geometry</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;Polygon&#x27;</span>,</span><br><span class="line">          <span class="attr">coordinates</span>: [</span><br><span class="line">            [</span><br><span class="line">              [<span class="number">81.71630859375</span>, <span class="number">40.49709237269567</span>],</span><br><span class="line">              [<span class="number">82.0458984375</span>, <span class="number">37.21283151445594</span>],</span><br><span class="line">              [<span class="number">86.220703125</span>, <span class="number">36.59788913307022</span>],</span><br><span class="line">              [<span class="number">86.06689453125</span>, <span class="number">41.04621681452063</span>],</span><br><span class="line">              [<span class="number">81.71630859375</span>, <span class="number">40.49709237269567</span>],</span><br><span class="line">            ],</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 矢量几何要素的样式</span></span><br><span class="line">  <span class="keyword">let</span> image = <span class="keyword">new</span> Circle(&#123;</span><br><span class="line">    <span class="attr">radius</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">fill</span>: <span class="literal">undefined</span>,</span><br><span class="line">    <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123; <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>, <span class="attr">width</span>: <span class="number">1</span> &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> styles = &#123;</span><br><span class="line">    <span class="attr">Point</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="comment">//点样式</span></span><br><span class="line">        <span class="attr">image</span>: image,</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">LineString</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">          <span class="comment">//线的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">Polygon</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">          <span class="comment">//区的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>,</span><br><span class="line">          <span class="attr">lineDash</span>: [<span class="number">4</span>],</span><br><span class="line">          <span class="attr">width</span>: <span class="number">3</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span><br><span class="line">          <span class="comment">//区的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;rgba(0, 0, 255, 0.1)&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">LinearRing</span>: [],</span><br><span class="line">    <span class="attr">MultiLineString</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">          <span class="comment">//多线的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">MultiPoint</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="comment">//多点的点样式</span></span><br><span class="line">        <span class="attr">image</span>: image,</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">MultiPolygon</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">          <span class="comment">//多区的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;yellow&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span><br><span class="line">          <span class="comment">//多区的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 0, 0.1)&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">GeometryCollection</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">          <span class="comment">//集合要素的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">2</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span><br><span class="line">          <span class="comment">//集合要素的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">image</span>: <span class="keyword">new</span> Circle(&#123;</span><br><span class="line">          <span class="comment">//集合要素的点样式</span></span><br><span class="line">          <span class="attr">radius</span>: <span class="number">10</span>,</span><br><span class="line">          <span class="attr">fill</span>: <span class="literal">undefined</span>,</span><br><span class="line">          <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span><br><span class="line">          &#125;),</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">Circle</span>: [</span><br><span class="line">      <span class="keyword">new</span> Style(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">          <span class="comment">//圆的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">2</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span><br><span class="line">          <span class="comment">//圆的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.2)&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span><br><span class="line">  <span class="keyword">const</span> styleFunction = <span class="function">(<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> type = feature.getGeometry()?.getType();</span><br><span class="line">    <span class="keyword">if</span> (type) <span class="keyword">return</span> styles[type];</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置地图投影</span></span><br><span class="line">  <span class="keyword">let</span> projection = <span class="keyword">new</span> Projection(&#123;</span><br><span class="line">    <span class="attr">code</span>: <span class="string">&#x27;EPSG:3857&#x27;</span>, <span class="comment">//投影编码</span></span><br><span class="line">    <span class="attr">units</span>: <span class="string">&#x27;degrees&#x27;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> geo = <span class="keyword">new</span> GeoJSON(); <span class="comment">// 定义geojson的数据格式</span></span><br><span class="line">  <span class="comment">//读取要素数据</span></span><br><span class="line">  <span class="keyword">let</span> featrue = geo.readFeatures(geojson, &#123;</span><br><span class="line">    <span class="attr">featureProjection</span>: projection,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 给数据源添加要素</span></span><br><span class="line">  <span class="keyword">const</span> vectorSource = <span class="keyword">new</span> VectorSource();</span><br><span class="line">  vectorSource.addFeatures(featrue);</span><br><span class="line">  <span class="comment">// 构建矢量图层</span></span><br><span class="line">  <span class="keyword">const</span> vectorLayer = <span class="keyword">new</span> VectorLayer(&#123;</span><br><span class="line">    <span class="attr">source</span>: vectorSource, <span class="comment">// 定义geojson的数据格式</span></span><br><span class="line">    <span class="attr">style</span>: styleFunction <span class="keyword">as</span> StyleLike, <span class="comment">// 样式设置</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(vectorLayer);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="方式2："><a href="#方式2：" class="headerlink" title="方式2："></a>方式2：</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724170412.png" alt="image.png|714"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="comment">// 添加矢量图层 并选择要素时高亮</span></span><br><span class="line"><span class="keyword">const</span> addVectorLayer = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 要素样式</span></span><br><span class="line">  <span class="keyword">const</span> style = <span class="keyword">new</span> Style(&#123;</span><br><span class="line">    <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 255, 0.6)&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&#x27;#319FD3&#x27;</span>,</span><br><span class="line">      <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">text</span>: <span class="keyword">new</span> Text(),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vectorLayer = <span class="keyword">new</span> VectorLayer(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3Aprovincial_boundaries&amp;maxFeatures=50&amp;outputFormat=application%2Fjson&#x27;</span>,</span><br><span class="line">      <span class="attr">format</span>: <span class="keyword">new</span> GeoJSON(), <span class="comment">//指定数据读取格式</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">style</span>: <span class="function">(<span class="params">feature</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//指定样式函数</span></span><br><span class="line">      style?.getText()?.setText(feature.get(<span class="string">&#x27;name&#x27;</span>));</span><br><span class="line">      <span class="keyword">return</span> style;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(vectorLayer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置矢量图层的高亮</span></span><br><span class="line">  <span class="keyword">const</span> featureOverlay = <span class="keyword">new</span> VectorLayer(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(),</span><br><span class="line">    <span class="attr">map</span>: map,</span><br><span class="line">    <span class="attr">style</span>: <span class="keyword">new</span> Style(&#123;</span><br><span class="line">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#f00&#x27;</span>,</span><br><span class="line">        <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.1)&#x27;</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> highlight: Feature&lt;Geometry&gt; | <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 由像素值获取点击要素 并显示要素信息</span></span><br><span class="line">  <span class="keyword">const</span> displayFeatureInfo = <span class="keyword">async</span> (pixel: Pixel) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> layer = map.getLayers().item(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (layer <span class="keyword">instanceof</span> VectorLayer) &#123;</span><br><span class="line">      <span class="keyword">let</span> features = <span class="keyword">await</span> layer.getFeatures(pixel);</span><br><span class="line">      <span class="keyword">let</span> feature = features.length &gt; <span class="number">0</span> ? features[<span class="number">0</span>] : <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">if</span> (feature) &#123;</span><br><span class="line">        <span class="comment">//获取到的要素的名称渲染到，屏幕左上角</span></span><br><span class="line">        info.value!.innerHTML = feature.get(<span class="string">&#x27;name&#x27;</span>); <span class="comment">// !为not null的断言操作符</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        info.value!.innerHTML = <span class="string">&#x27;&amp;nbsp;&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//没有高亮的要素就要恢复之前的效果</span></span><br><span class="line">      <span class="keyword">if</span> (feature !== highlight) &#123;</span><br><span class="line">        <span class="keyword">if</span> (highlight) &#123;</span><br><span class="line">          featureOverlay?.getSource()?.removeFeature(highlight);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (feature) &#123;</span><br><span class="line">          featureOverlay?.getSource()?.addFeature(feature <span class="keyword">as</span> Feature&lt;Geometry&gt;);</span><br><span class="line">        &#125;</span><br><span class="line">        highlight = feature <span class="keyword">as</span> Feature&lt;Geometry&gt;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//地图鼠标移动事件</span></span><br><span class="line">  map.on(<span class="string">&#x27;pointermove&#x27;</span>, <span class="function">(<span class="params">evt</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//没有拖拽地图触发，将鼠标事件的像素值传入</span></span><br><span class="line">    <span class="keyword">if</span> (!evt.dragging) &#123;</span><br><span class="line">      displayFeatureInfo(evt.pixel);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//地图点击触发函数，将鼠标事件的像素值传入</span></span><br><span class="line">  map.on(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">evt</span>) =&gt;</span> &#123;</span><br><span class="line">    displayFeatureInfo(evt.pixel);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="VectorTileLayer-矢量瓦片"><a href="#VectorTileLayer-矢量瓦片" class="headerlink" title="VectorTileLayer - 矢量瓦片"></a>VectorTileLayer - 矢量瓦片</h3><blockquote>
<p>Mapbox 由于配合其矢量瓦片 PBF 格式（“Protocolbuffer 二进制格式”）文件，有突出的渲染性能，被很多公司和开发者所使用。矢量瓦片的格式有很多种，其中 PBF 格式是一种二进制文件，直接把数据信息压缩位二进制了。</p>
</blockquote>
<h4 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h4><ul>
<li>数据传输量小，相对与栅格瓦片数据量大大缩小，PBF 主要用于替代 XML 格式。 与 gzip 压缩的相比，写入速度也要快 5 倍，而且读取速度要比 gzip 压缩的要快 6 倍。</li>
<li>不受分辨率影响，矢量瓦片无论在地图放大到各种级别都是清晰的，都不会出现栅格放大后显示像元的问题。</li>
<li>动态样式，矢量瓦片会根据用户的定制的样式动态绘制，也可以动态改变</li>
<li>支持前端查询，由于使用的是矢量瓦片，可以在前端直接进行信息查询</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>坐标和属性信息是可以被用户解析的，也就是安全性的问题</li>
</ul>
<h4 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h4><p>使用 layer.VectorTileLayer + source.VectorTile 实现，其中 format 为new MVT()</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721814840545.png" alt="QQ_1721814840545.png|857"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import &#123; Zoom, ZoomSlider, ZoomToExtent &#125; from &#x27;ol/control&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import OSM from &#x27;ol/source/OSM.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; defaults as defaultControls &#125; from &#x27;ol/control.js&#x27;;</span><br><span class="line">import type MapEvent from &#x27;ol/MapEvent&#x27;;</span><br><span class="line">import VectorTileLayer from &#x27;ol/layer/VectorTile&#x27;;</span><br><span class="line">import VectorTile from &#x27;ol/source/VectorTile.js&#x27;;</span><br><span class="line">import MVT from &#x27;ol/format/MVT.js&#x27;;</span><br><span class="line">import type MapBrowserEvent from &#x27;ol/MapBrowserEvent&#x27;;</span><br><span class="line">let map: Map;</span><br><span class="line">const info = ref&lt;HTMLElement | null&gt;(null);</span><br><span class="line"></span><br><span class="line">// 添加矢量瓦片类型图层 并为map设置pointermove事件</span><br><span class="line">const addVectorTileLayer = () =&gt; &#123;</span><br><span class="line">  const vectorTileLayer = new VectorTileLayer(&#123;</span><br><span class="line">    source: new VectorTile(&#123;</span><br><span class="line">      format: new MVT(), //设置矢量瓦片类型资源</span><br><span class="line">      url: &#x27;https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/&#x27; + &#x27;ne:ne_10m_admin_0_countries@EPSG%3A900913@pbf/&#123;z&#125;/&#123;x&#125;/&#123;-y&#125;.pbf&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(vectorTileLayer);</span><br><span class="line"></span><br><span class="line">  // 为map设置pointermove事件</span><br><span class="line">  map.on(&#x27;pointermove&#x27;, (event: MapBrowserEvent&lt;any&gt;) =&gt; &#123;</span><br><span class="line">    // 获取到鼠标当前像素所获取到的要素</span><br><span class="line">    const features = map.getFeaturesAtPixel(event.pixel);</span><br><span class="line">    if (features.length == 0) &#123;</span><br><span class="line">      if (info.value) &#123;</span><br><span class="line">        info.value!.innerText = &#x27;&#x27;;</span><br><span class="line">        info.value.style!.opacity = &#x27;0&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(features);</span><br><span class="line">    const properties = features[0].getProperties();</span><br><span class="line">    console.log(properties);</span><br><span class="line">    if (info.value) &#123;</span><br><span class="line">      info.value.innerText = JSON.stringify(properties, null, 2);</span><br><span class="line">      info.value.style!.opacity = &#x27;1&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: [0, 0],</span><br><span class="line">      zoom: 2,</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [],</span><br><span class="line">  &#125;);</span><br><span class="line">  addVectorTileLayer();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">#info &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 10px;</span><br><span class="line">  right: 50px;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="瓦片网格"><a href="#瓦片网格" class="headerlink" title="瓦片网格"></a>瓦片网格</h3><blockquote>
<p>就是带有格网的瓦片</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721823340891.png" alt="QQ_1721823340891.png|1090"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; TileDebug, XYZ &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; fromLonLat &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/proj&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//实例化图层数据源对象</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> TiandituSource = <span class="keyword">new</span> XYZ(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">url</span>: <span class="string">&#x27;http://t0.tianditu.com/DataServer?T=vec_w&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">attributions</span>: <span class="string">&#x27;天地图的属性描述&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">wrapX</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//加载瓦片网格图层</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> tileLayer = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> TileDebug(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//获取瓦片图层数据对象（osmSource）的网格信息</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">tileGrid</span>: TiandituSource.getTileGrid()!,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: fromLonLat([<span class="number">87.16552734375</span>, <span class="number">39.470125122358176</span>]),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">8</span>, <span class="comment">//地图初始显示级别</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [tileLayer],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>``</p>
<h3 id="各渠道地图"><a href="#各渠道地图" class="headerlink" title="各渠道地图"></a>各渠道地图</h3><h4 id="高德地图"><a href="#高德地图" class="headerlink" title="高德地图"></a>高德地图</h4><blockquote>
<p>高德地图也是一种瓦片图层，是通过行列号与层级(zoom)关系加载的<br>Layer.TileLayer + Source.XYZ</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870326007.png" alt="QQ_1721870326007.png|954"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; XYZ &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//高德地图也是一种瓦片图层，是通过行列号与层级(zoom)关系加载的</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> gaodeMapLayer = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> XYZ(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">url</span>: <span class="string">&#x27;http://wprd0&#123;1-4&#125;.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;z=&#123;z&#125;&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">wrapX</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">12958752</span>, <span class="number">4848452</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:3857&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">8</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">minZoom</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [gaodeMapLayer],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="天地图"><a href="#天地图" class="headerlink" title="天地图"></a>天地图</h4><blockquote>
<p>Layer.TileLayer + Source.XYZ</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870387476.png" alt="QQ_1721870387476.png|778"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-checkbox-group</span> <span class="attr">v-model</span>=<span class="string">&quot;checkList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in layerList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;(checked: boolean) =&gt; layerCtl(checked, i)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-checkbox-group</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; transform &#125; from &#x27;ol/proj&#x27;;</span><br><span class="line">import XYZ from &#x27;ol/source/XYZ&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line">// 选中的图层</span><br><span class="line">const checkList = ref&lt;string[]&gt;([]);</span><br><span class="line">// 所有图层</span><br><span class="line">const layerList = ref&lt;string[]&gt;([]);</span><br><span class="line"></span><br><span class="line">// 图层选择</span><br><span class="line">const layerCtl = (checked: boolean, index: number) =&gt; &#123;</span><br><span class="line">  let layers = map.getLayers();</span><br><span class="line">  layers?.getArray()[index].setVisible(checked);</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  // 加载瓦片图层数据(天地图矢量图层)</span><br><span class="line">  const VectorLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27;http://t0.tianditu.com/DataServer?T=vec_w&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">      wrapX: false,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  VectorLayer.set(&#x27;name&#x27;, &#x27;天地图矢量图层&#x27;);</span><br><span class="line">  // 天地图矢量图层注记</span><br><span class="line">  const VectorNoteLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27;http://t0.tianditu.com/DataServer?T=cva_w&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">      wrapX: false,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  VectorNoteLayer.set(&#x27;name&#x27;, &#x27;天地图矢量图层注记&#x27;);</span><br><span class="line">  // 天地图路网</span><br><span class="line">  const roadLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27;https://t0.tianditu.gov.cn/DataServer?T=vec_w&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  roadLayer.set(&#x27;name&#x27;, &#x27;天地图路网&#x27;);</span><br><span class="line">  // 天地图文字标注</span><br><span class="line">  const textNoteLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27;https://t0.tianditu.gov.cn/DataServer?T=cia_w&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  textNoteLayer.set(&#x27;name&#x27;, &#x27;天地图文字标注&#x27;);</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: transform([114.5, 38.0], &#x27;EPSG:4326&#x27;, &#x27;EPSG:3857&#x27;),</span><br><span class="line">      zoom: 11,</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [VectorLayer, VectorNoteLayer, roadLayer, textNoteLayer],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 获取map中图层</span><br><span class="line">  const allLayer = map.getAllLayers();</span><br><span class="line">  allLayer.forEach((e) =&gt; &#123;</span><br><span class="line">    layerList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">    checkList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 20px;</span><br><span class="line">  top: 20px;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Bing-地图"><a href="#Bing-地图" class="headerlink" title="Bing 地图"></a>Bing 地图</h4><blockquote>
<p>bingMapS其实也是一种地图瓦片，采用的是瓦片方式加载，需要用到瓦片地图渲染<br>Layer.TileLayer+Source.BingMaps</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870463613.png" alt="QQ_1721870463613.png|642"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; BingMaps &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; fromLonLat &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/proj&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//实例化Map对象加载地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> key = <span class="string">&#x27;Q57tupj2UBsQNQdju4xL~xBceblfTd6icjljunbuaCw~AhwA-whmGMsfIpVhslZyknWhFYq-GvWJZqBnqV8Zq1uRlI5YM_qr7_hxvdgnU7nH&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// bingMapS其实也是一种地图瓦片，采用的是瓦片方式加载，需要用到瓦片地图渲染</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> roads = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> BingMaps(&#123; <span class="attr">key</span>: key, <span class="attr">imagerySet</span>: <span class="string">&#x27;Road&#x27;</span> &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [roads],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: fromLonLat([-<span class="number">109</span>, <span class="number">46.5</span>]),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">6</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="ArcGIS"><a href="#ArcGIS" class="headerlink" title="ArcGIS"></a>ArcGIS</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870905400.png" alt="QQ_1721870905400.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-checkbox-group</span> <span class="attr">v-model</span>=<span class="string">&quot;checkList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in layerList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;(checked: boolean) =&gt; layerCtl(checked, i)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-checkbox-group</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; TileArcGISRest, XYZ &#125; from &#x27;ol/source&#x27;;</span><br><span class="line">import &#123; fromLonLat &#125; from &#x27;ol/proj&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line">// 选中的图层</span><br><span class="line">const checkList = ref&lt;string[]&gt;([]);</span><br><span class="line">// 所有图层</span><br><span class="line">const layerList = ref&lt;string[]&gt;([]);</span><br><span class="line"></span><br><span class="line">// 图层选择</span><br><span class="line">const layerCtl = (checked: boolean, index: number) =&gt; &#123;</span><br><span class="line">  let layers = map.getLayers();</span><br><span class="line">  layers?.getArray()[index].setVisible(checked);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  // 加载arcGIS的MapServer地图</span><br><span class="line">  // arcGIS的地图影像都是通过地图影像切片，将数据裁切成512*512/256*256的大小的图片，加载</span><br><span class="line">  const arcGISMapServerLayer = new TileLayer(&#123;</span><br><span class="line">    source: new TileArcGISRest(&#123;</span><br><span class="line">      url: &#x27;https://server.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  arcGISMapServerLayer.set(&#x27;name&#x27;, &#x27;TileArcGISRest&#x27;);</span><br><span class="line"></span><br><span class="line">  const arcGISTileLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27;http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  arcGISTileLayer.set(&#x27;name&#x27;, &#x27;XYZ&#x27;);</span><br><span class="line"></span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: fromLonLat([87.16552734375, 39.470125122358176]),</span><br><span class="line">      zoom: 5,</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [arcGISMapServerLayer, arcGISTileLayer],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 获取map中图层</span><br><span class="line">  const allLayer = map.getAllLayers();</span><br><span class="line">  allLayer.forEach((e) =&gt; &#123;</span><br><span class="line">    layerList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">    checkList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 20px;</span><br><span class="line">  top: 20px;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="JSON-相关"><a href="#JSON-相关" class="headerlink" title="JSON 相关"></a>JSON 相关</h3><h4 id="GeoJSON"><a href="#GeoJSON" class="headerlink" title="GeoJSON"></a>GeoJSON</h4><h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><p>GeoJSON 是一种对各种地理数据结构进行编码的格式，基于 Javascript 对象表示法(JavaScript Object Notation, 简称 JSON)的地理空间信息数据交换格式。GeoJSON 对象可以表示几何、特征或者特征集合。</p>
<p>GeoJSON 支持下面几何类型：点、线、面、多点、多线、多面和几何集合。</p>
<p>GeoJSON 里的特征包含一个几何对象和其他属性，特征集合表示一系列特征。</p>
<p>一个完整的 GeoJSON 数据结构总是一个（JSON 术语里的）对象。在 GeoJSON 里，对象由名/值对–也称作成员的集合组成。对每个成员来说，名字总是字符串。成员的值要么是字符串、数字、对象、数组，要么是下面文本常量中的一个：”true”,”false”和”null”。数组的值是上面所说的元素组成。GeoJSON 总是由一个单独的对象组成。这个对象（指的是下面的 GeoJSON 对象）表示几何、特征或者特征集合。GeoJSON 对象可能有任何数目成员（名/值对）。</p>
<p>GeoJSON 对象必须有一个名字为”type”的成员。这个成员的值是由 GeoJSON 对象的类型所确定的字符串。type 成员的值必须是下面之一：</p>
<ul>
<li>Point</li>
<li>MultiPoint</li>
<li>LineString</li>
<li>MultiLineString</li>
<li>Polygon</li>
<li>MultiPolygon</li>
<li>GeometryCollection</li>
<li>Feature</li>
<li>FeatureCollection</li>
</ul>
<p>GeoJSON 对象可能有一个可选的”crs”成员，它的值必须是一个坐标参考系统的对象。</p>
<p>GeoJSON 对象可能有一个”bbox”成员，它的值必须是边界框数组。</p>
<h5 id="new-GeoJSON-options"><a href="#new-GeoJSON-options" class="headerlink" title="new GeoJSON(options)"></a>new GeoJSON(options)</h5><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721876969291.png" alt="QQ_1721876969291.png"></p>
<h5 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h5><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871220939.png" alt="QQ_1721871220939.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> CircleStyle <span class="keyword">from</span> <span class="string">&#x27;ol/style/Circle&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Fill, Stroke, Style &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type Feature <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; Geometry &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorSource <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> GeoJSON <span class="keyword">from</span> <span class="string">&#x27;ol/format/GeoJSON&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; StyleLike &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style/Style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> addGeoJsonLayer = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//定义各种要素的样式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> image = <span class="keyword">new</span> CircleStyle(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">radius</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> styles = &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">Point</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">LineString</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">Polygon</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">lineDash</span>: [<span class="number">4</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(0, 0, 255, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">LinearRing</span>: [],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">MultiPoint</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">MultiLineString</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">MultiPolygon</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;yellow&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 0, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">GeometryCollection</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">image</span>: <span class="keyword">new</span> CircleStyle(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">radius</span>: <span class="number">10</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">Circle</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.2)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> styleFunction = <span class="function">(<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> type = feature.getGeometry()?.getType();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (type) <span class="keyword">return</span> styles[type];</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> vectorLayer = <span class="keyword">new</span> VectorLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">url</span>: <span class="string">&#x27;http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3Aprovincial_boundaries&amp;maxFeatures=50&amp;outputFormat=application%2Fjson&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">format</span>: <span class="keyword">new</span> GeoJSON(), <span class="comment">//指定数据读取格式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">style</span>: styleFunction <span class="keyword">as</span> StyleLike,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map.addLayer(vectorLayer);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">4</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    ],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  addGeoJsonLayer();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br></pre></td></tr></table></figure>

<h4 id="TopoJSON"><a href="#TopoJSON" class="headerlink" title="TopoJSON"></a>TopoJSON</h4><h5 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h5><p>TopoJSON 是 GeoJSON 的扩展，增加了拓扑逻辑的编码。支持多种几何图形类型：Point、LineString、Polygon、MultiPoint、MultiLineString、MultiPolygon 和 GeometryCollection。TopoJSON 中的几何图形可能包含用于编码非几何数据的附加属性。</p>
<p>TopoJSON 文件中的几何图形不是独立地表示，而是由共享的线段（称为弧线）拼接而成，即 TopoJSON 中的每一个几何体都是通过将共享边（被称为 arcs）整合后组成的。</p>
<p>因此TopoJSON 消除了冗余，提供了比 GeoJSON 更紧凑的几何表示；典型的 TopoJSON 文件比GeoJSON 等价文件小 80%。原因：</p>
<ol>
<li>边界线只记录一次（例如广西和广东的交界线只记录一次）;</li>
<li>地理坐标使用整数，不使用浮点数。</li>
</ol>
<p>其中：</p>
<ul>
<li>点状地理实体 - 由坐标表示</li>
<li>线状地理实体 - 由弧索引表示</li>
<li>多边形 - 由弧索引表示</li>
</ul>
<p>TopoJSON 文件由三部分组成：</p>
<ul>
<li>transform：描述了变换参数</li>
<li>objects：描述地理实体包含空间及属性信息</li>
<li>arcs： <strong>描述了有向弧的空间关系，弧由一系列起点及相对于起点的有向偏移坐标表示</strong></li>
</ul>
<p>geometries 中 <strong>arcs 如果是负值，说明逆序</strong>。基于这种弧的存储方式可以表达出拓扑关系。</p>
<p>由于弧只记录一次及地理坐标使用整数，不使用浮点数，相对于 GeoJSON，TopoJSON 消除了冗余，文件大小缩小了 80%。</p>
<p>topojson 格式说明： <a target="_blank" rel="noopener" href="https://github.com/topojson/topojson-specification">https://github.com/topojson/topojson-specification</a></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871937882.png" alt="QQ_1721871937882.png|732"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Topology&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;transform&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;scale&quot;</span>: [<span class="number">0.0005000500050005</span>, <span class="number">0.00010001000100010001</span>],</span><br><span class="line">    <span class="attr">&quot;translate&quot;</span>: [<span class="number">100</span>, <span class="number">0</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;objects&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;example&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;GeometryCollection&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;geometries&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Point&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;prop0&quot;</span>: <span class="string">&quot;value0&quot;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">&quot;coordinates&quot;</span>: [<span class="number">4000</span>, <span class="number">5000</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;LineString&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;prop0&quot;</span>: <span class="string">&quot;value0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;prop1&quot;</span>: <span class="number">0</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">&quot;arcs&quot;</span>: [<span class="number">0</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Polygon&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;prop0&quot;</span>: <span class="string">&quot;value0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;prop1&quot;</span>: &#123;</span><br><span class="line">              <span class="attr">&quot;this&quot;</span>: <span class="string">&quot;that&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">&quot;arcs&quot;</span>: [[<span class="number">1</span>]]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;arcs&quot;</span>: [</span><br><span class="line">    [[<span class="number">4000</span>, <span class="number">0</span>], [<span class="number">1999</span>, <span class="number">9999</span>], [<span class="number">2000</span>, <span class="number">-9999</span>], [<span class="number">2000</span>, <span class="number">9999</span>]],</span><br><span class="line">    [[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">9999</span>], [<span class="number">2000</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">-9999</span>], [<span class="number">-2000</span>, <span class="number">0</span>]]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a>代码实现</h5><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871420626.png" alt="QQ_1721871420626.png|843"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Fill, Stroke, Style &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorSource <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TopoJSON <span class="keyword">from</span> <span class="string">&#x27;ol/format/TopoJSON&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> style = <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 255, 0.6)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">color</span>: <span class="string">&#x27;#319FD3&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> VectorLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">url</span>: <span class="string">&#x27;/GisData/topojson/world-110m.json&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">format</span>: <span class="keyword">new</span> TopoJSON(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// don&#x27;t want to render the full world polygon (stored as &#x27;land&#x27; layer),</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// which repeats all countries</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">layers</span>: [<span class="string">&#x27;countries&#x27;</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">overlaps</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">style</span>: style,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="built_in">console</span>.log(vector.getSource()?.getFeatures());</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">0</span>, <span class="number">0</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [vector],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>注意：这里 GisData 在 public 里</strong></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871298439.png"></p>
<h5 id="Geojson-与-Topojson-之间的转换"><a href="#Geojson-与-Topojson-之间的转换" class="headerlink" title="Geojson 与 Topojson 之间的转换"></a>Geojson 与 Topojson 之间的转换</h5><p><code>npm install -g topojson -s</code></p>
<p>topojson.topology 转换 GeoJSON to TopoJSON.</p>
<p>geo2topo 转换 GeoJSON to TopoJSON</p>
<p>详情见：<a target="_blank" rel="noopener" href="https://github.com/topojson/topojson">GitHub - topojson/topojson: An extension of GeoJSON that encodes topology! 🌐</a></p>
<h4 id="Esrijson"><a href="#Esrijson" class="headerlink" title="Esrijson"></a>Esrijson</h4><h5 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h5><p>EsriJSON 是一种用于对各种地理数据结构进行编码的格式。对于 EsriJSON，其通常是指FeatureSet 对象，其中 FeatureSet 包含一组 Feature 对象。在 ArcGIS Velocity 中，可以将EsriJSON 提取为 FeatureSet 对象（要素集合）或者将单个 Feature 对象提取为行。</p>
<ul>
<li>支持的 EsriJSON：Velocity支持保持一致的几何类型、字段集合和空间参考的 EsriJSON。</li>
<li>生成 EsriJSON：可以使用 ArcGIS Pro 要素转 JSON 工具或 ArcMap 要素转 JSON 工具将数据从多种格式转换为 EsriJSON。</li>
</ul>
<p><strong>EsriJSON 要素属性必须保持一致</strong>：在 EsriJSON 数据格式中，属性数据用属性对象内的名称值对表示。任何属性的值都应该具有值或空值。如果要素的某个属性不具有值，则该属性值应以空值表示，而不应缺少该属性名称。</p>
<p><strong>EsriJSON 文件大小</strong>：最佳做法是，要提取的每个 EsriJSON 文件应小于 100 MB。如果要提取的数据量较大，建议将这些文件分解为每个文件 100 MB 以下。</p>
<h5 id="代码实现-4"><a href="#代码实现-4" class="headerlink" title="代码实现"></a>代码实现</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> CircleStyle <span class="keyword">from</span> <span class="string">&#x27;ol/style/Circle&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Fill, Stroke, Style &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type Feature <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; Geometry &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorSource <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> EsriJSON <span class="keyword">from</span> <span class="string">&#x27;ol/format/EsriJSON&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; StyleLike &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style/Style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//定义各种要素的样式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> image = <span class="keyword">new</span> CircleStyle(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">radius</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> styles = &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">Point</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">LineString</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">Polygon</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">lineDash</span>: [<span class="number">4</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(0, 0, 255, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">LinearRing</span>: [],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">MultiPoint</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">MultiLineString</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">MultiPolygon</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;yellow&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 0, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">GeometryCollection</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">image</span>: <span class="keyword">new</span> CircleStyle(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">radius</span>: <span class="number">10</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">Circle</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.2)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> styleFunction = <span class="function">(<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> type = feature.getGeometry()?.getType();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (type) <span class="keyword">return</span> styles[type];</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  axios</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    .get(<span class="string">&#x27;http://localhost:8888/openlayer/esrijson/esrijson.json&#x27;</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    .then(<span class="function">(<span class="params">response: any</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//指定数据格式是esrijson</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> esriJSON = <span class="keyword">new</span> EsriJSON();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> arr = response.data;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> vectorSource = <span class="keyword">new</span> VectorSource();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">for</span> (<span class="keyword">const</span> arrElement <span class="keyword">of</span> arr) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//读取后台响应的esrijson数据，读取要素信息，添加到矢量数据源</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> feature = esriJSON.readFeature(arrElement);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        vectorSource.addFeature(feature);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// let feature = esriJSON.readFeatures(arr);</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// vectorSource.addFeatures(feature);</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//将矢量图层添加到地图中</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> vector = <span class="keyword">new</span> VectorLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//矢量数据源</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">source</span>: vectorSource,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//样式设置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">style</span>: styleFunction <span class="keyword">as</span> StyleLike,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">layers</span>: [vector],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">center</span>: [<span class="number">0</span>, <span class="number">0</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">zoom</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>, <span class="comment">//指定投影</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error: any</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="built_in">console</span>.log(error);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br></pre></td></tr></table></figure>

<h5 id="Geojson-与-Esrijson-之间的转换"><a href="#Geojson-与-Esrijson-之间的转换" class="headerlink" title="Geojson 与 Esrijson 之间的转换"></a>Geojson 与 Esrijson 之间的转换</h5><p><code>npm install @esri/arcgis-to-geojson-utils</code></p>
<h3 id="WKT"><a href="#WKT" class="headerlink" title="WKT"></a>WKT</h3><h4 id="简介-3"><a href="#简介-3" class="headerlink" title="简介"></a>简介</h4><p>WKT(Well-known text)是一种文本标记语言，用于表示矢量几何对象、空间参照系统及空间参照系统之间的转换。</p>
<p>它的二进制表示方式，亦即 WKB(well-known binary)则胜于在传输和在数据库中存储相同的信息。该格式由开放地理空间联盟(OGC)制定。</p>
<ul>
<li><p>WKT - 几何对象：WKT 可以表示的几何对象包括：点，线，多边形，TIN（不规则三角网）及多面体。可以通过几何集合的方式来表示不同维度的几何对象。</p>
</li>
<li><p>几何物体的坐标可以是 2D(x,y),3D(x,y,z),4D(x,y,z,m),加上一个属于线性参照系统的 m 值。</p>
</li>
</ul>
<p>WKT 字串样例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POINT(<span class="number">6</span> <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">LINESTRING(<span class="number">3</span> <span class="number">4</span>,<span class="number">10</span> <span class="number">50</span>,<span class="number">20</span> <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line">POLYGON((<span class="number">1</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">1</span>),(<span class="number">2</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">MULTIPOINT(<span class="number">3.5</span> <span class="number">5.6</span>, <span class="number">4.8</span> <span class="number">10.5</span>)</span><br><span class="line"></span><br><span class="line">MULTILINESTRING((<span class="number">3</span> <span class="number">4</span>,<span class="number">10</span> <span class="number">50</span>,<span class="number">20</span> <span class="number">25</span>),(-<span class="number">5</span> -<span class="number">8</span>,-<span class="number">10</span> -<span class="number">8</span>,-<span class="number">15</span> -<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">MULTIPOLYGON(((<span class="number">1</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">1</span>),(<span class="number">2</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">2</span>)),((<span class="number">6</span> <span class="number">3</span>,<span class="number">9</span> <span class="number">2</span>,<span class="number">9</span> <span class="number">4</span>,<span class="number">6</span> <span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line">GEOMETRYCOLLECTION(POINT(<span class="number">4</span> <span class="number">6</span>),LINESTRING(<span class="number">4</span> <span class="number">6</span>,<span class="number">7</span> <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">POINT ZM (<span class="number">1</span> <span class="number">1</span> <span class="number">5</span> <span class="number">60</span>)   <span class="comment">// Z 一般代表高程信息，M 一般代表其他信息如距离、温度、浓度，湿度等</span></span><br><span class="line"></span><br><span class="line">POINT M (<span class="number">1</span> <span class="number">1</span> <span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<h4 id="代码实现-5"><a href="#代码实现-5" class="headerlink" title="代码实现"></a>代码实现</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872871517.png" alt="QQ_1721872871517.png|594"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> WKT <span class="keyword">from</span> <span class="string">&#x27;ol/format/WKT&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorSource <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> wkt = <span class="string">&#x27;POLYGON((10.689 -25.092, 34.595 &#x27;</span> + <span class="string">&#x27;-20.170, 38.814 -35.639, 13.502 &#x27;</span> + <span class="string">&#x27;-39.155, 10.689 -25.092))&#x27;</span>; <span class="comment">//wkt表示面的情况下，也是需要闭合的</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//指定数据加载的读取格式wkt</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> format = <span class="keyword">new</span> WKT();</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//用wkt读取要素信息</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> feature = format.readFeature(wkt, &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">dataProjection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>, <span class="comment">// 数据的投影坐标</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">featureProjection</span>: <span class="string">&#x27;EPSG:3857&#x27;</span>, <span class="comment">// 读取之后的要素的投影坐标</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//矢量图层</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> VectorLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">features</span>: [feature],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//地图渲染</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">2952104.0199</span>, -<span class="number">3277504.823</span>], <span class="comment">//中心点使用的是平面投影3857</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">4</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="WKB"><a href="#WKB" class="headerlink" title="WKB"></a>WKB</h3><h4 id="简介-4"><a href="#简介-4" class="headerlink" title="简介"></a>简介</h4><p>WKB 采用<strong>二进制</strong>进行存储，更方便于计算机处理，因此广泛运用于数据的传输与存储。其存储结构如下：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872526732.png" alt="QQ_1721872526732.png|1009"></p>
<p>以二位点 Point(1 1)为例，其 WKB 表达如下：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872587042.png" alt="QQ_1721872587042.png|682"></p>
<p>其中：</p>
<ul>
<li><strong>byteOrder</strong><br>第 1 个字节表示编码方式，00 为使用 big-endian 编码(XDR)，01 为使用 little-endian 编码(NDR)。他们的不同仅限于在内存中放置字节的顺序，比如我们将 0x1234abcd 写入到以 0×0000 开始的内存中，则结果如下表：<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872705284.png" alt="QQ_1721872705284.png"></li>
<li><strong>wkbType</strong><br>第 2 到第 9 字节对矢量数据基本信息进行了定义。<br>第 2 与第 3 个字节规定了矢量数据的类型，如例子中的 0100 代表 Point。<br>第 3 与第 4 个字节规定了矢量数据的维数，如例子中的 0020 代表该点是二维的。</li>
<li><strong>srid</strong><br>第 5 到第 9 个字节规定了矢量数据的空间参考 SRID，如例子中的 E6100000 是 4326 的整数十六位进制表达。</li>
<li><strong>structPoint</strong><br>第 10 个字节开始，每 16 个字节就代表一个坐标对，如例子中的 000000000000F03F 是浮点型 1 的十六进制表达</li>
</ul>
<h4 id="代码实现-6"><a href="#代码实现-6" class="headerlink" title="代码实现"></a>代码实现</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872884171.png" alt="QQ_1721872884171.png|714"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> WKB <span class="keyword">from</span> <span class="string">&#x27;ol/format/WKB&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorSource <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; SimpleGeometry &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//初始化osm的瓦片地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//wkb16进制的字符串表示</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> wkb =</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="string">&#x27;0103000020E61000000100000005000000AFA82D76AC9B5A404201744963AD4140CC9DB93DAE9B5A40740FC69561AD4140767163B4AE9B5A407948E4205EAD4140A5C08AA8AB9B5A400410172E61AD4140AFA82D76AC9B5A404201744963AD4140&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//指定加载的数据格式wkb</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> format = <span class="keyword">new</span> WKB();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//读取wkb</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> feature = format.readFeature(wkb, &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">/* 因为view指定了4326投影 与数据的投影一致 故不需要再转换投影 */</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// dataProjection: &#x27;EPSG:4326&#x27;,//数据投影</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// featureProjection: &#x27;EPSG:3857&#x27;,//要素投影</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//wkb也是矢量数据，只不过是矢量数据的二进制表示，因此数据需要使用矢量图层加载</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> VectorLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">features</span>: [feature],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">106.432666551</span>, <span class="number">35.354313681</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">15</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>, <span class="comment">//指定投影</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 跳转视图到要素所在位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map.getView().fit(feature.getGeometry() <span class="keyword">as</span> SimpleGeometry);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721812288654.png" alt="QQ_1721812288654.png|619"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721812338516.png" alt="QQ_1721812338516.png|756"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721812398558.png" alt="QQ_1721812398558.png|424"></p>
<h3 id="KML"><a href="#KML" class="headerlink" title="KML"></a>KML</h3><blockquote>
<p>KML(Keyhole Markup Language,Keyhole 标记语言)最初是由 Google 旗下的 Keyhole 公司开发和维护的一种基于 XML 的标记语言，利用 XML 语法格式描述地理空间数据(如点、线、面、<br>多边形和模型等)，适合网络环境下的地理信息协作与共享。2008 年 4 月,KML 的最新版本2.2 被 OGC 宣布为开放地理信息编码标准,并改由 OGC 维护和发展。</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721877380601.png" alt="QQ_1721877380601.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;infoDom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> KML <span class="keyword">from</span> <span class="string">&#x27;ol/format/KML&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Fill, Stroke, Style &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorSource <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; FeatureLike &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; Pixel &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/pixel&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> infoDom = ref&lt;HTMLElement | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 显示选择要素的属性信息</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> addEvent = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> displayFeatureInfo = <span class="function">(<span class="params">pixel: Pixel</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">const</span> features: FeatureLike[] = [];</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//遍历地图当前像素下的所有的矢量要素数据</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    map.forEachFeatureAtPixel(pixel, <span class="function">(<span class="params">feature</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      features.push(feature);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (features.length &gt; <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">const</span> info = [];</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">let</span> i, j;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//通过name属性获取到要素的值</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">for</span> (i = <span class="number">0</span>, j = features.length; i &lt; j; ++i) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        info.push(features[i].get(<span class="string">&#x27;name&#x27;</span>));</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//将要素的name值放到info框</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      infoDom.value!.innerHTML = info.join(<span class="string">&#x27;, &#x27;</span>) || <span class="string">&#x27;(unknown)&#x27;</span>; <span class="comment">//鼠标放在地图map上的鼠标样式：手型</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      map.getTargetElement().style.cursor = <span class="string">&#x27;pointer&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      infoDom.value!.innerHTML = <span class="string">&#x27;&amp;nbsp;&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      map.getTargetElement().style.cursor = <span class="string">&#x27;&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//地图的鼠标移动事件</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map.on(<span class="string">&#x27;pointermove&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (evt.dragging) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//获取到鼠标移动的像素信息</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">const</span> pixel = map.getEventPixel(evt.originalEvent);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    displayFeatureInfo(pixel);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//地图的鼠标点击事件</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map.on(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//获取到鼠标点击的像素信息</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    displayFeatureInfo(evt.pixel);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 设置样式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> style = <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 255, 0.6)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">color</span>: <span class="string">&#x27;#319FD3&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// osm地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> OSM(), <span class="comment">//加载OpenStreetMap</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//kml是矢量数据，需要使用矢量数据源加载，然后使用矢量图层渲染</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> VectorLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">url</span>: <span class="string">&#x27;http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3Aprovincial_boundaries&amp;maxFeatures=50&amp;outputFormat=application%2Fvnd.google-earth.kml%2Bxml&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// 指定数据读取格式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">format</span>: <span class="keyword">new</span> KML(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">writeStyles</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// 注意这里设置样式的不同</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">defaultStyle</span>: [style],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//渲染矢量图层</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">108.24981689453125</span>, <span class="number">35.126468438108688</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  addEvent();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#info</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">z-index</span>: <span class="number">999</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br></pre></td></tr></table></figure>

<p><strong>注意设置 style 的不同</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">format: <span class="keyword">new</span> KML(&#123;</span><br><span class="line">    <span class="attr">writeStyles</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 注意这里设置样式的不同</span></span><br><span class="line">    <span class="attr">defaultStyle</span>: [style],</span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721877497411.png" alt="QQ_1721877497411.png|1262"></p>
<h3 id="GML"><a href="#GML" class="headerlink" title="GML"></a>GML</h3><blockquote>
<p>地理标记语言（Geographic Markup Language）是由 OGC 定义的 XML（标准通用标记语言的子集）格式，用来表达地理信息要素。它提供一个表达地理信息要素的语言模型，同时可以<br>   用来在 Internet 上进行数据交换。由开放地理信息系统协会（OGC）负责制定它的标准。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//gml是矢量数据，需要使用矢量数据源加载，然后使用矢量图层渲染</span></span><br><span class="line">  <span class="keyword">const</span> vector = <span class="keyword">new</span> VectorLayer(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;/GisData/gml/map.gml&#x27;</span>,</span><br><span class="line">      <span class="comment">// 指定数据读取格式</span></span><br><span class="line">      <span class="attr">format</span>: <span class="keyword">new</span> GML(),</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">style</span>: style,</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721887340450.png" alt="QQ_1721887340450.png|829"></p>
<h3 id="GPX"><a href="#GPX" class="headerlink" title="GPX"></a>GPX</h3><blockquote>
<p>GPX（GPS eXchange Format, GPS 交换格式)是一个 XML 格式，为应用软件设计的通用 GPS 数据格式。<br>它可以用来描述路点、轨迹、路程。这个格式是免费的，可以在不需要付任何许可费用的前提下使用。<br>它的标签保存位置，海拔和时间，可以用来在不同的 GPS 设备和软件之间交换数据。<br>如查看轨迹、在照片的 exif 数据中嵌入地理数据。</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721888185514.png" alt="QQ_1721888185514.png|727"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;infoDom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> GPX <span class="keyword">from</span> <span class="string">&#x27;ol/format/GPX&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Fill, Stroke, Style &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> VectorSource <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; FeatureLike &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; Pixel &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/pixel&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> CircleStyle <span class="keyword">from</span> <span class="string">&#x27;ol/style/Circle&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type Feature <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; Geometry &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; StyleLike &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style/Style&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//定义各种要素的样式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> styles = &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">Point</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">image</span>: <span class="keyword">new</span> CircleStyle(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">fill</span>: <span class="keyword">new</span> Fill(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">color</span>: <span class="string">&#x27;rgba(255,255,0,0.4)&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">radius</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">color</span>: <span class="string">&#x27;#ff0&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">LineString</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;#f00&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">MultiLineString</span>: <span class="keyword">new</span> Style(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">color</span>: <span class="string">&#x27;#0f0&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> styleFunction = <span class="function">(<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> type = feature.getGeometry()?.getType();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (type === <span class="string">&#x27;Point&#x27;</span> || type === <span class="string">&#x27;LineString&#x27;</span> || type === <span class="string">&#x27;MultiLineString&#x27;</span>) <span class="keyword">return</span> styles[type];</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// osm地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> OSM(), <span class="comment">//加载OpenStreetMap</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//GPX是矢量数据，需要使用矢量数据源加载，然后使用矢量图层渲染</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> VectorLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">url</span>: <span class="string">&#x27;/GisData/gpx/fells_loop.gpx&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// 指定数据读取格式</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">format</span>: <span class="keyword">new</span> GPX(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">style</span>: styleFunction <span class="keyword">as</span> StyleLike,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//渲染矢量图层</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [-<span class="number">7916041.528716288</span>, <span class="number">5228379.045749711</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">12</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#info</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">z-index</span>: <span class="number">999</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721887456400.png" alt="QQ_1721887456400.png"></p>
<h2 id="Interaction-地图交互"><a href="#Interaction-地图交互" class="headerlink" title="Interaction - 地图交互"></a>Interaction - 地图交互</h2><h3 id="Interaction-抽象基类"><a href="#Interaction-抽象基类" class="headerlink" title="Interaction 抽象基类"></a>Interaction 抽象基类</h3><blockquote>
<p>Abstract base class; normally only used for creating subclasses and not instantiated in apps. User actions that change the state of the map.</p>
</blockquote>
<p><strong>与controls 的区别</strong><br>Some are similar to <code>controls</code>, but are not associated with a DOM element.<br>For example, <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_KeyboardZoom-KeyboardZoom.html"><code>KeyboardZoom</code></a> is functionally the same as <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Zoom-Zoom.html"><code>Zoom</code></a>, but triggered by a keyboard event not a button element event.<br>Although interactions do not have a DOM element, some of them do render vectors and so are visible on the screen.</p>
<h4 id="new-Interaction-options"><a href="#new-Interaction-options" class="headerlink" title="new Interaction(options)"></a>new Interaction(options)</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>handleEvent</code></td>
<td>function</td>
<td>地图调用此方法，通知交互已将浏览器事件分派到地图。如果函数返回假值，则将阻止事件传播到地图交互链中的其他交互（这包括没有明确返回的函数）。交互按地图交互集合的反向顺序遍历</td>
</tr>
</tbody></table>
<h4 id="Fires-9"><a href="#Fires-9" class="headerlink" title="Fires"></a>Fires</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721889373790.png" alt="QQ_1721889373790.png"></p>
<h4 id="Subclasses-6"><a href="#Subclasses-6" class="headerlink" title="Subclasses"></a>Subclasses</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DblClickDragZoom-DblClickDragZoom.html">DblClickDragZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DoubleClickZoom-DoubleClickZoom.html">DoubleClickZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragAndDrop-DragAndDrop.html">DragAndDrop</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_KeyboardPan-KeyboardPan.html">KeyboardPan</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_KeyboardZoom-KeyboardZoom.html">KeyboardZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Link-Link.html">Link</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_MouseWheelZoom-MouseWheelZoom.html">MouseWheelZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Pointer-PointerInteraction.html">PointerInteraction</a><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragBox-DragBox.html">DragBox</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragPan-DragPan.html">DragPan</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragRotateAndZoom-DragRotateAndZoom.html">DragRotateAndZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragRotate-DragRotate.html">DragRotate</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Draw-Draw.html">Draw</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Extent-Extent.html">Extent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Modify-Modify.html">Modify</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_PinchRotate-PinchRotate.html">PinchRotate</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_PinchZoom-PinchZoom.html">PinchZoom</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Snap-Snap.html">Snap</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Translate-Translate.html">Translate</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Select-Select.html">Select</a></li>
</ul>
<h4 id="Extends-12"><a href="#Extends-12" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="BaseEvent-1"><a href="#BaseEvent-1" class="headerlink" title="BaseEvent"></a>BaseEvent</h3><blockquote>
<p>精简了 W3C DOM Level 2 事件接口的实现。请参阅<a target="_blank" rel="noopener" href="https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface">https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface</a>。<br>此实现仅提供<code>type</code>和<code>target</code>属性以及 <code>stopPropagation</code>和<code>preventDefault</code>方法。它旨在作为库中定义的更高级别事件的基类，并与一起使用 <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_events_Target-Target.html"><code>Target</code></a>。</p>
</blockquote>
<h4 id="Subclasses-7"><a href="#Subclasses-7" class="headerlink" title="Subclasses"></a>Subclasses</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection.CollectionEvent.html">CollectionEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Geolocation.GeolocationError.html">GeolocationError</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_MapEvent-MapEvent.html">MapEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_events_SnapEvent.SnapEvent.html">SnapEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragAndDrop.DragAndDropEvent.html">DragAndDropEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragBox.DragBoxEvent.html">DragBoxEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Draw.DrawEvent.html">DrawEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Extent.ExtentEvent.html">ExtentEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Modify.ModifyEvent.html">ModifyEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Select.SelectEvent.html">SelectEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Translate.TranslateEvent.html">TranslateEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Group.GroupEvent.html">GroupEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_render_Event-RenderEvent.html">RenderEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Image.ImageSourceEvent.html">ImageSourceEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Raster.RasterSourceEvent.html">RasterSourceEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Tile.TileSourceEvent.html">TileSourceEvent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Vector.VectorSourceEvent.html">VectorSourceEvent</a></li>
</ul>
<h3 id="defaults-options-gt-Collection-lt-Interaction-gt"><a href="#defaults-options-gt-Collection-lt-Interaction-gt" class="headerlink" title="defaults(options) =&gt; {Collection &lt; Interaction &gt;}"></a>defaults(options) =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a> &lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Interaction-Interaction.html">Interaction</a> &gt;}</h3><blockquote>
<p>这是一个函数，options 为配置项</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; defaults <span class="keyword">as</span> defaultInteractions &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/interaction&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">12</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    ],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">interactions</span>: defaultInteractions(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">altShiftDragRotate</span>: <span class="literal">true</span>, <span class="comment">//是否需要 Alt-Shift-drag 旋转</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">onFocusOnly</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">doubleClickZoom</span>: <span class="literal">true</span>, <span class="comment">//是否需要双击缩放</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">keyboard</span>: <span class="literal">true</span>, <span class="comment">//是否需要键盘交互</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">mouseWheelZoom</span>: <span class="literal">true</span>, <span class="comment">//是否需要鼠标滚轮缩放</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">shiftDragZoom</span>: <span class="literal">true</span>, <span class="comment">//是否需要按住 Shift 键拖动缩放</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">dragPan</span>: <span class="literal">true</span>, <span class="comment">//是否需要拖动平移</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">pinchRotate</span>: <span class="literal">true</span>, <span class="comment">//是否需要捏合旋转</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">pinchZoom</span>: <span class="literal">true</span>, <span class="comment">//是否需要捏合缩放</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoomDelta</span>: <span class="number">2</span>, <span class="comment">//使用键盘或双击缩放时的缩放级别增量</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoomDuration</span>: <span class="number">2000</span>, <span class="comment">//缩放动画的持续时间</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>默认情况下，在地图中包含一组交互。可以通过在构造函数选项中将适当的选项设置为 false来排除特定的交互，但交互的顺序是固定的。如果要为交互指定不同的顺序，则需要创建自己的 module:ol/interaction/interaction 实例，并在创建 module:ol/Map~Map 实例之前，按照所需的顺序将它们插入 module:ol/Collection 中。</p>
<p>默认的交互集依次为：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragRotate-DragRotate.html"><code>DragRotate</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DoubleClickZoom-DoubleClickZoom.html"><code>DoubleClickZoom</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragPan-DragPan.html"><code>DragPan</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_PinchRotate-PinchRotate.html"><code>PinchRotate</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_PinchZoom-PinchZoom.html"><code>PinchZoom</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_KeyboardPan-KeyboardPan.html"><code>KeyboardPan</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_KeyboardZoom-KeyboardZoom.html"><code>KeyboardZoom</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_MouseWheelZoom-MouseWheelZoom.html"><code>MouseWheelZoom</code></a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_DragZoom-DragZoom.html"><code>DragZoom</code></a></li>
</ul>
<h4 id="options"><a href="#options" class="headerlink" title="options"></a>options</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>altShiftDragRotate</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要 Alt-Shift-drag 旋转</td>
</tr>
<tr>
<td><code>onFocusOnly</code></td>
<td>boolean (defaults to false)</td>
<td>I仅当地图具有焦点时才进行交互。这会影响 MouseWheelZoom 和 DragPan 交互，并且当需要为没有浏览器焦点的地图进行页面滚动时非常有用。</td>
</tr>
<tr>
<td><code>doubleClickZoom</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要双击缩放</td>
</tr>
<tr>
<td><code>keyboard</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要键盘交互</td>
</tr>
<tr>
<td><code>mouseWheelZoom</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要鼠标滚轮缩放</td>
</tr>
<tr>
<td><code>shiftDragZoom</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要按住 Shift 键拖动缩放</td>
</tr>
<tr>
<td><code>dragPan</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要拖动平移</td>
</tr>
<tr>
<td><code>pinchRotate</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要捏合旋转</td>
</tr>
<tr>
<td><code>pinchZoom</code></td>
<td>boolean (defaults to true)</td>
<td>是否需要捏合缩放。</td>
</tr>
<tr>
<td><code>zoomDelta</code></td>
<td>number | undefined</td>
<td>使用键盘或双击缩放时的缩放级别增量</td>
</tr>
<tr>
<td><code>zoomDuration</code></td>
<td>number | undefined</td>
<td>缩放动画的持续时间（以毫秒为单位）</td>
</tr>
</tbody></table>
<h3 id="Draw"><a href="#Draw" class="headerlink" title="Draw"></a>Draw</h3><blockquote>
<p>这个需要绑定一个 source，绘制的要素也全在 source 里，可以通过 get 类或 remove 类方法获取和清除</p>
</blockquote>
<h4 id="new-Draw-options"><a href="#new-Draw-options" class="headerlink" title="new Draw(options)"></a>new Draw(options)</h4><p>重点讲几个配置项：</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>type</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_geom_Geometry.html#~Type">Type</a>|</td>
<td>使用此实例绘制的几何图形的几何类型。ol/geom/GeometryType</td>
</tr>
<tr>
<td><code>source</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Vector-VectorSource.html">VectorSource</a> | undefined|</td>
<td>绘制特征的目标源。</td>
</tr>
<tr>
<td><code>features</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a>&lt;<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Feature-Feature.html">Feature</a>&gt; | undefined</td>
<td>绘制要素的目标集合</td>
</tr>
<tr>
<td><code>style</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_style_Style.html#~StyleLike">StyleLike</a> | <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_style_flat.html#~FlatStyleLike">FlatStyleLike</a> | undefined |</td>
<td>草图特征的样式。</td>
</tr>
<tr>
<td><code>geometryFunction</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Draw.html#~GeometryFunction">GeometryFunction</a> | undefined |</td>
<td>自定义绘制图形函数<br>更新几何坐标时调用的函数</td>
</tr>
<tr>
<td><code>geometryName</code></td>
<td>string | undefined</td>
<td>用于绘制交互创建的特征的几何名称</td>
</tr>
<tr>
<td><code>freehand</code></td>
<td>boolean (defaults to false)</td>
<td>是否以手绘模式绘制线、多边形和圆。</td>
</tr>
<tr>
<td><code>wrapX</code></td>
<td>boolean (defaults to false)||</td>
<td>在草图在 x 轴水平方向是否平铺</td>
</tr>
</tbody></table>
<h4 id="Fires-10"><a href="#Fires-10" class="headerlink" title="Fires"></a>Fires</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">draw.on(<span class="string">&#x27;drawstart&#x27;</span>, <span class="function">(<span class="params">event: DragEvent</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;绘制开始&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    draw.on(<span class="string">&#x27;drawabort&#x27;</span>, <span class="function">(<span class="params">event: DragEvent</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;绘制中止&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    draw.on(<span class="string">&#x27;drawend&#x27;</span>, <span class="function">(<span class="params">event: DragEvent</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;绘制结束&#x27;</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="Methods-3"><a href="#Methods-3" class="headerlink" title="Methods"></a>Methods</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 停止绘制并将草图特征添加到目标图层</span></span><br><span class="line">draw.finishDrawing();</span><br><span class="line"><span class="comment">// 停止绘图而不将草图特征添加到目标图层</span></span><br><span class="line">draw.abortDrawing();</span><br></pre></td></tr></table></figure>

<h4 id="Extends-13"><a href="#Extends-13" class="headerlink" title="Extends"></a>Extends</h4><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_interaction_Pointer-PointerInteraction.html">PointerInteraction</a></li>
</ul>
<h4 id="代码实现-7"><a href="#代码实现-7" class="headerlink" title="代码实现"></a>代码实现</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721898538163.png" alt="QQ_1721898538163.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;value&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;drawChange&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">v-for</span>=<span class="string">&quot;item in options&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.value&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item.label&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;item.value&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleFinish&quot;</span>&gt;</span>停止绘图并完成当前绘图<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleClear&quot;</span>&gt;</span>停止绘图并清除当前绘图<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleAllServer&quot;</span>&gt;</span>保存所有草图<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleAllClear&quot;</span>&gt;</span>清除所有草图<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; Feature, Map, View &#125; from &#x27;ol&#x27;;</span><br><span class="line">import Draw, &#123; createBox, createRegularPolygon, type SketchCoordType &#125; from &#x27;ol/interaction/Draw&#x27;;</span><br><span class="line">import &#123; OSM, Vector as VectorSource &#125; from &#x27;ol/source&#x27;;</span><br><span class="line">import &#123; Tile as TileLayer, Vector as VectorLayer &#125; from &#x27;ol/layer&#x27;;</span><br><span class="line">import &#123; Circle as CircleStyle, Fill, Icon, Stroke, Style &#125; from &#x27;ol/style&#x27;;</span><br><span class="line">import type &#123; Geometry &#125; from &#x27;ol/geom&#x27;;</span><br><span class="line">import type &#123; StyleLike &#125; from &#x27;ol/style/Style&#x27;;</span><br><span class="line">import type &#123; Type &#125; from &#x27;ol/geom/Geometry&#x27;;</span><br><span class="line"></span><br><span class="line">interface option &#123;</span><br><span class="line">  value: string;</span><br><span class="line">  label: string;</span><br><span class="line">&#125;</span><br><span class="line">let map: Map;</span><br><span class="line">let draw: Draw;</span><br><span class="line">let drawSource: VectorSource&lt;Feature&lt;Geometry&gt;&gt;;</span><br><span class="line">let drawVectorLayer: VectorLayer&lt;Feature&gt;;</span><br><span class="line"></span><br><span class="line">const options = ref&lt;option[]&gt;([</span><br><span class="line">  &#123;</span><br><span class="line">    value: &#x27;Point&#x27;,</span><br><span class="line">    label: &#x27;点&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    value: &#x27;LineString&#x27;,</span><br><span class="line">    label: &#x27;线&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    value: &#x27;Polygon&#x27;,</span><br><span class="line">    label: &#x27;面&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    value: &#x27;Circle&#x27;,</span><br><span class="line">    label: &#x27;圆&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    value: &#x27;Square&#x27;,</span><br><span class="line">    label: &#x27;正方形&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    value: &#x27;Box&#x27;,</span><br><span class="line">    label: &#x27;长方形&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br><span class="line">const value = ref(&#x27;&#x27;);</span><br><span class="line"></span><br><span class="line">const drawChange = (type: string) =&gt; &#123;</span><br><span class="line">  if (map) &#123;</span><br><span class="line">    // 先移除之前的</span><br><span class="line">    map.removeInteraction(draw);</span><br><span class="line">    const len = map.getAllLayers().length;</span><br><span class="line">    const source = map.getAllLayers()[len - 1].getSource();</span><br><span class="line">    addDraw(type);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const handleFinish = () =&gt; &#123;</span><br><span class="line">  // 停止绘制并将草图特征添加到目标图层</span><br><span class="line">  draw.finishDrawing();</span><br><span class="line">&#125;;</span><br><span class="line">const handleClear = () =&gt; &#123;</span><br><span class="line">  // 停止绘图而不将草图特征添加到目标图层</span><br><span class="line">  draw.abortDrawing();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const handleAllServer = () =&gt; &#123;</span><br><span class="line">  console.log(drawSource.getFeatures());</span><br><span class="line">  // 然后再把这些要素传到后台才行</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const handleAllClear = () =&gt; &#123;</span><br><span class="line">  // Refreshes the source. The source will be cleared, and data from the server will be reloaded.</span><br><span class="line">  // drawSource.refresh();  // 这个是从服务器重新加载</span><br><span class="line">  drawSource.removeFeatures(drawSource.getFeatures());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 添加draw</span><br><span class="line">const addDraw = (type: string) =&gt; &#123;</span><br><span class="line">  if (type != &#x27;None&#x27;) &#123;</span><br><span class="line">    //绘制函数</span><br><span class="line">    let geometryFunction;</span><br><span class="line">    if (type === &#x27;Square&#x27;) &#123;</span><br><span class="line">      type = &#x27;Circle&#x27;; //正方形用圆绘制，分段数4</span><br><span class="line">      geometryFunction = createRegularPolygon(4);</span><br><span class="line">    &#125; else if (type === &#x27;Box&#x27;) &#123;</span><br><span class="line">      type = &#x27;Circle&#x27;; //使用圆的类型创建盒子</span><br><span class="line">      geometryFunction = createBox();</span><br><span class="line">    &#125;</span><br><span class="line">    draw = new Draw(&#123;</span><br><span class="line">      type: type as Type, //绘制的几何图形的几何类型</span><br><span class="line">      clickTolerance: 6, //点击公差</span><br><span class="line">      source: drawSource,</span><br><span class="line">      geometryFunction: geometryFunction,</span><br><span class="line">      wrapX: false, //草图在x水平方向平铺</span><br><span class="line">      freehand: false, //是否开启手绘模式</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    draw.on(&#x27;drawstart&#x27;, (event: DragEvent) =&gt; &#123;</span><br><span class="line">      console.log(&#x27;绘制开始&#x27;);</span><br><span class="line">    &#125;);</span><br><span class="line">    draw.on(&#x27;drawabort&#x27;, (event: DragEvent) =&gt; &#123;</span><br><span class="line">      console.log(&#x27;绘制中止&#x27;);</span><br><span class="line">    &#125;);</span><br><span class="line">    draw.on(&#x27;drawend&#x27;, (event: DragEvent) =&gt; &#123;</span><br><span class="line">      console.log(&#x27;绘制结束&#x27;);</span><br><span class="line">    &#125;);</span><br><span class="line">    map.addInteraction(draw);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 添加画图的矢量图层</span><br><span class="line">const addDrawVectorLayer = () =&gt; &#123;</span><br><span class="line">  //定义各种要素的样式</span><br><span class="line">  const image = new Icon(&#123;</span><br><span class="line">    src: &#x27;/Assets/png/marker.png&#x27;, // 使用png图片代替点</span><br><span class="line">    anchor: [0.75, 0.5],</span><br><span class="line">    rotateWithView: true,</span><br><span class="line">  &#125;);</span><br><span class="line">  const styles = &#123;</span><br><span class="line">    Point: new Style(&#123;</span><br><span class="line">      image: image,</span><br><span class="line">    &#125;),</span><br><span class="line">    LineString: new Style(&#123;</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;green&#x27;,</span><br><span class="line">        width: 1,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">    Polygon: new Style(&#123;</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;blue&#x27;,</span><br><span class="line">        lineDash: [4],</span><br><span class="line">        width: 3,</span><br><span class="line">      &#125;),</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;rgba(0, 0, 255, 0.1)&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">    LinearRing: [],</span><br><span class="line">    MultiPoint: new Style(&#123;</span><br><span class="line">      image: image,</span><br><span class="line">    &#125;),</span><br><span class="line">    MultiLineString: new Style(&#123;</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;green&#x27;,</span><br><span class="line">        width: 1,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">    MultiPolygon: new Style(&#123;</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;yellow&#x27;,</span><br><span class="line">        width: 1,</span><br><span class="line">      &#125;),</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;rgba(255, 255, 0, 0.1)&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line">    GeometryCollection: new Style(&#123;</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;magenta&#x27;,</span><br><span class="line">        width: 2,</span><br><span class="line">      &#125;),</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;magenta&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">      image: new CircleStyle(&#123;</span><br><span class="line">        radius: 10,</span><br><span class="line">        fill: undefined,</span><br><span class="line">        stroke: new Stroke(&#123;</span><br><span class="line">          color: &#x27;magenta&#x27;,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">    Circle: new Style(&#123;</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;red&#x27;,</span><br><span class="line">        width: 2,</span><br><span class="line">      &#125;),</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;rgba(255,0,0,0.2)&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;;</span><br><span class="line">  // 根据要素类型设置几何要素的样式</span><br><span class="line">  const styleFunction = (feature: Feature&lt;Geometry&gt;) =&gt; &#123;</span><br><span class="line">    let type = feature.getGeometry()?.getType();</span><br><span class="line">    if (type) return styles[type];</span><br><span class="line">  &#125;;</span><br><span class="line">  //绘制的数据是一个矢量数据，因此需要矢量数据源和矢量图层承载</span><br><span class="line">  drawSource = new VectorSource(&#123; wrapX: false &#125;);</span><br><span class="line">  drawVectorLayer = new VectorLayer(&#123;</span><br><span class="line">    source: drawSource,</span><br><span class="line">    style: styleFunction as StyleLike,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(drawVectorLayer);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    layers: [</span><br><span class="line">      new TileLayer(&#123;</span><br><span class="line">        source: new OSM(),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    //配置视图</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: [113.24981689453125, 23.126468438108688], //视图中心位置</span><br><span class="line">      projection: &#x27;EPSG:4326&#x27;, //指定投影</span><br><span class="line">      zoom: 12, //缩放到的级别</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  // 添加画图的矢量图层</span><br><span class="line">  addDrawVectorLayer();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  width: 700px;</span><br><span class="line">  top: 1em;</span><br><span class="line">  right: 1em;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h3><h1 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h1><h3 id="读取"><a href="#读取" class="headerlink" title="读取"></a>读取</h3><h4 id="读取-shp-文件"><a href="#读取-shp-文件" class="headerlink" title="读取 shp 文件"></a>读取 shp 文件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i shpjs</span><br><span class="line"><span class="keyword">import</span> shp <span class="keyword">from</span> <span class="string">&#x27;shpjs&#x27;</span>; <span class="comment">// shp 转 geoJson</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 上传 shp(压缩包)  利用 shpjs 转为 geojson</span></span><br><span class="line"><span class="keyword">const</span> handlePreview: UploadProps[<span class="string">&#x27;onPreview&#x27;</span>] = <span class="function">(<span class="params">uploadFile</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> name = uploadFile.name;</span><br><span class="line">  <span class="keyword">const</span> extension = name.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span> (extension != <span class="string">&#x27;zip&#x27;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(extension);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">    <span class="keyword">if</span> (uploadFile.raw) &#123;</span><br><span class="line">      <span class="keyword">const</span> fileData = uploadFile.raw;</span><br><span class="line">      reader.readAsArrayBuffer(fileData);</span><br><span class="line">      reader.onload = <span class="keyword">async</span> (e) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (e.target) &#123;</span><br><span class="line">          <span class="keyword">const</span> shpData = e.target.result;</span><br><span class="line">          <span class="keyword">const</span> geojson = <span class="keyword">await</span> shp(shpData); <span class="comment">// shp 转 geojson</span></span><br><span class="line">          <span class="keyword">const</span> inputShpLayer = <span class="keyword">new</span> VectorLayer(&#123;</span><br><span class="line">            <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span><br><span class="line">              <span class="attr">features</span>: <span class="keyword">new</span> GeoJSON().readFeatures(geojson),</span><br><span class="line">              <span class="attr">format</span>: <span class="keyword">new</span> GeoJSON(),</span><br><span class="line">            &#125;),</span><br><span class="line">          &#125;);</span><br><span class="line">          map.addLayer(inputShpLayer);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="加载底图"><a href="#加载底图" class="headerlink" title="加载底图"></a>加载底图</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载天地图</span></span><br><span class="line"> <span class="keyword">const</span> tileLayer = <span class="keyword">new</span> TileLayer(&#123;</span><br><span class="line">   <span class="attr">visible</span>: <span class="literal">true</span>,</span><br><span class="line">   <span class="attr">source</span>: <span class="keyword">new</span> XYZ(&#123; <span class="attr">url</span>: <span class="string">&#x27; http://wprd0 &#123;1-4&#125;.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;z=&#123;z&#125;&#x27;</span> &#125;),</span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 加载 WMS 服务</span></span><br><span class="line"> <span class="keyword">const</span> imageLayer = <span class="keyword">new</span> ImageLayer(&#123;</span><br><span class="line">   <span class="attr">source</span>: <span class="keyword">new</span> ImageWMS(&#123;</span><br><span class="line">     <span class="attr">url</span>: <span class="string">&#x27; http://localhost:8080/geoserver/postgis/wms &#x27;</span>,</span><br><span class="line">     <span class="attr">params</span>: &#123; <span class="attr">layers</span>: <span class="string">&#x27;postgis:D4DTQYC&#x27;</span> &#125;,</span><br><span class="line">   &#125;),</span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 加载 WFS 服务</span></span><br><span class="line"> <span class="keyword">const</span> FeatureLayer = <span class="keyword">new</span> VectorLayer(&#123;</span><br><span class="line">   <span class="attr">source</span>: <span class="keyword">new</span> VectorSource(&#123;</span><br><span class="line">     <span class="attr">url</span>: <span class="string">&#x27; http://localhost:8080/geoserver/postgis/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=postgis%3AD4DTQYC&amp;maxFeatures=50&amp;outputFormat=application%2Fjson &#x27;</span>,</span><br><span class="line">     <span class="attr">format</span>: <span class="keyword">new</span> GeoJSON(),</span><br><span class="line">   &#125;),</span><br><span class="line">   <span class="attr">style</span>: <span class="keyword">new</span> Style(&#123;</span><br><span class="line">     <span class="attr">stroke</span>: <span class="keyword">new</span> Stroke(&#123;</span><br><span class="line">       <span class="attr">color</span>: <span class="string">&#x27; #0000ff &#x27;</span>,</span><br><span class="line">       <span class="attr">width</span>: <span class="number">2</span>,</span><br><span class="line">     &#125;),</span><br><span class="line">   &#125;),</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><h4 id="拖拽加载-geojson"><a href="#拖拽加载-geojson" class="headerlink" title="拖拽加载 geojson"></a>拖拽加载 geojson</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 拖拽加载 GeoJson</span></span><br><span class="line">  <span class="keyword">const</span> inputSource = <span class="keyword">new</span> VectorSource();</span><br><span class="line">  <span class="keyword">const</span> inputLayer = <span class="keyword">new</span> VectorLayer(&#123;</span><br><span class="line">    <span class="attr">source</span>: inputSource,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(inputLayer);</span><br><span class="line">  map.addInteraction(</span><br><span class="line">    <span class="keyword">new</span> DragAndDrop(&#123;</span><br><span class="line">      <span class="attr">source</span>: inputSource,</span><br><span class="line">      <span class="attr">formatConstructors</span>: [GeoJSON],</span><br><span class="line">    &#125;),</span><br><span class="line">  )</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<p>显示效果</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Scenery</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://vernalscenery.github.io/2024/07/18/openLayer_learn/">https://vernalscenery.github.io/2024/07/18/openLayer_learn/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://VernalScenery.github.io" target="_blank">春和景明的记事本</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/None/">None</a></div><div class="post_share"><div class="social-share" data-image="/./img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/19/geoserver_learn/"><img class="prev-cover" src="/./img/1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">geoserver_learn</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/13/Notion%E5%AD%A6%E4%B9%A0/"><img class="next-cover" src="/./img/1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Notion学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/07/19/geoserver_learn/" title="geoserver_learn"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-19</div><div class="title">geoserver_learn</div></div></a></div><div><a href="/2024/07/20/vue3%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E8%A7%84%E8%8C%83/" title="vue3项目搭建规范"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-20</div><div class="title">vue3项目搭建规范</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Scenery</div><div class="author-info__description">今天不想跑，所以才去跑</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/chjm0121" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1595718686@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#openLayer-learn"><span class="toc-text">openLayer_learn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Observable-%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB-%E5%8F%AF%E8%A7%82%E5%AF%9F%E7%B1%BB"><span class="toc-text">Observable - 抽象基类 - 可观察类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Subclasses"><span class="toc-text">Subclasses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fires-%E4%BA%8B%E4%BB%B6"><span class="toc-text">Fires(事件)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#chang-BaseEvent"><span class="toc-text">chang(BaseEvent)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#error-BaseEvent"><span class="toc-text">error(BaseEvent)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Methods-%E6%96%B9%E6%B3%95"><span class="toc-text">Methods(方法)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#changed"><span class="toc-text">changed()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dispatchEvent-event-gt-boolean-undefined"><span class="toc-text">dispatchEvent(event)&#x3D;&gt; {boolean | undefined}</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getRevision-gt-number"><span class="toc-text">getRevision()&#x3D;&gt;{number}</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#on-type-listener-%E3%80%81once-type-listener-%E3%80%81-un-type-listener"><span class="toc-text">on(type, listener)、once(type, listener)、 un(type, listener)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BaseObject-%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">BaseObject - 抽象基类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Subclasses-1"><span class="toc-text">Subclasses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Extends"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fires-%E4%BA%8B%E4%BB%B6-1"><span class="toc-text">Fires(事件)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#chang-BaseEvent-inherit"><span class="toc-text">chang(BaseEvent)[inherit]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#error-BaseEvent-inherit"><span class="toc-text">error(BaseEvent)[inherit]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#propertychange-ObjectEvent"><span class="toc-text">propertychange(ObjectEvent)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Methods-%E6%96%B9%E6%B3%95-1"><span class="toc-text">Methods(方法)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#changed-inherit"><span class="toc-text">changed() [inherit]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#on-type-listener-%E3%80%81once-type-listener-%E3%80%81-un-type-listener-inherit"><span class="toc-text">on(type, listener)、once(type, listener)、 un(type, listener)[inherit]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getRevision-gt-number-inherit"><span class="toc-text">getRevision()&#x3D;&gt;{number}[inherit]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#get-key"><span class="toc-text">get(key)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getKeys-gt-Array-lt-string-gt"><span class="toc-text">getKeys()&#x3D;&gt; {Array.&lt;string&gt;}</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getProperties-gt-Object-lt-string-gt"><span class="toc-text">getProperties()&#x3D;&gt;{Object.&lt;string, * &gt; }</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set-key-value-silent"><span class="toc-text">set(key, value, silent)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#setProperties-values-silent"><span class="toc-text">setProperties(values, silent)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#unset-key-silent"><span class="toc-text">unset(key, silent)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Collection-JS-%E6%95%B0%E7%BB%84%E7%9A%84%E6%89%A9%E5%B1%95"><span class="toc-text">Collection - JS 数组的扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#new-Collection-array-options"><span class="toc-text">new Collection(array, options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fires"><span class="toc-text">Fires</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Extends-1"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Observable-Properties"><span class="toc-text">Observable Properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Methods"><span class="toc-text">Methods</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Map-%E5%9C%B0%E5%9B%BE"><span class="toc-text">Map - 地图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Extends-2"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#new-Map-options"><span class="toc-text">new Map(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fires-%E4%BA%8B%E4%BB%B6-2"><span class="toc-text">Fires(事件)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BaseEvent"><span class="toc-text">BaseEvent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ObjectEvent"><span class="toc-text">ObjectEvent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MapBrowserEvent"><span class="toc-text">MapBrowserEvent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MapEvent"><span class="toc-text">MapEvent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RenderEvent"><span class="toc-text">RenderEvent</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Observable-Properties-1"><span class="toc-text">Observable Properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Methods-%E6%96%B9%E6%B3%95-2"><span class="toc-text">Methods(方法)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#add"><span class="toc-text">add</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#get"><span class="toc-text">get</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set"><span class="toc-text">set</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#remove"><span class="toc-text">remove</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%83%8F%E7%B4%A0%E4%B8%8E%E5%9D%90%E6%A0%87"><span class="toc-text">像素与坐标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-text">其他</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#View-%E8%A7%86%E5%9B%BE"><span class="toc-text">View - 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#new-View-options"><span class="toc-text">new View(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Extends-3"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Observable-Properties-2"><span class="toc-text">Observable Properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fire"><span class="toc-text">Fire</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Methods-1"><span class="toc-text">Methods</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#adjust"><span class="toc-text">adjust</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#animate-var-args"><span class="toc-text">animate(var_args)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fit-geometryOrExtent-options"><span class="toc-text">fit(geometryOrExtent, options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#get%E3%80%81set"><span class="toc-text">get、set</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96-1"><span class="toc-text">其他</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Control-%E6%8E%A7%E4%BB%B6"><span class="toc-text">Control - 控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Control-%E7%88%B6%E7%B1%BB"><span class="toc-text">Control - 父类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-4"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Subclasses-2"><span class="toc-text">Subclasses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#new-control-option"><span class="toc-text">new control(option)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-1"><span class="toc-text">Fires</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Methods-2"><span class="toc-text">Methods</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zoom-%E5%AF%BC%E8%88%AA%E6%8E%A7%E4%BB%B6"><span class="toc-text">Zoom - 导航控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Zoom"><span class="toc-text">Zoom</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ZoomSlider"><span class="toc-text">ZoomSlider</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ZoomToExtent"><span class="toc-text">ZoomToExtent</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%8E%A7%E4%BB%B6%E5%AE%9E%E7%8E%B0"><span class="toc-text">基础控件实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%B1%82%E9%80%89%E6%8B%A9%E5%AE%9E%E7%8E%B0"><span class="toc-text">图层选择实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MousePosition-%E4%BD%8D%E7%BD%AE%E6%8E%A7%E4%BB%B6"><span class="toc-text">MousePosition - 位置控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-5"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#new-MousePosition-options"><span class="toc-text">new MousePosition(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Observable-Properties-3"><span class="toc-text">Observable Properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-2"><span class="toc-text">Fires</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OverviewMap-%E9%B9%B0%E7%9C%BC%E6%8E%A7%E4%BB%B6"><span class="toc-text">OverviewMap-鹰眼控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-6"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#new-OverviewMap-options"><span class="toc-text">new OverviewMap(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-3"><span class="toc-text">Fires</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FullScreen-%E5%85%A8%E5%B1%8F%E6%8E%A7%E4%BB%B6"><span class="toc-text">FullScreen - 全屏控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-7"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#new-FullScreen-options"><span class="toc-text">new FullScreen(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-4"><span class="toc-text">Fires</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E9%87%8F%E6%8E%A7%E4%BB%B6"><span class="toc-text">测量控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#unByKey-key"><span class="toc-text">unByKey(key)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E6%8E%A7%E4%BB%B6"><span class="toc-text">动画控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ScaleLine-%E6%AF%94%E4%BE%8B%E5%B0%BA%E6%8E%A7%E4%BB%B6"><span class="toc-text">ScaleLine - 比例尺控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-8"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Observable-Properties-4"><span class="toc-text">Observable Properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#new-ScaleLine-options"><span class="toc-text">new ScaleLine(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-5"><span class="toc-text">Fires</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%B1%82%E6%8E%A2%E7%B4%A2"><span class="toc-text">图层探索</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Layer-Source-%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE"><span class="toc-text">Layer + Source - 各种数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BaseLayer-%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">BaseLayer - 抽象基类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#new-BaseLayer-options"><span class="toc-text">new BaseLayer(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-6"><span class="toc-text">Fires</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-9"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Subclasses-3"><span class="toc-text">Subclasses</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Layer-%E5%9B%BE%E5%B1%82%E7%88%B6%E7%B1%BB"><span class="toc-text">Layer - 图层父类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#new-Layer-options"><span class="toc-text">new Layer(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-7"><span class="toc-text">Fires</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Subclasses-4"><span class="toc-text">Subclasses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-10"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Observable-Properties-5"><span class="toc-text">Observable Properties</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Source-%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">Source 抽象基类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#new-Source-options"><span class="toc-text">new Source(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-8"><span class="toc-text">Fires</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Subclasses-5"><span class="toc-text">Subclasses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-11"><span class="toc-text">Extends</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ImageLayer-%E5%BD%B1%E5%83%8F%E6%95%B0%E6%8D%AE"><span class="toc-text">ImageLayer - 影像数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tileLayer-%E7%93%A6%E7%89%87%E5%9C%B0%E5%9B%BE"><span class="toc-text">tileLayer - 瓦片地图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">代码实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VectorLayer-%E7%9F%A2%E9%87%8F%E5%9C%B0%E5%9B%BE"><span class="toc-text">VectorLayer - 矢量地图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1-%EF%BC%9A"><span class="toc-text">方式1 ：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F2%EF%BC%9A"><span class="toc-text">方式2：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VectorTileLayer-%E7%9F%A2%E9%87%8F%E7%93%A6%E7%89%87"><span class="toc-text">VectorTileLayer - 矢量瓦片</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8A%BF"><span class="toc-text">优势</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-text">缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-1"><span class="toc-text">代码实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%93%A6%E7%89%87%E7%BD%91%E6%A0%BC"><span class="toc-text">瓦片网格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%84%E6%B8%A0%E9%81%93%E5%9C%B0%E5%9B%BE"><span class="toc-text">各渠道地图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE"><span class="toc-text">高德地图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A9%E5%9C%B0%E5%9B%BE"><span class="toc-text">天地图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bing-%E5%9C%B0%E5%9B%BE"><span class="toc-text">Bing 地图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ArcGIS"><span class="toc-text">ArcGIS</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSON-%E7%9B%B8%E5%85%B3"><span class="toc-text">JSON 相关</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GeoJSON"><span class="toc-text">GeoJSON</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#new-GeoJSON-options"><span class="toc-text">new GeoJSON(options)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-2"><span class="toc-text">代码实现</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TopoJSON"><span class="toc-text">TopoJSON</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-3"><span class="toc-text">代码实现</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Geojson-%E4%B8%8E-Topojson-%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">Geojson 与 Topojson 之间的转换</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Esrijson"><span class="toc-text">Esrijson</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-4"><span class="toc-text">代码实现</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Geojson-%E4%B8%8E-Esrijson-%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">Geojson 与 Esrijson 之间的转换</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WKT"><span class="toc-text">WKT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-3"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-5"><span class="toc-text">代码实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WKB"><span class="toc-text">WKB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-4"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-6"><span class="toc-text">代码实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XML"><span class="toc-text">XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KML"><span class="toc-text">KML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GML"><span class="toc-text">GML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPX"><span class="toc-text">GPX</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interaction-%E5%9C%B0%E5%9B%BE%E4%BA%A4%E4%BA%92"><span class="toc-text">Interaction - 地图交互</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Interaction-%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">Interaction 抽象基类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#new-Interaction-options"><span class="toc-text">new Interaction(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-9"><span class="toc-text">Fires</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Subclasses-6"><span class="toc-text">Subclasses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-12"><span class="toc-text">Extends</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BaseEvent-1"><span class="toc-text">BaseEvent</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Subclasses-7"><span class="toc-text">Subclasses</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defaults-options-gt-Collection-lt-Interaction-gt"><span class="toc-text">defaults(options) &#x3D;&gt; {Collection &lt; Interaction &gt;}</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#options"><span class="toc-text">options</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Draw"><span class="toc-text">Draw</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#new-Draw-options"><span class="toc-text">new Draw(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fires-10"><span class="toc-text">Fires</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Methods-3"><span class="toc-text">Methods</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Extends-13"><span class="toc-text">Extends</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-7"><span class="toc-text">代码实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Select"><span class="toc-text">Select</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-text">功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96"><span class="toc-text">读取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96-shp-%E6%96%87%E4%BB%B6"><span class="toc-text">读取 shp 文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E5%BA%95%E5%9B%BE"><span class="toc-text">加载底图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C"><span class="toc-text">操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%96%E6%8B%BD%E5%8A%A0%E8%BD%BD-geojson"><span class="toc-text">拖拽加载 geojson</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/25/%E9%9D%9E%E6%9A%B4%E5%8A%9B%E6%B2%9F%E9%80%9A_update/" title="非暴力沟通_update">非暴力沟通_update</a><time datetime="2024-07-24T23:10:29.000Z" title="发表于 2024-07-25 07:10:29">2024-07-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/20/vue3%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E8%A7%84%E8%8C%83/" title="vue3项目搭建规范">vue3项目搭建规范</a><time datetime="2024-07-20T03:54:39.000Z" title="发表于 2024-07-20 11:54:39">2024-07-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/20/Java%20%E8%AF%AD%E6%B3%95/" title="Java 语法">Java 语法</a><time datetime="2024-07-20T01:45:04.000Z" title="发表于 2024-07-20 09:45:04">2024-07-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/20/Linux%20%E5%9F%BA%E7%A1%80%E8%AF%BE/" title="Linux 基础课">Linux 基础课</a><time datetime="2024-07-20T01:28:11.000Z" title="发表于 2024-07-20 09:28:11">2024-07-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/20/SprintBoot%E6%A1%86%E6%9E%B6%E8%AF%BE/" title="SprintBoot框架课">SprintBoot框架课</a><time datetime="2024-07-19T18:15:12.000Z" title="发表于 2024-07-20 02:15:12">2024-07-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./img/1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Scenery</div><div class="footer_custom_text"><div>波澜不惊</div><div class="footer-div"><img class="footer-icon" src="./img/备案图标.png"><a class="footer-a" target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">皖ICP备2021016944号-1</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>
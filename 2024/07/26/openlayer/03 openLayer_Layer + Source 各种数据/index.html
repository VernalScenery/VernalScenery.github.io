<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>03 openLayer_Layer + Source 各种数据 | 春和景明的记事本</title><meta name="author" content="Scenery"><meta name="copyright" content="Scenery"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1 概述 Openlayers 将地图渲染分为图层（layer）与数据源（source）分离，图层是渲染地图数的地图容器，而数据源则作为 GIS 数据的载体，图层要与数据源匹配设置  2 BaseLayer - 抽象基类 抽象基类；通常仅用于创建子类，而不是在应用中实例化。请注意，对于 BaseLa"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://vernalscenery.github.io/2024/07/26/openlayer/03%20openLayer_Layer%20+%20Source%20%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '03 openLayer_Layer + Source 各种数据',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-26 21:43:54'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">70</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/1.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="春和景明的记事本"><span class="site-name">春和景明的记事本</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">03 openLayer_Layer + Source 各种数据</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-26T01:32:27.000Z" title="发表于 2024-07-26 09:32:27">2024-07-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-26T13:43:54.840Z" title="更新于 2024-07-26 21:43:54">2024-07-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>50分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="03 openLayer_Layer + Source 各种数据"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1 概述"></a>1 概述</h2><blockquote>
<p>Openlayers 将地图渲染分为图层（layer）与数据源（source）分离，图层是渲染地图数的地图容器，而数据源则作为 GIS 数据的载体，图层要与数据源匹配设置</p>
</blockquote>
<h2 id="2-BaseLayer-抽象基类"><a href="#2-BaseLayer-抽象基类" class="headerlink" title="2 BaseLayer - 抽象基类"></a>2 BaseLayer - 抽象基类</h2><blockquote>
<p>抽象基类；通常仅用于创建子类，而不是在应用中实例化。请注意，对于 <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html"><code>BaseLayer</code></a> 其所有子类，在选项中设置的任何属性均设置为 <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html"><code>BaseObject</code></a> 层对象上的属性，因此是可观察的，并且具有 get/set 访问器。</p>
</blockquote>
<p><code>import BaseLayer from &#39;ol/layer/Base.js&#39;;</code></p>
<h3 id="2-1-new-BaseLayer-options"><a href="#2-1-new-BaseLayer-options" class="headerlink" title="2.1 new BaseLayer(options)"></a>2.1 new BaseLayer(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-layer’)</td>
<td>A CSS class name to set to the layer element.</td>
</tr>
<tr>
<td><code>opacity</code></td>
<td>number (defaults to 1)</td>
<td>Opacity (0, 1).</td>
</tr>
<tr>
<td><code>visible</code></td>
<td>boolean (defaults to true)</td>
<td>Visibility.</td>
</tr>
<tr>
<td><code>extent</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a> | undefined</td>
<td>The bounding extent for layer rendering. The layer will not be rendered outside of this extent.</td>
</tr>
<tr>
<td><code>zIndex</code></td>
<td>number | undefined</td>
<td>The z-index for layer rendering. At rendering time, the layers will be ordered, first by Z-index and then by position. When <code>undefined</code>, a <code>zIndex</code> of 0 is assumed for layers that are added to the map’s <code>layers</code> collection, or <code>Infinity</code> when the layer’s <code>setMap()</code> method was used.</td>
</tr>
<tr>
<td><code>minResolution</code></td>
<td>number | undefined</td>
<td>The minimum resolution (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxResolution</code></td>
<td>number | undefined</td>
<td>The maximum resolution (exclusive) below which this layer will be visible.</td>
</tr>
<tr>
<td><code>minZoom</code></td>
<td>number | undefined</td>
<td>The minimum view zoom level (exclusive) above which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxZoom</code></td>
<td>number | undefined</td>
<td>The maximum view zoom level (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>background</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base.html#~BackgroundColor">BackgroundColor</a> | undefined</td>
<td>Background color for the layer. If not specified, no background will be rendered.</td>
</tr>
<tr>
<td><code>properties</code></td>
<td>Object.&lt;string, *&gt; | undefined</td>
<td>Arbitrary observable properties. Can be accessed with <code>#get()</code> and <code>#set()</code>.</td>
</tr>
</tbody></table>
<p><strong>特别注意</strong><br><code>extent</code> : 图层渲染的边界范围。图层不会在此范围之外渲染<br><code>zIndex</code> : 图层渲染的级别，跟 css 样式的 dom 渲染级别是一样的，层级越大就显示在上一层<br><code>properties</code> : 任意可观察的属性。可以通过 <code>#get()</code>和访问<code>#set()</code>。<br><code>visible</code>: 图层的可见性，不可见图层不再请求数据</p>
<h3 id="2-2-Fires"><a href="#2-2-Fires" class="headerlink" title="2.2 Fires"></a>2.2 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721788337157.png" alt="QQ_1721788337157.png"></p>
<h3 id="2-3-Extends"><a href="#2-3-Extends" class="headerlink" title="2.3 Extends"></a>2.3 Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="2-4-Subclasses"><a href="#2-4-Subclasses" class="headerlink" title="2.4 Subclasses"></a>2.4 Subclasses</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Group-LayerGroup.html">LayerGroup</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html">Layer</a></li>
</ul>
<h2 id="3-Layer-图层父类"><a href="#3-Layer-图层父类" class="headerlink" title="3 Layer - 图层父类"></a>3 Layer - 图层父类</h2><blockquote>
<p>所有图层类型均由其派生的基类。</p>
</blockquote>
<h3 id="3-1-new-Layer-options"><a href="#3-1-new-Layer-options" class="headerlink" title="3.1 new Layer(options)"></a>3.1 new Layer(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-layer’)</td>
<td>A CSS class name to set to the layer element.</td>
</tr>
<tr>
<td><code>opacity</code></td>
<td>number (defaults to 1)</td>
<td>Opacity (0, 1).</td>
</tr>
<tr>
<td><code>visible</code></td>
<td>boolean (defaults to true)</td>
<td>Visibility.</td>
</tr>
<tr>
<td><code>extent</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a> | undefined</td>
<td>The bounding extent for layer rendering. The layer will not be rendered outside of this extent.</td>
</tr>
<tr>
<td><code>zIndex</code></td>
<td>number | undefined</td>
<td>The z-index for layer rendering. At rendering time, the layers will be ordered, first by Z-index and then by position. When <code>undefined</code>, a <code>zIndex</code> of 0 is assumed for layers that are added to the map’s <code>layers</code> collection, or <code>Infinity</code> when the layer’s <code>setMap()</code> method was used.</td>
</tr>
<tr>
<td><code>minResolution</code></td>
<td>number | undefined</td>
<td>The minimum resolution (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxResolution</code></td>
<td>number | undefined</td>
<td>The maximum resolution (exclusive) below which this layer will be visible.</td>
</tr>
<tr>
<td><code>minZoom</code></td>
<td>number | undefined</td>
<td>The minimum view zoom level (exclusive) above which this layer will be visible.</td>
</tr>
<tr>
<td><code>maxZoom</code></td>
<td>number | undefined</td>
<td>The maximum view zoom level (inclusive) at which this layer will be visible.</td>
</tr>
<tr>
<td><code>source</code></td>
<td>SourceType | undefined</td>
<td>Source for this layer. If not provided to the constructor, the source can be set by calling <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html#setSource"><code>layer.setSource(source)</code></a> after construction.</td>
</tr>
<tr>
<td><code>map</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html">Map</a> | null | undefined</td>
<td>Map.</td>
</tr>
<tr>
<td><code>render</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer.html#~RenderFunction">RenderFunction</a> | undefined</td>
<td>Render function. Takes the frame state as input and is expected to return an HTML element. Will overwrite the default rendering for the layer.</td>
</tr>
<tr>
<td><code>properties</code></td>
<td>Object.&lt;string, *&gt; | undefined</td>
<td>Arbitrary observable properties. Can be accessed with <code>#get()</code> and <code>#set()</code>.</td>
</tr>
</tbody></table>
<h3 id="3-2-Fires"><a href="#3-2-Fires" class="headerlink" title="3.2 Fires"></a>3.2 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724140128.png" alt="image.png"></p>
<p><strong>注意几个事件：</strong></p>
<ul>
<li>A generic <code>change</code> event is fired when <strong>the state of the source changes.</strong> </li>
<li>A <code>sourceready</code> event is fired when <strong>the layer’s source is ready.</strong></li>
<li><code>prerender</code> Triggered <strong>before a layer is rendered.</strong></li>
<li><code>postrender</code> Triggered <strong>after a layer is rendered.。</strong></li>
</ul>
<p><strong>所有图层都有上面这几个事件</strong></p>
<h3 id="3-3-Subclasses"><a href="#3-3-Subclasses" class="headerlink" title="3.3 Subclasses"></a>3.3 Subclasses</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_BaseImage-BaseImageLayer.html">BaseImageLayer</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_BaseTile-BaseTileLayer.html">BaseTileLayer</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_BaseVector-BaseVectorLayer.html">BaseVectorLayer</a></li>
</ul>
<h3 id="3-4-Extends"><a href="#3-4-Extends" class="headerlink" title="3.4 Extends"></a>3.4 Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a></li>
</ul>
<h3 id="3-5-Observable-Properties"><a href="#3-5-Observable-Properties" class="headerlink" title="3.5 Observable Properties"></a>3.5 Observable Properties</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Settable</th>
<th><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a> type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>extent</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_extent.html#~Extent">Extent</a> | undefined</td>
<td>yes</td>
<td><code>change:extent</code></td>
<td>The layer extent.</td>
</tr>
<tr>
<td><code>maxResolution</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:maxresolution</code></td>
<td>The maximum resolution of the layer.</td>
</tr>
<tr>
<td><code>maxZoom</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:maxzoom</code></td>
<td>The maximum zoom level of the layer.</td>
</tr>
<tr>
<td><code>minResolution</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:minresolution</code></td>
<td>The minimum resolution of the layer.</td>
</tr>
<tr>
<td><code>minZoom</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:minzoom</code></td>
<td>The minimum zoom level of the layer.</td>
</tr>
<tr>
<td><code>opacity</code></td>
<td>number</td>
<td>yes</td>
<td><code>change:opacity</code></td>
<td>The opacity of the layer.</td>
</tr>
<tr>
<td><code>source</code></td>
<td>SourceType | null</td>
<td>yes</td>
<td><code>change:source</code></td>
<td>The layer source (or <code>null</code> if not yet set).</td>
</tr>
<tr>
<td><code>visible</code></td>
<td>boolean</td>
<td>yes</td>
<td><code>change:visible</code></td>
<td>The value of the <code>visible</code> property of the layer.</td>
</tr>
<tr>
<td><code>zIndex</code></td>
<td>number | undefined</td>
<td>yes</td>
<td><code>change:zindex</code></td>
<td>The Z-index of the layer.</td>
</tr>
</tbody></table>
<h2 id="4-Source-抽象基类"><a href="#4-Source-抽象基类" class="headerlink" title="4 Source 抽象基类"></a>4 Source 抽象基类</h2><blockquote>
<p>Abstract base class; normally only used for creating subclasses and not instantiated in apps. Base class for <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Layer-Layer.html"><code>Layer</code></a> sources.<br>A generic <code>change</code> event is triggered when the state of the source changes.</p>
</blockquote>
<h3 id="4-1-new-Source-options"><a href="#4-1-new-Source-options" class="headerlink" title="4.1 new Source(options)"></a>4.1 new Source(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>attributions</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Source.html#~AttributionLike">AttributionLike</a> | undefined</td>
<td>Attributions.</td>
</tr>
<tr>
<td><code>attributionsCollapsible</code></td>
<td>boolean (defaults to true)</td>
<td>Attributions are collapsible.</td>
</tr>
<tr>
<td><code>projection</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_proj.html#~ProjectionLike">ProjectionLike</a> | undefined</td>
<td>Projection. Default is the view projection.</td>
</tr>
<tr>
<td><code>state</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Source.html#~State">State</a> (defaults to ‘ready’)</td>
<td>State.</td>
</tr>
<tr>
<td><code>wrapX</code></td>
<td>boolean (defaults to false)</td>
<td>WrapX.</td>
</tr>
<tr>
<td><code>interpolate</code></td>
<td>boolean (defaults to false)</td>
<td>Use interpolated values when resampling. By default, the nearest neighbor is used when resampling.</td>
</tr>
</tbody></table>
<h3 id="4-2-Fires"><a href="#4-2-Fires" class="headerlink" title="4.2 Fires"></a>4.2 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721888439132.png" alt="QQ_1721888439132.png"></p>
<h3 id="4-3-Subclasses"><a href="#4-3-Subclasses" class="headerlink" title="4.3 Subclasses"></a>4.3 Subclasses</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Image-ImageSource.html">ImageSource</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Tile-TileSource.html">TileSource</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_source_Vector-VectorSource.html">VectorSource</a></li>
</ul>
<h3 id="4-4-Extends"><a href="#4-4-Extends" class="headerlink" title="4.4 Extends"></a>4.4 Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h2 id="5-ImageLayer-影像数据"><a href="#5-ImageLayer-影像数据" class="headerlink" title="5 ImageLayer - 影像数据"></a>5 ImageLayer - 影像数据</h2><p>使用 layer.image+source.image 方式加载，从浏览器加载情况看，影像就是一张 image</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721802838212.png" alt="QQ_1721802838212.png|711"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 影像数据</span></span><br><span class="line"><span class="keyword">const</span> imageLayer = <span class="keyword">new</span> <span class="title class_">ImageLayer</span>(&#123;</span><br><span class="line">  <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">ImageArcGISRest</span>(&#123;</span><br><span class="line">    <span class="attr">ratio</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://sampleserver6.arcgisonline.com/ArcGIS/rest/services/&#x27;</span> + <span class="string">&#x27;USA/MapServer&#x27;</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">opacity</span>: <span class="number">0.5</span>, <span class="comment">//透明度</span></span><br><span class="line">  <span class="attr">visible</span>: <span class="literal">true</span>, <span class="comment">//图层的可见性，不可见图层不再请求数据</span></span><br><span class="line">  <span class="attr">extent</span>: [-<span class="number">18372064.265054375</span>, <span class="number">642477.8989716391</span>, -<span class="number">3622231.734945626</span>, <span class="number">8495720.10102836</span>], <span class="comment">//图层渲染范围,该层将不会在此范围之外渲染。</span></span><br><span class="line">  <span class="attr">zIndex</span>: <span class="number">1</span>, <span class="comment">//图层渲染的级别，跟css样式的dom渲染级别是一样的，层级越大就显示在上一层</span></span><br><span class="line">  <span class="attr">properties</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;ArcGISRest&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//图层渲染之前触发</span></span><br><span class="line">  imageLayer.<span class="title function_">on</span>(<span class="string">&#x27;prerender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//在图层渲染完成之后触发</span></span><br><span class="line">  imageLayer.<span class="title function_">on</span>(<span class="string">&#x27;postrender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="6-tileLayer-瓦片地图"><a href="#6-tileLayer-瓦片地图" class="headerlink" title="6 tileLayer - 瓦片地图"></a>6 tileLayer - 瓦片地图</h2><p>使用 layer.tile+source.tile 加载.。从浏览器加载可以看出，滚动鼠标浏览器在不断请求，由此可见矢量瓦片由很多个大小相同的图片组成，一般图片大小是 512*512 或 256*256</p>
<h3 id="6-1-优点"><a href="#6-1-优点" class="headerlink" title="6.1 优点"></a>6.1 优点</h3><p>瓦片地图的工作原理如下：</p>
<p><strong>切割地图</strong>： 地图数据被分成许多小块，每个小块都被称为一个瓦片。瓦片通常是正方形，具有固定的尺寸，例如256x256像素。</p>
<p><strong>动态加载</strong>： 当用户在地图上进行平移或缩放操作时，OpenLayers 会动态加载新的瓦片。这些瓦片是根据用户当前视图的位置和缩放级别动态生成的。</p>
<p><strong>缓存</strong>： 为了提高性能，OpenLayers 通常会在用户浏览地图时缓存已经加载的瓦片。这样，当用户再次浏览同一区域时，OpenLayers 可以直接使用缓存中的瓦片，而不需要重新下载。</p>
<h3 id="6-2-代码实现"><a href="#6-2-代码实现" class="headerlink" title="6.2 代码实现"></a>6.2 代码实现</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721803179122.png" alt="QQ_1721803179122.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tileLayer = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title function_">OSM</span>(),</span><br><span class="line">    <span class="attr">zIndex</span>: <span class="number">0</span>, <span class="comment">//图层渲染级别</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//图层渲染之前触发</span></span><br><span class="line">  tileLayer.<span class="title function_">on</span>(<span class="string">&#x27;prerender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//在图层渲染完成之后触发</span></span><br><span class="line">  tileLayer.<span class="title function_">on</span>(<span class="string">&#x27;postrender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="7-VectorLayer-矢量地图"><a href="#7-VectorLayer-矢量地图" class="headerlink" title="7 VectorLayer - 矢量地图"></a>7 VectorLayer - 矢量地图</h2><p>一般使用 layer.vector+source.vector 方式加载。</p>
<p>矢量数据源一般有两种设置方式：</p>
<ul>
<li>一种是 features 方法，静态加载矢量地图(如 <strong>geojson</strong>)，或者调用 addFeatrue()，addFeatrues()方法动态加载矢量地图；</li>
<li>另外一种是 url+format 方法，即设置矢量地图的 url 地址与数据格式 format 来加载矢量地图</li>
</ul>
<h3 id="7-1-方式1-："><a href="#7-1-方式1-：" class="headerlink" title="7.1 方式1 ："></a>7.1 方式1 ：</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721807569332.png" alt="QQ_1721807569332.png|695"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加静态矢量数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addStaticVector</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 静态矢量数据</span></span><br><span class="line">  <span class="keyword">let</span> geojson = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;FeatureCollection&#x27;</span>,</span><br><span class="line">    <span class="attr">features</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">geometry</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;Point&#x27;</span>,</span><br><span class="line">          <span class="attr">coordinates</span>: [<span class="number">87.16552734375</span>, <span class="number">39.470125122358176</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">geometry</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;LineString&#x27;</span>,</span><br><span class="line">          <span class="attr">coordinates</span>: [</span><br><span class="line">            [<span class="number">79.16748046874999</span>, <span class="number">37.61423141542417</span>],</span><br><span class="line">            [<span class="number">81.27685546875</span>, <span class="number">42.00032514831621</span>],</span><br><span class="line">            [<span class="number">84.111328125</span>, <span class="number">41.52502957323801</span>],</span><br><span class="line">            [<span class="number">84.66064453125</span>, <span class="number">43.229195113965005</span>],</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;Feature&#x27;</span>,</span><br><span class="line">        <span class="attr">properties</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">geometry</span>: &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;Polygon&#x27;</span>,</span><br><span class="line">          <span class="attr">coordinates</span>: [</span><br><span class="line">            [</span><br><span class="line">              [<span class="number">81.71630859375</span>, <span class="number">40.49709237269567</span>],</span><br><span class="line">              [<span class="number">82.0458984375</span>, <span class="number">37.21283151445594</span>],</span><br><span class="line">              [<span class="number">86.220703125</span>, <span class="number">36.59788913307022</span>],</span><br><span class="line">              [<span class="number">86.06689453125</span>, <span class="number">41.04621681452063</span>],</span><br><span class="line">              [<span class="number">81.71630859375</span>, <span class="number">40.49709237269567</span>],</span><br><span class="line">            ],</span><br><span class="line">          ],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 矢量几何要素的样式</span></span><br><span class="line">  <span class="keyword">let</span> image = <span class="keyword">new</span> <span class="title class_">Circle</span>(&#123;</span><br><span class="line">    <span class="attr">radius</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="attr">fill</span>: <span class="literal">undefined</span>,</span><br><span class="line">    <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123; <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>, <span class="attr">width</span>: <span class="number">1</span> &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> styles = &#123;</span><br><span class="line">    <span class="title class_">Point</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="comment">//点样式</span></span><br><span class="line">        <span class="attr">image</span>: image,</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="title class_">LineString</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">          <span class="comment">//线的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="title class_">Polygon</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">          <span class="comment">//区的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>,</span><br><span class="line">          <span class="attr">lineDash</span>: [<span class="number">4</span>],</span><br><span class="line">          <span class="attr">width</span>: <span class="number">3</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span><br><span class="line">          <span class="comment">//区的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;rgba(0, 0, 255, 0.1)&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="title class_">LinearRing</span>: [],</span><br><span class="line">    <span class="title class_">MultiLineString</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">          <span class="comment">//多线的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="title class_">MultiPoint</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="comment">//多点的点样式</span></span><br><span class="line">        <span class="attr">image</span>: image,</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="title class_">MultiPolygon</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">          <span class="comment">//多区的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;yellow&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span><br><span class="line">          <span class="comment">//多区的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 0, 0.1)&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="title class_">GeometryCollection</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">          <span class="comment">//集合要素的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">2</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span><br><span class="line">          <span class="comment">//集合要素的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">image</span>: <span class="keyword">new</span> <span class="title class_">Circle</span>(&#123;</span><br><span class="line">          <span class="comment">//集合要素的点样式</span></span><br><span class="line">          <span class="attr">radius</span>: <span class="number">10</span>,</span><br><span class="line">          <span class="attr">fill</span>: <span class="literal">undefined</span>,</span><br><span class="line">          <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span><br><span class="line">          &#125;),</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="title class_">Circle</span>: [</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">          <span class="comment">//圆的边界样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">          <span class="attr">width</span>: <span class="number">2</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span><br><span class="line">          <span class="comment">//圆的填充样式</span></span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.2)&#x27;</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">styleFunction</span> = (<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> type = feature.<span class="title function_">getGeometry</span>()?.<span class="title function_">getType</span>();</span><br><span class="line">    <span class="keyword">if</span> (type) <span class="keyword">return</span> styles[type];</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置地图投影</span></span><br><span class="line">  <span class="keyword">let</span> projection = <span class="keyword">new</span> <span class="title class_">Projection</span>(&#123;</span><br><span class="line">    <span class="attr">code</span>: <span class="string">&#x27;EPSG:3857&#x27;</span>, <span class="comment">//投影编码</span></span><br><span class="line">    <span class="attr">units</span>: <span class="string">&#x27;degrees&#x27;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> geo = <span class="keyword">new</span> <span class="title class_">GeoJSON</span>(); <span class="comment">// 定义geojson的数据格式</span></span><br><span class="line">  <span class="comment">//读取要素数据</span></span><br><span class="line">  <span class="keyword">let</span> featrue = geo.<span class="title function_">readFeatures</span>(geojson, &#123;</span><br><span class="line">    <span class="attr">featureProjection</span>: projection,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 给数据源添加要素</span></span><br><span class="line">  <span class="keyword">const</span> vectorSource = <span class="keyword">new</span> <span class="title class_">VectorSource</span>();</span><br><span class="line">  vectorSource.<span class="title function_">addFeatures</span>(featrue);</span><br><span class="line">  <span class="comment">// 构建矢量图层</span></span><br><span class="line">  <span class="keyword">const</span> vectorLayer = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span><br><span class="line">    <span class="attr">source</span>: vectorSource, <span class="comment">// 定义geojson的数据格式</span></span><br><span class="line">    <span class="attr">style</span>: styleFunction <span class="keyword">as</span> <span class="title class_">StyleLike</span>, <span class="comment">// 样式设置</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.<span class="title function_">addLayer</span>(vectorLayer);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-方式2："><a href="#7-2-方式2：" class="headerlink" title="7.2 方式2："></a>7.2 方式2：</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724170412.png" alt="image.png|714"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="comment">// 添加矢量图层 并选择要素时高亮</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addVectorLayer</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 要素样式</span></span><br><span class="line">  <span class="keyword">const</span> style = <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">    <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 255, 0.6)&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&#x27;#319FD3&#x27;</span>,</span><br><span class="line">      <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">text</span>: <span class="keyword">new</span> <span class="title class_">Text</span>(),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vectorLayer = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3Aprovincial_boundaries&amp;maxFeatures=50&amp;outputFormat=application%2Fjson&#x27;</span>,</span><br><span class="line">      <span class="attr">format</span>: <span class="keyword">new</span> <span class="title class_">GeoJSON</span>(), <span class="comment">//指定数据读取格式</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">style</span>: <span class="function">(<span class="params">feature</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//指定样式函数</span></span><br><span class="line">      style?.<span class="title function_">getText</span>()?.<span class="title function_">setText</span>(feature.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>));</span><br><span class="line">      <span class="keyword">return</span> style;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.<span class="title function_">addLayer</span>(vectorLayer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置矢量图层的高亮</span></span><br><span class="line">  <span class="keyword">const</span> featureOverlay = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(),</span><br><span class="line">    <span class="attr">map</span>: map,</span><br><span class="line">    <span class="attr">style</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span><br><span class="line">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#f00&#x27;</span>,</span><br><span class="line">        <span class="attr">width</span>: <span class="number">1</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.1)&#x27;</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">highlight</span>: <span class="title class_">Feature</span>&lt;<span class="title class_">Geometry</span>&gt; | <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 由像素值获取点击要素 并显示要素信息</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">displayFeatureInfo</span> = <span class="keyword">async</span> (<span class="params">pixel: Pixel</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> layer = map.<span class="title function_">getLayers</span>().<span class="title function_">item</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (layer <span class="keyword">instanceof</span> <span class="title class_">VectorLayer</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> features = <span class="keyword">await</span> layer.<span class="title function_">getFeatures</span>(pixel);</span><br><span class="line">      <span class="keyword">let</span> feature = features.<span class="property">length</span> &gt; <span class="number">0</span> ? features[<span class="number">0</span>] : <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">if</span> (feature) &#123;</span><br><span class="line">        <span class="comment">//获取到的要素的名称渲染到，屏幕左上角</span></span><br><span class="line">        info.<span class="property">value</span>!.<span class="property">innerHTML</span> = feature.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>); <span class="comment">// !为not null的断言操作符</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        info.<span class="property">value</span>!.<span class="property">innerHTML</span> = <span class="string">&#x27;&amp;nbsp;&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//没有高亮的要素就要恢复之前的效果</span></span><br><span class="line">      <span class="keyword">if</span> (feature !== highlight) &#123;</span><br><span class="line">        <span class="keyword">if</span> (highlight) &#123;</span><br><span class="line">          featureOverlay?.<span class="title function_">getSource</span>()?.<span class="title function_">removeFeature</span>(highlight);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (feature) &#123;</span><br><span class="line">          featureOverlay?.<span class="title function_">getSource</span>()?.<span class="title function_">addFeature</span>(feature <span class="keyword">as</span> <span class="title class_">Feature</span>&lt;<span class="title class_">Geometry</span>&gt;);</span><br><span class="line">        &#125;</span><br><span class="line">        highlight = feature <span class="keyword">as</span> <span class="title class_">Feature</span>&lt;<span class="title class_">Geometry</span>&gt;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//地图鼠标移动事件</span></span><br><span class="line">  map.<span class="title function_">on</span>(<span class="string">&#x27;pointermove&#x27;</span>, <span class="function">(<span class="params">evt</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//没有拖拽地图触发，将鼠标事件的像素值传入</span></span><br><span class="line">    <span class="keyword">if</span> (!evt.<span class="property">dragging</span>) &#123;</span><br><span class="line">      <span class="title function_">displayFeatureInfo</span>(evt.<span class="property">pixel</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//地图点击触发函数，将鼠标事件的像素值传入</span></span><br><span class="line">  map.<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">evt</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">displayFeatureInfo</span>(evt.<span class="property">pixel</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="8-VectorTileLayer-矢量瓦片"><a href="#8-VectorTileLayer-矢量瓦片" class="headerlink" title="8 VectorTileLayer - 矢量瓦片"></a>8 VectorTileLayer - 矢量瓦片</h2><blockquote>
<p>Mapbox 由于配合其矢量瓦片 PBF 格式（“Protocolbuffer 二进制格式”）文件，有突出的渲染性能，被很多公司和开发者所使用。矢量瓦片的格式有很多种，其中 PBF 格式是一种二进制文件，直接把数据信息压缩位二进制了。</p>
</blockquote>
<h3 id="8-1-优势"><a href="#8-1-优势" class="headerlink" title="8.1 优势"></a>8.1 优势</h3><ul>
<li>数据传输量小，相对与栅格瓦片数据量大大缩小，PBF 主要用于替代 XML 格式。 与 gzip 压缩的相比，写入速度也要快 5 倍，而且读取速度要比 gzip 压缩的要快 6 倍。</li>
<li>不受分辨率影响，矢量瓦片无论在地图放大到各种级别都是清晰的，都不会出现栅格放大后显示像元的问题。</li>
<li>动态样式，矢量瓦片会根据用户的定制的样式动态绘制，也可以动态改变</li>
<li>支持前端查询，由于使用的是矢量瓦片，可以在前端直接进行信息查询</li>
</ul>
<h3 id="8-2-缺点"><a href="#8-2-缺点" class="headerlink" title="8.2 缺点"></a>8.2 缺点</h3><ul>
<li>坐标和属性信息是可以被用户解析的，也就是安全性的问题</li>
</ul>
<h3 id="8-3-代码实现"><a href="#8-3-代码实现" class="headerlink" title="8.3 代码实现"></a>8.3 代码实现</h3><p>使用 layer.VectorTileLayer + source.VectorTile 实现，其中 format 为 new MVT()</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721814840545.png" alt="QQ_1721814840545.png|857"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import &#123; Zoom, ZoomSlider, ZoomToExtent &#125; from &#x27;ol/control&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import OSM from &#x27;ol/source/OSM.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; defaults as defaultControls &#125; from &#x27;ol/control.js&#x27;;</span><br><span class="line">import type MapEvent from &#x27;ol/MapEvent&#x27;;</span><br><span class="line">import VectorTileLayer from &#x27;ol/layer/VectorTile&#x27;;</span><br><span class="line">import VectorTile from &#x27;ol/source/VectorTile.js&#x27;;</span><br><span class="line">import MVT from &#x27;ol/format/MVT.js&#x27;;</span><br><span class="line">import type MapBrowserEvent from &#x27;ol/MapBrowserEvent&#x27;;</span><br><span class="line">let map: Map;</span><br><span class="line">const info = ref&lt;HTMLElement | null&gt;(null);</span><br><span class="line"></span><br><span class="line">// 添加矢量瓦片类型图层 并为map设置pointermove事件</span><br><span class="line">const addVectorTileLayer = () =&gt; &#123;</span><br><span class="line">  const vectorTileLayer = new VectorTileLayer(&#123;</span><br><span class="line">    source: new VectorTile(&#123;</span><br><span class="line">      format: new MVT(), //设置矢量瓦片类型资源</span><br><span class="line">      url: &#x27;https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/&#x27; + &#x27;ne:ne_10m_admin_0_countries@EPSG%3A900913@pbf/&#123;z&#125;/&#123;x&#125;/&#123;-y&#125;.pbf&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(vectorTileLayer);</span><br><span class="line"></span><br><span class="line">  // 为map设置pointermove事件</span><br><span class="line">  map.on(&#x27;pointermove&#x27;, (event: MapBrowserEvent&lt;any&gt;) =&gt; &#123;</span><br><span class="line">    // 获取到鼠标当前像素所获取到的要素</span><br><span class="line">    const features = map.getFeaturesAtPixel(event.pixel);</span><br><span class="line">    if (features.length == 0) &#123;</span><br><span class="line">      if (info.value) &#123;</span><br><span class="line">        info.value!.innerText = &#x27;&#x27;;</span><br><span class="line">        info.value.style!.opacity = &#x27;0&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(features);</span><br><span class="line">    const properties = features[0].getProperties();</span><br><span class="line">    console.log(properties);</span><br><span class="line">    if (info.value) &#123;</span><br><span class="line">      info.value.innerText = JSON.stringify(properties, null, 2);</span><br><span class="line">      info.value.style!.opacity = &#x27;1&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: [0, 0],</span><br><span class="line">      zoom: 2,</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [],</span><br><span class="line">  &#125;);</span><br><span class="line">  addVectorTileLayer();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line">#info &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 10px;</span><br><span class="line">  right: 50px;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="9-瓦片网格"><a href="#9-瓦片网格" class="headerlink" title="9 瓦片网格"></a>9 瓦片网格</h2><blockquote>
<p>就是带有格网的瓦片</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721823340891.png" alt="QQ_1721823340891.png|1090"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">TileDebug</span>, <span class="variable constant_">XYZ</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; fromLonLat &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/proj&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//实例化图层数据源对象</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> <span class="title class_">TiandituSource</span> = <span class="keyword">new</span> <span class="title function_">XYZ</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">url</span>: <span class="string">&#x27;http://t0.tianditu.com/DataServer?T=vec_w&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">attributions</span>: <span class="string">&#x27;天地图的属性描述&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">wrapX</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//加载瓦片网格图层</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> tileLayer = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">TileDebug</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//获取瓦片图层数据对象（osmSource）的网格信息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">tileGrid</span>: <span class="title class_">TiandituSource</span>.<span class="title function_">getTileGrid</span>()!,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: <span class="title function_">fromLonLat</span>([<span class="number">87.16552734375</span>, <span class="number">39.470125122358176</span>]),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">8</span>, <span class="comment">//地图初始显示级别</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [tileLayer],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>``</p>
<h2 id="10-各渠道地图"><a href="#10-各渠道地图" class="headerlink" title="10 各渠道地图"></a>10 各渠道地图</h2><h3 id="10-1-高德地图"><a href="#10-1-高德地图" class="headerlink" title="10.1 高德地图"></a>10.1 高德地图</h3><blockquote>
<p>高德地图也是一种瓦片图层，是通过行列号与层级(zoom)关系加载的<br>Layer.TileLayer + Source.XYZ</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870326007.png" alt="QQ_1721870326007.png|954"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="variable constant_">XYZ</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//高德地图也是一种瓦片图层，是通过行列号与层级(zoom)关系加载的</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">let</span> gaodeMapLayer = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title function_">XYZ</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">url</span>: <span class="string">&#x27; http://wprd0 &#123;1-4&#125;.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;z=&#123;z&#125;&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">wrapX</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: [<span class="number">12958752</span>, <span class="number">4848452</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:3857&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">8</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">minZoom</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [gaodeMapLayer],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-2-天地图"><a href="#10-2-天地图" class="headerlink" title="10.2 天地图"></a>10.2 天地图</h3><blockquote>
<p>Layer.TileLayer + Source.XYZ</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870387476.png" alt="QQ_1721870387476.png|778"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-checkbox-group</span> <span class="attr">v-model</span>=<span class="string">&quot;checkList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in layerList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;(checked: boolean) =&gt; layerCtl(checked, i)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-checkbox-group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; transform &#125; from &#x27;ol/proj&#x27;;</span><br><span class="line">import XYZ from &#x27;ol/source/XYZ&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line">// 选中的图层</span><br><span class="line">const checkList = ref&lt;string[]&gt;([]);</span><br><span class="line">// 所有图层</span><br><span class="line">const layerList = ref&lt;string[]&gt;([]);</span><br><span class="line"></span><br><span class="line">// 图层选择</span><br><span class="line">const layerCtl = (checked: boolean, index: number) =&gt; &#123;</span><br><span class="line">  let layers = map.getLayers();</span><br><span class="line">  layers?.getArray()[index].setVisible(checked);</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  // 加载瓦片图层数据(天地图矢量图层)</span><br><span class="line">  const VectorLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27; http://t0.tianditu.com/DataServer?T=vec_w&amp;x= &#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">      wrapX: false,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  VectorLayer.set(&#x27;name&#x27;, &#x27;天地图矢量图层&#x27;);</span><br><span class="line">  // 天地图矢量图层注记</span><br><span class="line">  const VectorNoteLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27; http://t0.tianditu.com/DataServer?T=cva_w&amp;x= &#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">      wrapX: false,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  VectorNoteLayer.set(&#x27;name&#x27;, &#x27;天地图矢量图层注记&#x27;);</span><br><span class="line">  // 天地图路网</span><br><span class="line">  const roadLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27; https://t0.tianditu.gov.cn/DataServer?T=vec_w&amp;x= &#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  roadLayer.set(&#x27;name&#x27;, &#x27;天地图路网&#x27;);</span><br><span class="line">  // 天地图文字标注</span><br><span class="line">  const textNoteLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27; https://t0.tianditu.gov.cn/DataServer?T=cia_w&amp;x= &#123;x&#125;&amp;y=&#123;y&#125;&amp;l=&#123;z&#125;&amp;tk=e2a629259868f1b5e14ed43ff28d5c8c&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  textNoteLayer.set(&#x27;name&#x27;, &#x27;天地图文字标注&#x27;);</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: transform([114.5, 38.0], &#x27;EPSG:4326&#x27;, &#x27;EPSG:3857&#x27;),</span><br><span class="line">      zoom: 11,</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [VectorLayer, VectorNoteLayer, roadLayer, textNoteLayer],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 获取 map 中图层</span><br><span class="line">  const allLayer = map.getAllLayers();</span><br><span class="line">  allLayer.forEach((e) =&gt; &#123;</span><br><span class="line">    layerList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">    checkList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 20px;</span><br><span class="line">  top: 20px;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-3-Bing-地图"><a href="#10-3-Bing-地图" class="headerlink" title="10.3 Bing 地图"></a>10.3 Bing 地图</h3><blockquote>
<p>bingMapS 其实也是一种地图瓦片，采用的是瓦片方式加载，需要用到瓦片地图渲染<br>Layer.TileLayer+Source.BingMaps</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870463613.png" alt="QQ_1721870463613.png|642"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">BingMaps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; fromLonLat &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/proj&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//实例化 Map 对象加载地图</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> key = <span class="string">&#x27;Q57tupj2UBsQNQdju4xL~xBceblfTd6icjljunbuaCw~AhwA-whmGMsfIpVhslZyknWhFYq-GvWJZqBnqV8Zq1uRlI5YM_qr7_hxvdgnU7nH&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// bingMapS 其实也是一种地图瓦片，采用的是瓦片方式加载，需要用到瓦片地图渲染</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">let</span> roads = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">BingMaps</span>(&#123; <span class="attr">key</span>: key, <span class="attr">imagerySet</span>: <span class="string">&#x27;Road&#x27;</span> &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [roads],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: <span class="title function_">fromLonLat</span>([-<span class="number">109</span>, <span class="number">46.5</span>]),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">6</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-4-ArcGIS"><a href="#10-4-ArcGIS" class="headerlink" title="10.4 ArcGIS"></a>10.4 ArcGIS</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721870905400.png" alt="QQ_1721870905400.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">el-checkbox-group</span> <span class="attr">v-model</span>=<span class="string">&quot;checkList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in layerList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;(checked: boolean) =&gt; layerCtl(checked, i)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">el-checkbox-group</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; TileArcGISRest, XYZ &#125; from &#x27;ol/source&#x27;;</span><br><span class="line">import &#123; fromLonLat &#125; from &#x27;ol/proj&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line">// 选中的图层</span><br><span class="line">const checkList = ref&lt;string[]&gt;([]);</span><br><span class="line">// 所有图层</span><br><span class="line">const layerList = ref&lt;string[]&gt;([]);</span><br><span class="line"></span><br><span class="line">// 图层选择</span><br><span class="line">const layerCtl = (checked: boolean, index: number) =&gt; &#123;</span><br><span class="line">  let layers = map.getLayers();</span><br><span class="line">  layers?.getArray()[index].setVisible(checked);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  // 加载 arcGIS 的 MapServer 地图</span><br><span class="line">  // arcGIS 的地图影像都是通过地图影像切片，将数据裁切成512*512/256*256的大小的图片，加载</span><br><span class="line">  const arcGISMapServerLayer = new TileLayer(&#123;</span><br><span class="line">    source: new TileArcGISRest(&#123;</span><br><span class="line">      url: &#x27; https://server.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer &#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  arcGISMapServerLayer.set(&#x27;name&#x27;, &#x27;TileArcGISRest&#x27;);</span><br><span class="line"></span><br><span class="line">  const arcGISTileLayer = new TileLayer(&#123;</span><br><span class="line">    source: new XYZ(&#123;</span><br><span class="line">      url: &#x27; http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/ &#123;z&#125;/&#123;y&#125;/&#123;x&#125;&#x27;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  arcGISTileLayer.set(&#x27;name&#x27;, &#x27;XYZ&#x27;);</span><br><span class="line"></span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: fromLonLat([87.16552734375, 39.470125122358176]),</span><br><span class="line">      zoom: 5,</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [arcGISMapServerLayer, arcGISTileLayer],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 获取 map 中图层</span><br><span class="line">  const allLayer = map.getAllLayers();</span><br><span class="line">  allLayer.forEach((e) =&gt; &#123;</span><br><span class="line">    layerList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">    checkList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 20px;</span><br><span class="line">  top: 20px;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="11-JSON-相关"><a href="#11-JSON-相关" class="headerlink" title="11 JSON 相关"></a>11 JSON 相关</h2><h3 id="11-1-GeoJSON"><a href="#11-1-GeoJSON" class="headerlink" title="11.1 GeoJSON"></a>11.1 GeoJSON</h3><h4 id="11-1-1-简介"><a href="#11-1-1-简介" class="headerlink" title="11.1.1 简介"></a>11.1.1 简介</h4><p>GeoJSON 是一种对各种地理数据结构进行编码的格式，基于 Javascript 对象表示法(JavaScript Object Notation, 简称 JSON)的地理空间信息数据交换格式。GeoJSON 对象可以表示几何、特征或者特征集合。</p>
<p>GeoJSON 支持下面几何类型：点、线、面、多点、多线、多面和几何集合。</p>
<p>GeoJSON 里的特征包含一个几何对象和其他属性，特征集合表示一系列特征。</p>
<p>一个完整的 GeoJSON 数据结构总是一个（JSON 术语里的）对象。在 GeoJSON 里，对象由名/值对–也称作成员的集合组成。对每个成员来说，名字总是字符串。成员的值要么是字符串、数字、对象、数组，要么是下面文本常量中的一个：”true”,”false”和”null”。数组的值是上面所说的元素组成。GeoJSON 总是由一个单独的对象组成。这个对象（指的是下面的 GeoJSON 对象）表示几何、特征或者特征集合。GeoJSON 对象可能有任何数目成员（名/值对）。</p>
<p>GeoJSON 对象必须有一个名字为”type”的成员。这个成员的值是由 GeoJSON 对象的类型所确定的字符串。type 成员的值必须是下面之一：</p>
<ul>
<li>Point</li>
<li>MultiPoint</li>
<li>LineString</li>
<li>MultiLineString</li>
<li>Polygon</li>
<li>MultiPolygon</li>
<li>GeometryCollection</li>
<li>Feature</li>
<li>FeatureCollection</li>
</ul>
<p>GeoJSON 对象可能有一个可选的”crs”成员，它的值必须是一个坐标参考系统的对象。</p>
<p>GeoJSON 对象可能有一个”bbox”成员，它的值必须是边界框数组。</p>
<h4 id="11-1-2-new-GeoJSON-options"><a href="#11-1-2-new-GeoJSON-options" class="headerlink" title="11.1.2 new GeoJSON(options)"></a>11.1.2 new GeoJSON(options)</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721876969291.png" alt="QQ_1721876969291.png"></p>
<h4 id="11-1-3-代码实现"><a href="#11-1-3-代码实现" class="headerlink" title="11.1.3 代码实现"></a>11.1.3 代码实现</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871220939.png" alt="QQ_1721871220939.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">OSM</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">CircleStyle</span> <span class="keyword">from</span> <span class="string">&#x27;ol/style/Circle&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">Fill</span>, <span class="title class_">Stroke</span>, <span class="title class_">Style</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type <span class="title class_">Feature</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">Geometry</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorSource</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">GeoJSON</span> <span class="keyword">from</span> <span class="string">&#x27;ol/format/GeoJSON&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">StyleLike</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style/Style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> <span class="title function_">addGeoJsonLayer</span> = (<span class="params"></span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//定义各种要素的样式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> image = <span class="keyword">new</span> <span class="title class_">CircleStyle</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">radius</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> styles = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Point</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">LineString</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Polygon</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">lineDash</span>: [<span class="number">4</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(0, 0, 255, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">LinearRing</span>: [],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">MultiPoint</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">MultiLineString</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">MultiPolygon</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;yellow&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 0, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">GeometryCollection</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">image</span>: <span class="keyword">new</span> <span class="title class_">CircleStyle</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">radius</span>: <span class="number">10</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Circle</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.2)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> <span class="title function_">styleFunction</span> = (<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> type = feature.<span class="title function_">getGeometry</span>()?.<span class="title function_">getType</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (type) <span class="keyword">return</span> styles[type];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> vectorLayer = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">url</span>: <span class="string">&#x27; http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3Aprovincial_boundaries&amp;maxFeatures=50&amp;outputFormat=application%2Fjson &#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">format</span>: <span class="keyword">new</span> <span class="title class_">GeoJSON</span>(), <span class="comment">//指定数据读取格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">style</span>: styleFunction <span class="keyword">as</span> <span class="title class_">StyleLike</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map.<span class="title function_">addLayer</span>(vectorLayer);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">4</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">source</span>: <span class="keyword">new</span> <span class="title function_">OSM</span>(),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    ],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">addGeoJsonLayer</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>

<h3 id="11-2-TopoJSON"><a href="#11-2-TopoJSON" class="headerlink" title="11.2 TopoJSON"></a>11.2 TopoJSON</h3><h4 id="11-2-1-简介"><a href="#11-2-1-简介" class="headerlink" title="11.2.1 简介"></a>11.2.1 简介</h4><p>TopoJSON 是 GeoJSON 的扩展，增加了拓扑逻辑的编码。支持多种几何图形类型：Point、LineString、Polygon、MultiPoint、MultiLineString、MultiPolygon 和 GeometryCollection。TopoJSON 中的几何图形可能包含用于编码非几何数据的附加属性。</p>
<p>TopoJSON 文件中的几何图形不是独立地表示，而是由共享的线段（称为弧线）拼接而成，即 TopoJSON 中的每一个几何体都是通过将共享边（被称为 arcs）整合后组成的。</p>
<p>因此 TopoJSON 消除了冗余，提供了比 GeoJSON 更紧凑的几何表示；典型的 TopoJSON 文件比 GeoJSON 等价文件小 80%。原因：</p>
<ol>
<li>边界线只记录一次（例如广西和广东的交界线只记录一次）;</li>
<li>地理坐标使用整数，不使用浮点数。</li>
</ol>
<p>其中：</p>
<ul>
<li>点状地理实体 - 由坐标表示</li>
<li>线状地理实体 - 由弧索引表示</li>
<li>多边形 - 由弧索引表示</li>
</ul>
<p>TopoJSON 文件由三部分组成：</p>
<ul>
<li>transform：描述了变换参数</li>
<li>objects：描述地理实体包含空间及属性信息</li>
<li>arcs： <strong>描述了有向弧的空间关系，弧由一系列起点及相对于起点的有向偏移坐标表示</strong></li>
</ul>
<p>geometries 中 <strong>arcs 如果是负值，说明逆序</strong>。基于这种弧的存储方式可以表达出拓扑关系。</p>
<p>由于弧只记录一次及地理坐标使用整数，不使用浮点数，相对于 GeoJSON，TopoJSON 消除了冗余，文件大小缩小了 80%。</p>
<p>topojson 格式说明： <a target="_blank" rel="noopener" href="https://github.com/topojson/topojson-specification">https://github.com/topojson/topojson-specification</a></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871937882.png" alt="QQ_1721871937882.png|732"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Topology&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;transform&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scale&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">0.0005000500050005</span><span class="punctuation">,</span> <span class="number">0.00010001000100010001</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;translate&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">100</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;objects&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;example&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;GeometryCollection&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;geometries&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Point&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;prop0&quot;</span><span class="punctuation">:</span> <span class="string">&quot;value0&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;coordinates&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">4000</span><span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LineString&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;prop0&quot;</span><span class="punctuation">:</span> <span class="string">&quot;value0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;prop1&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;arcs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Polygon&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;prop0&quot;</span><span class="punctuation">:</span> <span class="string">&quot;value0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;prop1&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;this&quot;</span><span class="punctuation">:</span> <span class="string">&quot;that&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;arcs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;arcs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span><span class="punctuation">[</span><span class="number">4000</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">1999</span><span class="punctuation">,</span> <span class="number">9999</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">2000</span><span class="punctuation">,</span> <span class="number">-9999</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">2000</span><span class="punctuation">,</span> <span class="number">9999</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span><span class="punctuation">[</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">9999</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">2000</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">-9999</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">[</span><span class="number">-2000</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="11-2-2-代码实现"><a href="#11-2-2-代码实现" class="headerlink" title="11.2.2 代码实现"></a>11.2.2 代码实现</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871420626.png" alt="QQ_1721871420626.png|843"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">Fill</span>, <span class="title class_">Stroke</span>, <span class="title class_">Style</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorSource</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TopoJSON</span> <span class="keyword">from</span> <span class="string">&#x27;ol/format/TopoJSON&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> style = <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 255, 0.6)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">color</span>: <span class="string">&#x27; #319FD3 &#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">url</span>: <span class="string">&#x27;/GisData/topojson/world-110m.json&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">format</span>: <span class="keyword">new</span> <span class="title class_">TopoJSON</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// don&#x27;t want to render the full world polygon (stored as &#x27;land&#x27; layer),</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// which repeats all countries</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">layers</span>: [<span class="string">&#x27;countries&#x27;</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">overlaps</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">style</span>: style,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="variable language_">console</span>.<span class="title function_">log</span>(vector.<span class="title function_">getSource</span>()?.<span class="title function_">getFeatures</span>());</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: [<span class="number">0</span>, <span class="number">0</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [vector],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>注意：这里 GisData 在 public 里</strong></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721871298439.png"></p>
<h4 id="11-2-3-Geojson-与-Topojson-之间的转换"><a href="#11-2-3-Geojson-与-Topojson-之间的转换" class="headerlink" title="11.2.3 Geojson 与 Topojson 之间的转换"></a>11.2.3 Geojson 与 Topojson 之间的转换</h4><p><code>npm install -g topojson -s</code></p>
<p>topojson.topology 转换 GeoJSON to TopoJSON.</p>
<p>geo2topo 转换 GeoJSON to TopoJSON</p>
<p>详情见：<a target="_blank" rel="noopener" href="https://github.com/topojson/topojson">GitHub - topojson/topojson: An extension of GeoJSON that encodes topology! 🌐</a></p>
<h3 id="11-3-Esrijson"><a href="#11-3-Esrijson" class="headerlink" title="11.3 Esrijson"></a>11.3 Esrijson</h3><h4 id="11-3-1-简介"><a href="#11-3-1-简介" class="headerlink" title="11.3.1 简介"></a>11.3.1 简介</h4><p>EsriJSON 是一种用于对各种地理数据结构进行编码的格式。对于 EsriJSON，其通常是指 FeatureSet 对象，其中 FeatureSet 包含一组 Feature 对象。在 ArcGIS Velocity 中，可以将 EsriJSON 提取为 FeatureSet 对象（要素集合）或者将单个 Feature 对象提取为行。</p>
<ul>
<li>支持的 EsriJSON：Velocity 支持保持一致的几何类型、字段集合和空间参考的 EsriJSON。</li>
<li>生成 EsriJSON：可以使用 ArcGIS Pro 要素转 JSON 工具或 ArcMap 要素转 JSON 工具将数据从多种格式转换为 EsriJSON。</li>
</ul>
<p><strong>EsriJSON 要素属性必须保持一致</strong>：在 EsriJSON 数据格式中，属性数据用属性对象内的名称值对表示。任何属性的值都应该具有值或空值。如果要素的某个属性不具有值，则该属性值应以空值表示，而不应缺少该属性名称。</p>
<p><strong>EsriJSON 文件大小</strong>：最佳做法是，要提取的每个 EsriJSON 文件应小于 100 MB。如果要提取的数据量较大，建议将这些文件分解为每个文件 100 MB 以下。</p>
<h4 id="11-3-2-代码实现"><a href="#11-3-2-代码实现" class="headerlink" title="11.3.2 代码实现"></a>11.3.2 代码实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">CircleStyle</span> <span class="keyword">from</span> <span class="string">&#x27;ol/style/Circle&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">Fill</span>, <span class="title class_">Stroke</span>, <span class="title class_">Style</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type <span class="title class_">Feature</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">Geometry</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorSource</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">EsriJSON</span> <span class="keyword">from</span> <span class="string">&#x27;ol/format/EsriJSON&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">StyleLike</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style/Style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//定义各种要素的样式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> image = <span class="keyword">new</span> <span class="title class_">CircleStyle</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">radius</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> styles = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Point</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">LineString</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Polygon</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;blue&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">lineDash</span>: [<span class="number">4</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(0, 0, 255, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">LinearRing</span>: [],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">MultiPoint</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">image</span>: image,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">MultiLineString</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;green&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">MultiPolygon</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;yellow&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 0, 0.1)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">GeometryCollection</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">image</span>: <span class="keyword">new</span> <span class="title class_">CircleStyle</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">radius</span>: <span class="number">10</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">fill</span>: <span class="literal">undefined</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">color</span>: <span class="string">&#x27;magenta&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Circle</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">2</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27;rgba(255,0,0,0.2)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> <span class="title function_">styleFunction</span> = (<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> type = feature.<span class="title function_">getGeometry</span>()?.<span class="title function_">getType</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (type) <span class="keyword">return</span> styles[type];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  axios</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    .<span class="title function_">get</span>(<span class="string">&#x27; http://localhost:8888/openlayer/esrijson/esrijson.json &#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response: any</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//指定数据格式是 esrijson</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> esriJSON = <span class="keyword">new</span> <span class="title class_">EsriJSON</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> arr = response.<span class="property">data</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> vectorSource = <span class="keyword">new</span> <span class="title class_">VectorSource</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">for</span> (<span class="keyword">const</span> arrElement <span class="keyword">of</span> arr) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//读取后台响应的 esrijson 数据，读取要素信息，添加到矢量数据源</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> feature = esriJSON.<span class="title function_">readFeature</span>(arrElement);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        vectorSource.<span class="title function_">addFeature</span>(feature);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// let feature = esriJSON.readFeatures(arr);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// vectorSource.addFeatures(feature);</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//将矢量图层添加到地图中</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> vector = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//矢量数据源</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">source</span>: vectorSource,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//样式设置</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">style</span>: styleFunction <span class="keyword">as</span> <span class="title class_">StyleLike</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">layers</span>: [vector],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">center</span>: [<span class="number">0</span>, <span class="number">0</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">zoom</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>, <span class="comment">//指定投影</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">error: any</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>

<h4 id="11-3-3-Geojson-与-Esrijson-之间的转换"><a href="#11-3-3-Geojson-与-Esrijson-之间的转换" class="headerlink" title="11.3.3 Geojson 与 Esrijson 之间的转换"></a>11.3.3 Geojson 与 Esrijson 之间的转换</h4><p><code>npm install @esri/arcgis-to-geojson-utils</code></p>
<h2 id="12-WKT"><a href="#12-WKT" class="headerlink" title="12 WKT"></a>12 WKT</h2><h3 id="12-1-简介"><a href="#12-1-简介" class="headerlink" title="12.1 简介"></a>12.1 简介</h3><p>WKT(Well-known text)是一种文本标记语言，用于表示矢量几何对象、空间参照系统及空间参照系统之间的转换。</p>
<p>它的二进制表示方式，亦即 WKB(well-known binary)则胜于在传输和在数据库中存储相同的信息。该格式由开放地理空间联盟(OGC)制定。</p>
<ul>
<li><p>WKT - 几何对象：WKT 可以表示的几何对象包括：点，线，多边形，TIN（不规则三角网）及多面体。可以通过几何集合的方式来表示不同维度的几何对象。</p>
</li>
<li><p>几何物体的坐标可以是 2D(x,y),3D(x,y,z),4D(x,y,z,m),加上一个属于线性参照系统的 m 值。</p>
</li>
</ul>
<p>WKT 字串样例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">POINT</span>(<span class="number">6</span> <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">LINESTRING</span>(<span class="number">3</span> <span class="number">4</span>,<span class="number">10</span> <span class="number">50</span>,<span class="number">20</span> <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">POLYGON</span>((<span class="number">1</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">1</span>),(<span class="number">2</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="title function_">MULTIPOINT</span>(<span class="number">3.5</span> <span class="number">5.6</span>, <span class="number">4.8</span> <span class="number">10.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">MULTILINESTRING</span>((<span class="number">3</span> <span class="number">4</span>,<span class="number">10</span> <span class="number">50</span>,<span class="number">20</span> <span class="number">25</span>),(-<span class="number">5</span> -<span class="number">8</span>,-<span class="number">10</span> -<span class="number">8</span>,-<span class="number">15</span> -<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="title function_">MULTIPOLYGON</span>(((<span class="number">1</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">1</span>,<span class="number">5</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">5</span>,<span class="number">1</span> <span class="number">1</span>),(<span class="number">2</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">3</span>,<span class="number">3</span> <span class="number">2</span>,<span class="number">2</span> <span class="number">2</span>)),((<span class="number">6</span> <span class="number">3</span>,<span class="number">9</span> <span class="number">2</span>,<span class="number">9</span> <span class="number">4</span>,<span class="number">6</span> <span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"><span class="title function_">GEOMETRYCOLLECTION</span>(<span class="title function_">POINT</span>(<span class="number">4</span> <span class="number">6</span>),<span class="title function_">LINESTRING</span>(<span class="number">4</span> <span class="number">6</span>,<span class="number">7</span> <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="variable constant_">POINT</span> <span class="title function_">ZM</span> (<span class="number">1</span> <span class="number">1</span> <span class="number">5</span> <span class="number">60</span>)   <span class="comment">// Z 一般代表高程信息，M 一般代表其他信息如距离、温度、浓度，湿度等</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">POINT</span> <span class="title function_">M</span> (<span class="number">1</span> <span class="number">1</span> <span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<h3 id="12-2-代码实现"><a href="#12-2-代码实现" class="headerlink" title="12.2 代码实现"></a>12.2 代码实现</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872871517.png" alt="QQ_1721872871517.png|594"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">OSM</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">WKT</span> <span class="keyword">from</span> <span class="string">&#x27;ol/format/WKT&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorSource</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title function_">OSM</span>(),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> wkt = <span class="string">&#x27;POLYGON((10.689 -25.092, 34.595 &#x27;</span> + <span class="string">&#x27;-20.170, 38.814 -35.639, 13.502 &#x27;</span> + <span class="string">&#x27;-39.155, 10.689 -25.092))&#x27;</span>; <span class="comment">//wkt 表示面的情况下，也是需要闭合的</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//指定数据加载的读取格式 wkt</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> format = <span class="keyword">new</span> <span class="title function_">WKT</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//用 wkt 读取要素信息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> feature = format.<span class="title function_">readFeature</span>(wkt, &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">dataProjection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>, <span class="comment">// 数据的投影坐标</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">featureProjection</span>: <span class="string">&#x27;EPSG:3857&#x27;</span>, <span class="comment">// 读取之后的要素的投影坐标</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//矢量图层</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">features</span>: [feature],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//地图渲染</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: [<span class="number">2952104.0199</span>, -<span class="number">3277504.823</span>], <span class="comment">//中心点使用的是平面投影3857</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">4</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="13-WKB"><a href="#13-WKB" class="headerlink" title="13 WKB"></a>13 WKB</h2><h3 id="13-1-简介"><a href="#13-1-简介" class="headerlink" title="13.1 简介"></a>13.1 简介</h3><p>WKB 采用<strong>二进制</strong>进行存储，更方便于计算机处理，因此广泛运用于数据的传输与存储。其存储结构如下：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872526732.png" alt="QQ_1721872526732.png|1009"></p>
<p>以二位点 Point(1 1)为例，其 WKB 表达如下：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872587042.png" alt="QQ_1721872587042.png|682"></p>
<p>其中：</p>
<ul>
<li><strong>byteOrder</strong><br>第 1 个字节表示编码方式，00 为使用 big-endian 编码(XDR)，01 为使用 little-endian 编码(NDR)。他们的不同仅限于在内存中放置字节的顺序，比如我们将 0x1234abcd 写入到以 0×0000 开始的内存中，则结果如下表：<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872705284.png" alt="QQ_1721872705284.png"></li>
<li><strong>wkbType</strong><br>第 2 到第 9 字节对矢量数据基本信息进行了定义。<br>第 2 与第 3 个字节规定了矢量数据的类型，如例子中的 0100 代表 Point。<br>第 3 与第 4 个字节规定了矢量数据的维数，如例子中的 0020 代表该点是二维的。</li>
<li><strong>srid</strong><br>第 5 到第 9 个字节规定了矢量数据的空间参考 SRID，如例子中的 E6100000 是 4326 的整数十六位进制表达。</li>
<li><strong>structPoint</strong><br>第 10 个字节开始，每 16 个字节就代表一个坐标对，如例子中的 000000000000F03F 是浮点型 1 的十六进制表达</li>
</ul>
<h3 id="13-2-代码实现"><a href="#13-2-代码实现" class="headerlink" title="13.2 代码实现"></a>13.2 代码实现</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721872884171.png" alt="QQ_1721872884171.png|714"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">OSM</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">WKB</span> <span class="keyword">from</span> <span class="string">&#x27;ol/format/WKB&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorSource</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">SimpleGeometry</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//初始化 osm 的瓦片地图</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title function_">OSM</span>(),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//wkb16进制的字符串表示</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> wkb =</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="string">&#x27;0103000020E61000000100000005000000AFA82D76AC9B5A404201744963AD4140CC9DB93DAE9B5A40740FC69561AD4140767163B4AE9B5A407948E4205EAD4140A5C08AA8AB9B5A400410172E61AD4140AFA82D76AC9B5A404201744963AD4140&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//指定加载的数据格式 wkb</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> format = <span class="keyword">new</span> <span class="title function_">WKB</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//读取 wkb</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> feature = format.<span class="title function_">readFeature</span>(wkb, &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">/* 因为 view 指定了4326投影 与数据的投影一致 故不需要再转换投影 */</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// dataProjection: &#x27;EPSG:4326&#x27;,//数据投影</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// featureProjection: &#x27;EPSG:3857&#x27;,//要素投影</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//wkb 也是矢量数据，只不过是矢量数据的二进制表示，因此数据需要使用矢量图层加载</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">features</span>: [feature],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: [<span class="number">106.432666551</span>, <span class="number">35.354313681</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">15</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>, <span class="comment">//指定投影</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 跳转视图到要素所在位置</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map.<span class="title function_">getView</span>().<span class="title function_">fit</span>(feature.<span class="title function_">getGeometry</span>() <span class="keyword">as</span> <span class="title class_">SimpleGeometry</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="14-XML"><a href="#14-XML" class="headerlink" title="14 XML"></a>14 XML</h2><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721812288654.png" alt="QQ_1721812288654.png|619"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721812338516.png" alt="QQ_1721812338516.png|756"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721812398558.png" alt="QQ_1721812398558.png|424"></p>
<h2 id="15-KML"><a href="#15-KML" class="headerlink" title="15 KML"></a>15 KML</h2><blockquote>
<p>KML(Keyhole Markup Language,Keyhole 标记语言)最初是由 Google 旗下的 Keyhole 公司开发和维护的一种基于 XML 的标记语言，利用 XML 语法格式描述地理空间数据(如点、线、面、<br>多边形和模型等)，适合网络环境下的地理信息协作与共享。2008 年 4 月,KML 的最新版本2.2 被 OGC 宣布为开放地理信息编码标准,并改由 OGC 维护和发展。</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721877380601.png" alt="QQ_1721877380601.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;infoDom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">KML</span> <span class="keyword">from</span> <span class="string">&#x27;ol/format/KML&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">OSM</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">Fill</span>, <span class="title class_">Stroke</span>, <span class="title class_">Style</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorSource</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">FeatureLike</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">Pixel</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/pixel&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> infoDom = ref&lt;<span class="title class_">HTMLElement</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// 显示选择要素的属性信息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> <span class="title function_">addEvent</span> = (<span class="params"></span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> <span class="title function_">displayFeatureInfo</span> = (<span class="params">pixel: Pixel</span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> <span class="attr">features</span>: <span class="title class_">FeatureLike</span>[] = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//遍历地图当前像素下的所有的矢量要素数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    map.<span class="title function_">forEachFeatureAtPixel</span>(pixel, <span class="function">(<span class="params">feature</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      features.<span class="title function_">push</span>(feature);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (features.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">const</span> info = [];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> i, j;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//通过 name 属性获取到要素的值</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">for</span> (i = <span class="number">0</span>, j = features.<span class="property">length</span>; i &lt; j; ++i) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        info.<span class="title function_">push</span>(features[i].<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>));</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//将要素的 name 值放到 info 框</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      infoDom.<span class="property">value</span>!.<span class="property">innerHTML</span> = info.<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>) || <span class="string">&#x27;(unknown)&#x27;</span>; <span class="comment">//鼠标放在地图 map 上的鼠标样式：手型</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      map.<span class="title function_">getTargetElement</span>().<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&#x27;pointer&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      infoDom.<span class="property">value</span>!.<span class="property">innerHTML</span> = <span class="string">&#x27;&amp;nbsp;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      map.<span class="title function_">getTargetElement</span>().<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&#x27;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//地图的鼠标移动事件</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map.<span class="title function_">on</span>(<span class="string">&#x27;pointermove&#x27;</span>, <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (evt.<span class="property">dragging</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//获取到鼠标移动的像素信息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> pixel = map.<span class="title function_">getEventPixel</span>(evt.<span class="property">originalEvent</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">displayFeatureInfo</span>(pixel);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//地图的鼠标点击事件</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map.<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//获取到鼠标点击的像素信息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">displayFeatureInfo</span>(evt.<span class="property">pixel</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 设置样式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> style = <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">color</span>: <span class="string">&#x27;rgba(255, 255, 255, 0.6)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">color</span>: <span class="string">&#x27; #319FD3 &#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// osm 地图</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title function_">OSM</span>(), <span class="comment">//加载 OpenStreetMap</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//kml 是矢量数据，需要使用矢量数据源加载，然后使用矢量图层渲染</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">url</span>: <span class="string">&#x27; http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3Aprovincial_boundaries&amp;maxFeatures=50&amp;outputFormat=application%2Fvnd.google-earth.kml%2Bxml &#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 指定数据读取格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">format</span>: <span class="keyword">new</span> <span class="title function_">KML</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">writeStyles</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 注意这里设置样式的不同</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">defaultStyle</span>: [style],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//渲染矢量图层</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: [<span class="number">108.24981689453125</span>, <span class="number">35.126468438108688</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">addEvent</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#info</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">z-index</span>: <span class="number">999</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>

<p><strong>注意设置 style 的不同</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">format</span>: <span class="keyword">new</span> <span class="title function_">KML</span>(&#123;</span><br><span class="line">    <span class="attr">writeStyles</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 注意这里设置样式的不同</span></span><br><span class="line">    <span class="attr">defaultStyle</span>: [style],</span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721877497411.png" alt="QQ_1721877497411.png|1262"></p>
<h2 id="16-GML"><a href="#16-GML" class="headerlink" title="16 GML"></a>16 GML</h2><blockquote>
<p>地理标记语言（Geographic Markup Language）是由 OGC 定义的 XML（标准通用标记语言的子集）格式，用来表达地理信息要素。它提供一个表达地理信息要素的语言模型，同时可以<br>   用来在 Internet 上进行数据交换。由开放地理信息系统协会（OGC）负责制定它的标准。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//gml 是矢量数据，需要使用矢量数据源加载，然后使用矢量图层渲染</span></span><br><span class="line">  <span class="keyword">const</span> vector = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span><br><span class="line">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;/GisData/gml/map.gml&#x27;</span>,</span><br><span class="line">      <span class="comment">// 指定数据读取格式</span></span><br><span class="line">      <span class="attr">format</span>: <span class="keyword">new</span> <span class="title function_">GML</span>(),</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">style</span>: style,</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721887340450.png" alt="QQ_1721887340450.png|829"></p>
<h2 id="17-GPX"><a href="#17-GPX" class="headerlink" title="17 GPX"></a>17 GPX</h2><blockquote>
<p>GPX（GPS eXchange Format, GPS 交换格式)是一个 XML 格式，为应用软件设计的通用 GPS 数据格式。<br>它可以用来描述路点、轨迹、路程。这个格式是免费的，可以在不需要付任何许可费用的前提下使用。<br>它的标签保存位置，海拔和时间，可以用来在不同的 GPS 设备和软件之间交换数据。<br>如查看轨迹、在照片的 exif 数据中嵌入地理数据。</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721888185514.png" alt="QQ_1721888185514.png|727"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;infoDom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">GPX</span> <span class="keyword">from</span> <span class="string">&#x27;ol/format/GPX&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">View</span> <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">TileLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="variable constant_">OSM</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; <span class="title class_">Fill</span>, <span class="title class_">Stroke</span>, <span class="title class_">Style</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorLayer</span> <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">VectorSource</span> <span class="keyword">from</span> <span class="string">&#x27;ol/source/Vector&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">FeatureLike</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">Pixel</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/pixel&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> <span class="title class_">CircleStyle</span> <span class="keyword">from</span> <span class="string">&#x27;ol/style/Circle&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type <span class="title class_">Feature</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Feature&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">Geometry</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/geom&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> type &#123; <span class="title class_">StyleLike</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/style/Style&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> <span class="attr">map</span>: <span class="title class_">Map</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//定义各种要素的样式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> styles = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">Point</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">image</span>: <span class="keyword">new</span> <span class="title class_">CircleStyle</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">fill</span>: <span class="keyword">new</span> <span class="title class_">Fill</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">color</span>: <span class="string">&#x27;rgba(255,255,0,0.4)&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">radius</span>: <span class="number">5</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">color</span>: <span class="string">&#x27; #ff0 &#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">width</span>: <span class="number">1</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">LineString</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27; #f00 &#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title class_">MultiLineString</span>: <span class="keyword">new</span> <span class="title class_">Style</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">stroke</span>: <span class="keyword">new</span> <span class="title class_">Stroke</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">color</span>: <span class="string">&#x27; #0f0 &#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="attr">width</span>: <span class="number">3</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 根据要素类型设置几何要素的样式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> <span class="title function_">styleFunction</span> = (<span class="params">feature: Feature&lt;Geometry&gt;</span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> type = feature.<span class="title function_">getGeometry</span>()?.<span class="title function_">getType</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (type === <span class="string">&#x27;Point&#x27;</span> || type === <span class="string">&#x27;LineString&#x27;</span> || type === <span class="string">&#x27;MultiLineString&#x27;</span>) <span class="keyword">return</span> styles[type];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// osm 地图</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> raster = <span class="keyword">new</span> <span class="title class_">TileLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title function_">OSM</span>(), <span class="comment">//加载 OpenStreetMap</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//GPX 是矢量数据，需要使用矢量数据源加载，然后使用矢量图层渲染</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> vector = <span class="keyword">new</span> <span class="title class_">VectorLayer</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">source</span>: <span class="keyword">new</span> <span class="title class_">VectorSource</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">url</span>: <span class="string">&#x27;/GisData/gpx/fells_loop.gpx&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">// 指定数据读取格式</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">format</span>: <span class="keyword">new</span> <span class="title function_">GPX</span>(),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">style</span>: styleFunction <span class="keyword">as</span> <span class="title class_">StyleLike</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">//渲染矢量图层</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  map = <span class="keyword">new</span> <span class="title class_">Map</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">layers</span>: [raster, vector],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">view</span>: <span class="keyword">new</span> <span class="title class_">View</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">center</span>: [-<span class="number">7916041.528716288</span>, <span class="number">5228379.045749711</span>],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">zoom</span>: <span class="number">12</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;),</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#info</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">z-index</span>: <span class="number">999</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721887456400.png" alt="QQ_1721887456400.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://VernalScenery.github.io">Scenery</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://vernalscenery.github.io/2024/07/26/openlayer/03%20openLayer_Layer%20+%20Source%20%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE/">https://vernalscenery.github.io/2024/07/26/openlayer/03%20openLayer_Layer%20+%20Source%20%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://VernalScenery.github.io" target="_blank">春和景明的记事本</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/openLayer/">openLayer</a><a class="post-meta__tags" href="/tags/WebGIS/">WebGIS</a></div><div class="post_share"><div class="social-share" data-image="/./img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/26/openlayer/04%20openLayer_Interaction%20%E5%9C%B0%E5%9B%BE%E4%BA%A4%E4%BA%92/" title="04 openLayer_Interaction 地图交互"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">04 openLayer_Interaction 地图交互</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/26/openlayer/02%20openLayer_Control%20%E6%8E%A7%E4%BB%B6/" title="02 openLayer_Control 控件"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">02 openLayer_Control 控件</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/07/26/openlayer/01%20openLayer_%E5%85%A5%E9%97%A8/" title="01 openLayer_入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">01 openLayer_入门</div></div></a></div><div><a href="/2024/07/26/openlayer/02%20openLayer_Control%20%E6%8E%A7%E4%BB%B6/" title="02 openLayer_Control 控件"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">02 openLayer_Control 控件</div></div></a></div><div><a href="/2024/07/26/openlayer/05%20openlayers_OGC%20%E6%9C%8D%E5%8A%A1/" title="05 openlayers_OGC 服务"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">05 openlayers_OGC 服务</div></div></a></div><div><a href="/2024/07/27/openlayer/06%20openlayers_OGC%20%E8%BF%87%E6%BB%A4%E5%99%A8/" title="06 openlayers_OGC 过滤器"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-27</div><div class="title">06 openlayers_OGC 过滤器</div></div></a></div><div><a href="/2024/07/27/openlayer/07%20openlayers_style%20%E6%A0%B7%E5%BC%8F%E9%85%8D%E7%BD%AE/" title="07 openlayers_style 样式配置"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-27</div><div class="title">07 openlayers_style 样式配置</div></div></a></div><div><a href="/2024/07/29/openlayer/08%20openLayer_Proj4%20%E6%8A%95%E5%BD%B1%E8%BD%AC%E6%8D%A2/" title="08 openLayer_Proj4 投影转换"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-29</div><div class="title">08 openLayer_Proj4 投影转换</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Scenery</div><div class="author-info__description">今天不想跑，所以才去跑</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">70</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/chjm0121" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1595718686@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0"><span class="toc-text">1 概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-BaseLayer-%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">2 BaseLayer - 抽象基类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-new-BaseLayer-options"><span class="toc-text">2.1 new BaseLayer(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Fires"><span class="toc-text">2.2 Fires</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Extends"><span class="toc-text">2.3 Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Subclasses"><span class="toc-text">2.4 Subclasses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Layer-%E5%9B%BE%E5%B1%82%E7%88%B6%E7%B1%BB"><span class="toc-text">3 Layer - 图层父类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-new-Layer-options"><span class="toc-text">3.1 new Layer(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Fires"><span class="toc-text">3.2 Fires</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Subclasses"><span class="toc-text">3.3 Subclasses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-Extends"><span class="toc-text">3.4 Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-Observable-Properties"><span class="toc-text">3.5 Observable Properties</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Source-%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">4 Source 抽象基类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-new-Source-options"><span class="toc-text">4.1 new Source(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Fires"><span class="toc-text">4.2 Fires</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Subclasses"><span class="toc-text">4.3 Subclasses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-Extends"><span class="toc-text">4.4 Extends</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-ImageLayer-%E5%BD%B1%E5%83%8F%E6%95%B0%E6%8D%AE"><span class="toc-text">5 ImageLayer - 影像数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-tileLayer-%E7%93%A6%E7%89%87%E5%9C%B0%E5%9B%BE"><span class="toc-text">6 tileLayer - 瓦片地图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E4%BC%98%E7%82%B9"><span class="toc-text">6.1 优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">6.2 代码实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-VectorLayer-%E7%9F%A2%E9%87%8F%E5%9C%B0%E5%9B%BE"><span class="toc-text">7 VectorLayer - 矢量地图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%96%B9%E5%BC%8F1-%EF%BC%9A"><span class="toc-text">7.1 方式1 ：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%96%B9%E5%BC%8F2%EF%BC%9A"><span class="toc-text">7.2 方式2：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-VectorTileLayer-%E7%9F%A2%E9%87%8F%E7%93%A6%E7%89%87"><span class="toc-text">8 VectorTileLayer - 矢量瓦片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E4%BC%98%E5%8A%BF"><span class="toc-text">8.1 优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E7%BC%BA%E7%82%B9"><span class="toc-text">8.2 缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">8.3 代码实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E7%93%A6%E7%89%87%E7%BD%91%E6%A0%BC"><span class="toc-text">9 瓦片网格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E5%90%84%E6%B8%A0%E9%81%93%E5%9C%B0%E5%9B%BE"><span class="toc-text">10 各渠道地图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE"><span class="toc-text">10.1 高德地图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E5%A4%A9%E5%9C%B0%E5%9B%BE"><span class="toc-text">10.2 天地图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-Bing-%E5%9C%B0%E5%9B%BE"><span class="toc-text">10.3 Bing 地图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-ArcGIS"><span class="toc-text">10.4 ArcGIS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-JSON-%E7%9B%B8%E5%85%B3"><span class="toc-text">11 JSON 相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-GeoJSON"><span class="toc-text">11.1 GeoJSON</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-1-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">11.1.1 简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-1-2-new-GeoJSON-options"><span class="toc-text">11.1.2 new GeoJSON(options)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-1-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">11.1.3 代码实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-TopoJSON"><span class="toc-text">11.2 TopoJSON</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">11.2.1 简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-2-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">11.2.2 代码实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-3-Geojson-%E4%B8%8E-Topojson-%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">11.2.3 Geojson 与 Topojson 之间的转换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-Esrijson"><span class="toc-text">11.3 Esrijson</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">11.3.1 简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-2-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">11.3.2 代码实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-3-3-Geojson-%E4%B8%8E-Esrijson-%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">11.3.3 Geojson 与 Esrijson 之间的转换</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-WKT"><span class="toc-text">12 WKT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">12.1 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">12.2 代码实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-WKB"><span class="toc-text">13 WKB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-%E7%AE%80%E4%BB%8B"><span class="toc-text">13.1 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-text">13.2 代码实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-XML"><span class="toc-text">14 XML</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-KML"><span class="toc-text">15 KML</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-GML"><span class="toc-text">16 GML</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-GPX"><span class="toc-text">17 GPX</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/20/WebGL/00_WebGL_%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%88%9D%E8%AF%86/" title="00_WebGL_图形学初识">00_WebGL_图形学初识</a><time datetime="2024-12-20T00:00:28.000Z" title="发表于 2024-12-20 08:00:28">2024-12-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/19/JS/19_JSLearn_%E6%B7%B1%E6%8B%B7%E8%B4%9D%E3%80%81%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF/" title="19_JSLearn_深拷贝、事件总线">19_JSLearn_深拷贝、事件总线</a><time datetime="2024-12-19T01:29:02.000Z" title="发表于 2024-12-19 09:29:02">2024-12-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/18/%E8%AE%A1%E7%BD%91/04_%E8%AE%A1%E7%BD%91_%E8%BF%90%E8%BE%93%E5%B1%82/" title="04_计网_运输层">04_计网_运输层</a><time datetime="2024-12-18T00:29:08.000Z" title="发表于 2024-12-18 08:29:08">2024-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/18/JS/18_JSLearn_%E9%98%B2%E6%8A%96%E3%80%81%E8%8A%82%E6%B5%81%E5%87%BD%E6%95%B0/" title="18_JSLearn_防抖、节流函数">18_JSLearn_防抖、节流函数</a><time datetime="2024-12-18T00:01:33.000Z" title="发表于 2024-12-18 08:01:33">2024-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/18/%E8%AE%A1%E7%BD%91/05_%E8%AE%A1%E7%BD%91_%E5%BA%94%E7%94%A8%E5%B1%82_01/" title="05_计网_应用层_01">05_计网_应用层_01</a><time datetime="2024-12-17T20:45:04.000Z" title="发表于 2024-12-18 04:45:04">2024-12-18</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./img/1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Scenery</div><div class="footer_custom_text"><div>波澜不惊</div><div class="footer-div"><img class="footer-icon" src="./img/备案图标.png"><a class="footer-a" target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">皖ICP备2021016944号-1</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>
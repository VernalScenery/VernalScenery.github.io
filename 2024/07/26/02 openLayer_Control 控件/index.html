<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>02 openLayer_Control 控件 | 春和景明的记事本</title><meta name="keywords" content="openLayer,WebGIS"><meta name="author" content="Scenery"><meta name="copyright" content="Scenery"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1 Control - 父类 A control is a visible widget with a DOM element in a fixed position on the screen. They can involve user input (buttons), or be informational only; the position is determined using CSS">
<meta property="og:type" content="article">
<meta property="og:title" content="02 openLayer_Control 控件">
<meta property="og:url" content="https://vernalscenery.github.io/2024/07/26/02%20openLayer_Control%20%E6%8E%A7%E4%BB%B6/index.html">
<meta property="og:site_name" content="春和景明的记事本">
<meta property="og:description" content="1 Control - 父类 A control is a visible widget with a DOM element in a fixed position on the screen. They can involve user input (buttons), or be informational only; the position is determined using CSS">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://vernalscenery.github.io/img/1.jpg">
<meta property="article:published_time" content="2024-07-26T01:29:48.000Z">
<meta property="article:modified_time" content="2024-07-26T13:43:55.160Z">
<meta property="article:author" content="Scenery">
<meta property="article:tag" content="openLayer">
<meta property="article:tag" content="WebGIS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://vernalscenery.github.io/img/1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://vernalscenery.github.io/2024/07/26/02%20openLayer_Control%20%E6%8E%A7%E4%BB%B6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '02 openLayer_Control 控件',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-26 21:43:55'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">春和景明的记事本</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">02 openLayer_Control 控件</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-26T01:29:48.000Z" title="发表于 2024-07-26 09:29:48">2024-07-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-26T13:43:55.160Z" title="更新于 2024-07-26 21:43:55">2024-07-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>33分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="02 openLayer_Control 控件"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-Control-父类"><a href="#1-Control-父类" class="headerlink" title="1 Control - 父类"></a>1 Control - 父类</h2><blockquote>
<p>A control is a visible widget with a DOM element in a fixed position on the screen. They can involve user input (buttons), or be informational only; the position is determined using CSS. By default these are placed in the container with CSS class name <code>ol-overlaycontainer-stopevent</code>, but can use any outside DOM element.</p>
<p>This is the base class for controls. You can use it for simple custom controls by creating the element with listeners, creating an instance:</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myControl = <span class="keyword">new</span> Control(&#123;<span class="attr">element</span>: myElement&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>and then adding this to the map.</p>
<p>The main advantage of having this as a control rather than a simple separate DOM element is that preventing propagation is handled for you. Controls will also be objects in a <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html"><code>Collection</code></a>, so you can use their methods.</p>
<p>You can also extend this base for your own control class. See examples/custom-controls for an example of how to do this.</p>
</blockquote>
<h3 id="1-1-Extends"><a href="#1-1-Extends" class="headerlink" title="1.1 Extends"></a>1.1 Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object-BaseObject.html">BaseObject</a></li>
</ul>
<h3 id="1-2-Subclasses"><a href="#1-2-Subclasses" class="headerlink" title="1.2 Subclasses"></a>1.2 Subclasses</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Attribution-Attribution.html">Attribution</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_FullScreen-FullScreen.html">FullScreen</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_MousePosition-MousePosition.html">MousePosition</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_OverviewMap-OverviewMap.html">OverviewMap</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Rotate-Rotate.html">Rotate</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ScaleLine-ScaleLine.html">ScaleLine</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ZoomSlider-ZoomSlider.html">ZoomSlider</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ZoomToExtent-ZoomToExtent.html">ZoomToExtent</a></li>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Zoom-Zoom.html">Zoom</a></li>
</ul>
<h3 id="1-3-new-control-option"><a href="#1-3-new-control-option" class="headerlink" title="1.3 new control(option)"></a>1.3 new control(option)</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723110633.png" alt="image.png"></p>
<h3 id="1-4-Fires"><a href="#1-4-Fires" class="headerlink" title="1.4 Fires"></a>1.4 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723110646.png" alt="image.png"></p>
<h3 id="1-5-Methods"><a href="#1-5-Methods" class="headerlink" title="1.5 Methods"></a>1.5 Methods</h3><ul>
<li><p>setMap(map)</p>
<blockquote>
<p>Remove the control from its current map and attach it to the new map. Pass <code>null</code> to just remove the control from the current map. Subclasses may set up event handlers to get notified about changes to the map here.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723110909.png" alt="image.png"></p>
</blockquote>
</li>
<li><p>getMap() =&gt; {<a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Map-Map.html">Map</a> | null}</p>
</li>
<li><p>setTarget(target)</p>
<blockquote>
<p>This function is used to set a target element for the control. It has no effect if it is called after the control has been added to the map (i.e. after <code>setMap</code> is called on the control). If no <code>target</code> is set in the options passed to the control constructor and if <code>setTarget</code> is not called then the control is added to the map’s overlay container.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723111139.png" alt="image.png"></p>
</blockquote>
</li>
<li><p>render(mapEvent)</p>
<blockquote>
<p>Renders the control.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723111108.png" alt="image.png"></p>
</blockquote>
</li>
</ul>
<h2 id="2-Zoom-导航控件"><a href="#2-Zoom-导航控件" class="headerlink" title="2 Zoom - 导航控件"></a>2 Zoom - 导航控件</h2><h3 id="2-1-Zoom"><a href="#2-1-Zoom" class="headerlink" title="2.1 Zoom"></a>2.1 Zoom</h3><blockquote>
<p>A control with 2 buttons, one for zoom in and one for zoom out. This control is one of the default controls of a map. To style this control use css selectors <code>.ol-zoom-in</code> and <code>.ol-zoom-out</code>.<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723111323.png" alt="image.png"></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> zoom = <span class="keyword">new</span> Zoom(&#123;</span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;ol-zoom-custom&#x27;</span>, <span class="comment">//CSS 类名</span></span><br><span class="line">    <span class="attr">duration</span>: <span class="number">1000</span>,</span><br><span class="line">    <span class="attr">zoomInLabel</span>: <span class="string">&#x27;+&#x27;</span>, <span class="comment">//放大的文本标签</span></span><br><span class="line">    <span class="attr">zoomOutLabel</span>: <span class="string">&#x27;-&#x27;</span>, <span class="comment">//缩小的文本标签</span></span><br><span class="line">    <span class="attr">zoomInTipLabel</span>: <span class="string">&#x27;放大&#x27;</span>, <span class="comment">//用于按钮提示的文本标签</span></span><br><span class="line">    <span class="attr">zoomOutTipLabel</span>: <span class="string">&#x27;缩小&#x27;</span>, <span class="comment">//用于按钮提示的文本标签</span></span><br><span class="line">    <span class="attr">delta</span>: <span class="number">5</span>, <span class="comment">//每次单击时应用的缩放增量</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(zoom);</span><br></pre></td></tr></table></figure>

<h3 id="2-2-ZoomSlider"><a href="#2-2-ZoomSlider" class="headerlink" title="2.2 ZoomSlider"></a>2.2 ZoomSlider</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723112714.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> slider = <span class="keyword">new</span> ZoomSlider(&#123;</span><br><span class="line">    <span class="attr">duration</span>: <span class="number">1000</span>, <span class="comment">//以毫秒为单位的动画持续时间</span></span><br><span class="line">    <span class="comment">//应重新呈现控件时调用的函数</span></span><br><span class="line">    <span class="attr">render</span>: <span class="function">(<span class="params">mapEvent</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(mapEvent);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(slider);</span><br></pre></td></tr></table></figure>

<h3 id="2-3-ZoomToExtent"><a href="#2-3-ZoomToExtent" class="headerlink" title="2.3 ZoomToExtent"></a>2.3 ZoomToExtent</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240723113735.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> extent = <span class="keyword">new</span> ZoomToExtent(&#123;</span><br><span class="line">    <span class="comment">// 缩放至特定位置控件</span></span><br><span class="line">    <span class="attr">extent</span>: [<span class="number">813079.7791264898</span>, <span class="number">5929220.284081122</span>, <span class="number">848966.9639063801</span>, <span class="number">5936863.986909639</span>],</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;T&#x27;</span>,</span><br><span class="line">    <span class="attr">tipLabel</span>: <span class="string">&#x27;复位&#x27;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(extent);</span><br></pre></td></tr></table></figure>

<h2 id="3-基础控件实现"><a href="#3-基础控件实现" class="headerlink" title="3 基础控件实现"></a>3 基础控件实现</h2><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721715631048.png" alt="QQ_1721715631048.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 缩小</span></span><br><span class="line"><span class="keyword">const</span> zoomOut = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">let</span> zoom = view?.getZoom();</span><br><span class="line">  <span class="keyword">if</span> (zoom) view?.setZoom(zoom - <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 放大</span></span><br><span class="line"><span class="keyword">const</span> zoomIn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">let</span> zoom = view?.getZoom();</span><br><span class="line">  <span class="keyword">if</span> (zoom) view?.setZoom(zoom + <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 平移</span></span><br><span class="line"><span class="keyword">const</span> translate = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="comment">//使用proj转换经纬度的坐标为平面坐标</span></span><br><span class="line">  <span class="keyword">let</span> lonLat = fromLonLat([<span class="number">116.36444091796875</span>, <span class="number">39.91184298474967</span>], <span class="string">&#x27;EPSG:4326&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(lonLat);</span><br><span class="line">  <span class="comment">//设置当前视图的中心位置与缩放级别</span></span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    view.setCenter([<span class="number">116.36444091796875</span>, <span class="number">39.91184298474967</span>]);</span><br><span class="line">    view.setZoom(<span class="number">12</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 旋转</span></span><br><span class="line"><span class="keyword">const</span> rotate = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    <span class="keyword">let</span> rotation = view.getRotation();</span><br><span class="line">    <span class="comment">//设置当前视图旋转的度数，度数是弧度制</span></span><br><span class="line">    view.setRotation(rotation + <span class="built_in">Math</span>.PI / <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复位</span></span><br><span class="line"><span class="keyword">const</span> reset = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> view = map.getView();</span><br><span class="line">  <span class="keyword">if</span> (view) &#123;</span><br><span class="line">    view.setZoom(zoom);</span><br><span class="line">    view.setRotation(rotation);</span><br><span class="line">    view.setCenter(center);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="4-图层选择实现"><a href="#4-图层选择实现" class="headerlink" title="4 图层选择实现"></a>4 图层选择实现</h2><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721717903399.png" alt="QQ_1721717903399.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-checkbox-group</span> <span class="attr">v-model</span>=<span class="string">&quot;checkList&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-checkbox</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, i) in layerList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;i&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;(checked: boolean) =&gt; layerCtl(checked, i)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-checkbox</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-checkbox-group</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import &#123; Zoom, ZoomSlider, ZoomToExtent &#125; from &#x27;ol/control&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import OSM from &#x27;ol/source/OSM.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; defaults as defaultControls &#125; from &#x27;ol/control.js&#x27;;</span><br><span class="line">import type MapEvent from &#x27;ol/MapEvent&#x27;;</span><br><span class="line">import VectorSource from &#x27;ol/source/Vector&#x27;;</span><br><span class="line">import GeoJSON from &#x27;ol/format/GeoJSON&#x27;;</span><br><span class="line">import &#123; ImageWMS, XYZ &#125; from &#x27;ol/source&#x27;;</span><br><span class="line">import ImageLayer from &#x27;ol/layer/Image&#x27;;</span><br><span class="line">import VectorLayer from &#x27;ol/layer/Vector&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line">// 选中的图层</span><br><span class="line">const checkList = ref&lt;string[]&gt;([]);</span><br><span class="line">// 所有图层</span><br><span class="line">const layerList = ref&lt;string[]&gt;([]);</span><br><span class="line"></span><br><span class="line">// 图层选择</span><br><span class="line">const layerCtl = (checked: boolean, index: number) =&gt; &#123;</span><br><span class="line">  let layers = map.getLayers();</span><br><span class="line">  layers?.getArray()[index].setVisible(checked);</span><br><span class="line">&#125;;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  // 加载 OSM</span><br><span class="line">  const osmLayer = new TileLayer(&#123;</span><br><span class="line">    source: new OSM(),</span><br><span class="line">  &#125;);</span><br><span class="line">  osmLayer.set(&#x27;name&#x27;, &#x27;OSM&#x27;);</span><br><span class="line">  // 加载天地图</span><br><span class="line">  const tileLayer = new TileLayer(&#123;</span><br><span class="line">    visible: true,</span><br><span class="line">    source: new XYZ(&#123; url: &#x27; http://wprd0 &#123;1-4&#125;.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;z=&#123;z&#125;&#x27; &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  tileLayer.set(&#x27;name&#x27;, &#x27;天地图&#x27;);</span><br><span class="line">  // 加载 WMS 服务</span><br><span class="line">  const imageLayer = new ImageLayer(&#123;</span><br><span class="line">    source: new ImageWMS(&#123;</span><br><span class="line">      url: &#x27; http://localhost:8080/geoserver/DTQ/wms &#x27;,</span><br><span class="line">      params: &#123; layers: &#x27;DTQ:D4DTQYC&#x27; &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  imageLayer.set(&#x27;name&#x27;, &#x27;D4DTQYC&#x27;);</span><br><span class="line"></span><br><span class="line">  // 加载 WFS 服务</span><br><span class="line">  const FeatureLayer = new VectorLayer(&#123;</span><br><span class="line">    source: new VectorSource(&#123;</span><br><span class="line">      url: &#x27; http://localhost:8080/geoserver/DTQ/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=DTQ%3AL4DTQDGX01&amp;maxFeatures=50&amp;outputFormat=application%2Fjson &#x27;,</span><br><span class="line">      format: new GeoJSON(),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  FeatureLayer.set(&#x27;name&#x27;, &#x27;L4DTQDGX01&#x27;);</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;,</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: [119.316, 32.13],</span><br><span class="line">      projection: &#x27;EPSG:4326&#x27;,</span><br><span class="line">      zoom: 13, // 默认缩放等级</span><br><span class="line">      maxZoom: 20, // 最大缩放等级</span><br><span class="line">      minZoom: 5, // 最小缩放等级</span><br><span class="line">    &#125;),</span><br><span class="line">    layers: [osmLayer, tileLayer, imageLayer, FeatureLayer],</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 获取 map 中图层</span><br><span class="line">  const allLayer = map.getAllLayers();</span><br><span class="line">  allLayer.forEach((e) =&gt; &#123;</span><br><span class="line">    layerList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">    checkList.value.push(e.get(&#x27;name&#x27;));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  right: 220px;</span><br><span class="line">  top: 20px;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5-MousePosition-位置控件"><a href="#5-MousePosition-位置控件" class="headerlink" title="5 MousePosition - 位置控件"></a>5 MousePosition - 位置控件</h2><blockquote>
<p>A control to show the 2D coordinates of the mouse cursor. By default, these are in the view projection, but can be in any supported projection. By default the control is shown in the top right corner of the map, but this can be changed by using the css selector <code>.ol-mouse-position</code>.</p>
<p>On touch devices, which usually do not have a mouse cursor, the coordinates of the currently touched position are shown.</p>
</blockquote>
<p><strong>注意</strong>：自定义挂载元素时 className = “<strong>custom</strong>-mouse-position”</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;mouse-position&quot;</span> ref=<span class="string">&quot;position&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="keyword">let</span> mousePosition = <span class="keyword">new</span> MousePosition(&#123;</span><br><span class="line">        <span class="attr">className</span>: <span class="string">&quot;custom-mouse-position&quot;</span>,</span><br><span class="line">        ...</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="5-1-Extends"><a href="#5-1-Extends" class="headerlink" title="5.1 Extends"></a>5.1 Extends</h3><ul>
<li>[Control]( <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html</a></li>
</ul>
<h3 id="5-2-new-MousePosition-options"><a href="#5-2-new-MousePosition-options" class="headerlink" title="5.2 new MousePosition(options)"></a>5.2 new MousePosition(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-mouse-position’)</td>
<td>CSS class name.</td>
</tr>
<tr>
<td><code>coordinateFormat</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat">CoordinateFormat</a> | undefined</td>
<td>Coordinate format.</td>
</tr>
<tr>
<td><code>projection</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_proj.html#~ProjectionLike">ProjectionLike</a> | undefined</td>
<td>Projection. Default is the view projection.</td>
</tr>
<tr>
<td><code>render</code></td>
<td>function | undefined</td>
<td>Function called when the control should be re-rendered. This is called in a <code>requestAnimationFrame</code> callback.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>placeholder</code></td>
<td>string | undefined</td>
<td>Markup to show when the mouse position is not available (e.g. when the pointer leaves the map viewport). By default, a non-breaking space is rendered initially and the last position is retained when the mouse leaves the viewport. When a string is provided (e.g. <code>&#39;no position&#39;</code> or <code>&#39;&#39;</code> for an empty string) it is used as a placeholder.</td>
</tr>
<tr>
<td><code>wrapX</code></td>
<td>boolean (defaults to true)</td>
<td>Wrap the world horizontally on the projection’s antimeridian, if it is a global projection.</td>
</tr>
</tbody></table>
<h3 id="5-3-Observable-Properties"><a href="#5-3-Observable-Properties" class="headerlink" title="5.3 Observable Properties"></a>5.3 Observable Properties</h3><p><strong>可观察属性即可以使用<code>change:属性字段</code></strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Settable</th>
<th><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a> type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>coordinateFormat</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat">CoordinateFormat</a> | undefined</td>
<td>yes</td>
<td><code>change:coordinateformat</code></td>
<td>The format to render the current position in.</td>
</tr>
<tr>
<td><code>projection</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_proj_Projection-Projection.html">Projection</a> | undefined</td>
<td>yes</td>
<td><code>change:projection</code></td>
<td>The projection to report mouse position in.</td>
</tr>
</tbody></table>
<h3 id="5-4-Fires"><a href="#5-4-Fires" class="headerlink" title="5.4 Fires"></a>5.4 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721719811685.png" alt="QQ_1721719811685.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721721551347.png" alt="QQ_1721721551347.png"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div id=<span class="string">&quot;map&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mouse-position&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;position&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> position = ref&lt;HTMLElement | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> mousePosition = <span class="keyword">new</span> MousePosition(&#123;</span><br><span class="line">    <span class="comment">//坐标格式</span></span><br><span class="line">    <span class="attr">coordinateFormat</span>: createStringXY(<span class="number">9</span>),</span><br><span class="line">    <span class="comment">//坐标的投影默认使用的是 view 视图的投影</span></span><br><span class="line">    <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span><br><span class="line">    <span class="comment">//坐标信息显示样式类名，默认是&#x27;ol-mouse-position&#x27;</span></span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;custom-mouse-position&#x27;</span>,</span><br><span class="line">    <span class="comment">//指定鼠标控件挂载的位置</span></span><br><span class="line">    <span class="attr">target</span>: position.value <span class="keyword">as</span> HTMLElement,</span><br><span class="line">    <span class="comment">//未定义坐标的标记</span></span><br><span class="line">    <span class="attr">placeholder</span>: <span class="string">&#x27;未识别鼠标位置&#x27;</span>,</span><br><span class="line">    <span class="comment">// 重新呈现控件时调用的函数</span></span><br><span class="line">    <span class="comment">// render: (MapEvent) =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//   console.log(MapEvent);</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(mousePosition);</span><br></pre></td></tr></table></figure>

<p><strong>其中createStringXY（）是格式化坐标的，让其精确到几位，更多格式化坐标函数见 <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_coordinate.html#~CoordinateFormat">CoordinateFormat</a></strong></p>
<p>eg:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createStringXY&#125; <span class="keyword">from</span> <span class="string">&#x27;ol/coordinate.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> coord = [<span class="number">7.85</span>, <span class="number">47.983333</span>];</span><br><span class="line"><span class="keyword">const</span> stringifyFunc = createStringXY(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">const</span> out = stringifyFunc(coord);</span><br><span class="line"><span class="comment">// out is now &#x27;7.85, 47.98&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-OverviewMap-鹰眼控件"><a href="#6-OverviewMap-鹰眼控件" class="headerlink" title="6 OverviewMap-鹰眼控件"></a>6 OverviewMap-鹰眼控件</h2><blockquote>
<p>创建一个新的控件，其中的地图可作为另一个定义地图的总览图。</p>
</blockquote>
<h3 id="6-1-Extends"><a href="#6-1-Extends" class="headerlink" title="6.1 Extends"></a>6.1 Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a></li>
</ul>
<h3 id="6-2-new-OverviewMap-options"><a href="#6-2-new-OverviewMap-options" class="headerlink" title="6.2 new OverviewMap(options)"></a>6.2 new OverviewMap(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-overviewmap’)</td>
<td>CSS class name.</td>
</tr>
<tr>
<td><code>collapsed</code></td>
<td>boolean (defaults to true)</td>
<td>Whether the control should start collapsed or not (expanded).</td>
</tr>
<tr>
<td><code>collapseLabel</code></td>
<td>string | HTMLElement (defaults to ‘‹’)</td>
<td>Text label to use for the expanded overviewmap button. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>collapsible</code></td>
<td>boolean (defaults to true)</td>
<td>Whether the control can be collapsed or not.</td>
</tr>
<tr>
<td><code>label</code></td>
<td>string | HTMLElement (defaults to ‘›’)</td>
<td>Text label to use for the collapsed overviewmap button. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>layers</code></td>
<td>Array&lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a> &gt; | <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Collection-Collection.html">Collection</a> &lt; <a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_layer_Base-BaseLayer.html">BaseLayer</a> &gt; | undefined</td>
<td>Layers for the overview map.</td>
</tr>
<tr>
<td><code>render</code></td>
<td>function | undefined</td>
<td>Function called when the control should be re-rendered. This is called in a <code>requestAnimationFrame</code> callback.</td>
</tr>
<tr>
<td><code>rotateWithView</code></td>
<td>boolean (defaults to false)</td>
<td>Whether the control view should rotate with the main map view.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>tipLabel</code></td>
<td>string (defaults to ‘Overview map’)</td>
<td>Text label to use for the button tip.</td>
</tr>
</tbody></table>
<p>| <code>view</code></p>
<pre><code>     | [View](https://openlayers.org/en/latest/apidoc/module-ol_View-View.html) \| undefined | Custom view for the overview map (should use same projection as main map). If not provided, a default view with the same projection as the main map will be used. |
</code></pre>
<h3 id="6-3-Fires"><a href="#6-3-Fires" class="headerlink" title="6.3 Fires"></a>6.3 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721721154634.png" alt="QQ_1721721154634.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721721528028.png" alt="QQ_1721721528028.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="keyword">const</span> overviewMap = <span class="keyword">new</span> OverviewMap(&#123;</span><br><span class="line">    <span class="comment">//鹰眼控件样式（默认为 ol-overviewmap）</span></span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;ol-overviewmap ol-custom-overviewmap&#x27;</span>,</span><br><span class="line">    <span class="attr">layers</span>: [</span><br><span class="line">      <span class="keyword">new</span> TileLayer(&#123;</span><br><span class="line">        <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">//当前的鹰眼图会跟随当前的视图旋转</span></span><br><span class="line">    <span class="attr">rotateWithView</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">collapseLabel</span>: <span class="string">&#x27;\u00BB&#x27;</span>,</span><br><span class="line">    <span class="comment">//鹰眼控件折叠时功能按钮上的标识</span></span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;\u00AB&#x27;</span>,</span><br><span class="line">    <span class="comment">//初始为展开显示方式</span></span><br><span class="line">    <span class="attr">collapsed</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">map.addControl(overviewMap);</span><br></pre></td></tr></table></figure>

<h2 id="7-FullScreen-全屏控件"><a href="#7-FullScreen-全屏控件" class="headerlink" title="7 FullScreen - 全屏控件"></a>7 FullScreen - 全屏控件</h2><h3 id="7-1-Extends"><a href="#7-1-Extends" class="headerlink" title="7.1 Extends"></a>7.1 Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a></li>
</ul>
<h3 id="7-2-new-FullScreen-options"><a href="#7-2-new-FullScreen-options" class="headerlink" title="7.2 new FullScreen(options)"></a>7.2 new FullScreen(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string (defaults to ‘ol-full-screen’)</td>
<td>CSS class name.</td>
</tr>
<tr>
<td><code>label</code></td>
<td>string | Text | HTMLElement (defaults to ‘\u2922’)</td>
<td>Text label to use for the button. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>labelActive</code></td>
<td>string | Text | HTMLElement (defaults to ‘\u00d7’)</td>
<td>Text label to use for the button when full-screen is active. Instead of text, also an element (e.g. a <code>span</code> element) can be used.</td>
</tr>
<tr>
<td><code>activeClassName</code></td>
<td>string (defaults to className + ‘-true’)</td>
<td>CSS class name for the button when full-screen is active.</td>
</tr>
<tr>
<td><code>inactiveClassName</code></td>
<td>string (defaults to className + ‘-false’)</td>
<td>CSS class name for the button when full-screen is inactive.</td>
</tr>
<tr>
<td><code>tipLabel</code></td>
<td>string (defaults to ‘Toggle full-screen’)</td>
<td>Text label to use for the button tip.</td>
</tr>
<tr>
<td><code>keys</code></td>
<td>boolean (defaults to false)</td>
<td>Full keyboard access.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>source</code></td>
<td>HTMLElement | string | undefined</td>
<td>The element to be displayed fullscreen. When not provided, the element containing the map viewport will be displayed fullscreen.</td>
</tr>
</tbody></table>
<h3 id="7-3-Fires"><a href="#7-3-Fires" class="headerlink" title="7.3 Fires"></a>7.3 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721722148792.png" alt="QQ_1721722148792.png"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fullScreen = <span class="keyword">new</span> FullScreen(&#123; <span class="attr">tipLabel</span>: <span class="string">&#x27;全屏&#x27;</span> &#125;);</span><br><span class="line">map.addControl(fullScreen);</span><br></pre></td></tr></table></figure>

<h2 id="8-测量控件"><a href="#8-测量控件" class="headerlink" title="8 测量控件"></a>8 测量控件</h2><h3 id="8-1-unByKey-key"><a href="#8-1-unByKey-key" class="headerlink" title="8.1 unByKey(key)"></a>8.1 unByKey(key)</h3><blockquote>
<p>Removes an event listener using the key returned by <code>on()</code> or <code>once()</code>.</p>
</blockquote>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724092408.png" alt="image.png"></p>
<p><strong>注意：map 不要用 ref 包</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;measureCtl(&#x27;Polygon&#x27;)&quot;</span>&gt;</span>面积<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;measureCtl(&#x27;LineString&#x27;)&quot;</span>&gt;</span>距离<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import Map from &#x27;ol/Map.js&#x27;;</span><br><span class="line">import View from &#x27;ol/View.js&#x27;;</span><br><span class="line">import &#123; Zoom, ZoomSlider, ZoomToExtent &#125; from &#x27;ol/control&#x27;;</span><br><span class="line">import TileLayer from &#x27;ol/layer/Tile.js&#x27;;</span><br><span class="line">import OSM from &#x27;ol/source/OSM.js&#x27;;</span><br><span class="line">import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; defaults as defaultControls &#125; from &#x27;ol/control.js&#x27;;</span><br><span class="line">import * as sphere from &#x27;ol/sphere&#x27;;</span><br><span class="line">import &#123; Circle, Geometry, LineString, Polygon &#125; from &#x27;ol/geom&#x27;;</span><br><span class="line">import Feature from &#x27;ol/Feature&#x27;;</span><br><span class="line">import &#123; MapBrowserEvent, Overlay &#125; from &#x27;ol&#x27;;</span><br><span class="line">import VectorLayer from &#x27;ol/layer/Vector&#x27;;</span><br><span class="line">import VectorSource from &#x27;ol/source/Vector&#x27;;</span><br><span class="line">import Style from &#x27;ol/style/Style&#x27;;</span><br><span class="line">import Fill from &#x27;ol/style/Fill&#x27;;</span><br><span class="line">import Stroke from &#x27;ol/style/Stroke&#x27;;</span><br><span class="line">import CircleStyle from &#x27;ol/style/Circle.js&#x27;;</span><br><span class="line">import Draw, &#123; DrawEvent &#125; from &#x27;ol/interaction/Draw.js&#x27;;</span><br><span class="line">import type &#123; Type &#125; from &#x27;ol/geom/Geometry&#x27;;</span><br><span class="line">import type &#123; EventsKey &#125; from &#x27;ol/events&#x27;;</span><br><span class="line">import &#123; unByKey &#125; from &#x27;ol/Observable&#x27;;</span><br><span class="line">import type &#123; Interaction &#125; from &#x27;ol/interaction&#x27;;</span><br><span class="line"></span><br><span class="line">let map: Map;</span><br><span class="line"></span><br><span class="line">let sketch: Feature | null; // 当前绘制的要素（Currently drawn feature.）</span><br><span class="line">let helpTooltipElement: HTMLElement; // 帮助提示框对象（The help tooltip element.）</span><br><span class="line">let helpTooltip: Overlay; // 帮助提示框显示的信息（Overlay to show the help messages.）</span><br><span class="line">let measureTooltipElement: HTMLElement | null; // 测量工具提示框对象（The measure tooltip element. ）</span><br><span class="line">let measureTooltip: Overlay; // 测量工具中显示的测量值（Overlay to show the measurement.）</span><br><span class="line">let continuePolygonMsg: string = &#x27;Click to continue drawing the polygon&#x27;; // 当用户正在绘制多边形时的提示信息文本</span><br><span class="line">let continueLineMsg: string = &#x27;Click to continue drawing the line&#x27;; // 当用户正在绘制线时的提示信息文本</span><br><span class="line">let listener: EventsKey | undefined; // 事件监听</span><br><span class="line">let draw: Draw; // 绘制交互</span><br><span class="line"></span><br><span class="line">// 测量长度输出</span><br><span class="line">const formatLength = (line: LineString) =&gt; &#123;</span><br><span class="line">  //使用测地学方法测量</span><br><span class="line">  const sourceProj = map.getView().getProjection(); //地图数据源投影坐标系</span><br><span class="line">  let length = sphere.getLength(line, &#123;</span><br><span class="line">    projection: sourceProj,</span><br><span class="line">    radius: 6378137, // 地球半径</span><br><span class="line">  &#125;);</span><br><span class="line">  let output;</span><br><span class="line">  if (length &gt; 100) &#123;</span><br><span class="line">    output = Math.round((length / 1000) * 100) / 100 + &#x27; &#x27; + &#x27;km&#x27;; //换算成 KM 单位</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    output = Math.round(length * 100) / 100 + &#x27; &#x27; + &#x27;m&#x27;; //m 为单位</span><br><span class="line">  &#125;</span><br><span class="line">  return output; //返回线的长度</span><br><span class="line">&#125;;</span><br><span class="line">// 测量面积输出</span><br><span class="line">const formatArea = (polygon: Polygon) =&gt; &#123;</span><br><span class="line">  //使用测地学方法测量</span><br><span class="line">  const sourceProj = map.getView().getProjection(); //地图数据源投影坐标系</span><br><span class="line">  let geom = polygon.clone().transform(sourceProj, &#x27;EPSG:4326&#x27;); //将多边形要素坐标系投影为 EPSG:4326</span><br><span class="line">  let area = Math.abs(sphere.getArea(geom, &#123; projection: sourceProj, radius: 6378137 &#125;)); //获取面积</span><br><span class="line">  let output;</span><br><span class="line">  if (area &gt; 10000) &#123;</span><br><span class="line">    output = Math.round((area / 1000000) * 100) / 100 + &#x27; &#x27; + &#x27;km&lt;sup&gt;2&lt;/sup&gt;&#x27;; //换算成 KM 单位</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    output = Math.round(area * 100) / 100 + &#x27; &#x27; + &#x27;m&lt;sup&gt;2&lt;/sup&gt;&#x27;; //m 为单位</span><br><span class="line">  &#125;</span><br><span class="line">  return output; //返回多边形的面积</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 创建一个新的帮助提示框（tooltip）- 未画之前的提示框</span><br><span class="line">const createHelpTooltip = () =&gt; &#123;</span><br><span class="line">  // 移除已有元素</span><br><span class="line">  if (helpTooltipElement) &#123;</span><br><span class="line">    helpTooltipElement.parentNode?.removeChild(helpTooltipElement);</span><br><span class="line">  &#125;</span><br><span class="line">  helpTooltipElement = document.createElement(&#x27;div&#x27;);</span><br><span class="line">  helpTooltipElement.className = &#x27;tooltip hidden&#x27;;</span><br><span class="line"></span><br><span class="line">  //提示框的覆盖层</span><br><span class="line">  helpTooltip = new Overlay(&#123;</span><br><span class="line">    element: helpTooltipElement,</span><br><span class="line">    offset: [15, 0],</span><br><span class="line">    positioning: &#x27;center-left&#x27;,</span><br><span class="line">  &#125;);</span><br><span class="line">  // 只是添加 Overlay 但是还没设置坐标 所以不会显示</span><br><span class="line">  map.addOverlay(helpTooltip);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 创建一个新的测量工具提示框（tooltip）- 画时的提示框</span><br><span class="line">const createMeasureTooltip = () =&gt; &#123;</span><br><span class="line">  // 移除已有元素</span><br><span class="line">  if (measureTooltipElement) &#123;</span><br><span class="line">    measureTooltipElement.parentNode?.removeChild(measureTooltipElement);</span><br><span class="line">  &#125;</span><br><span class="line">  measureTooltipElement = document.createElement(&#x27;div&#x27;);</span><br><span class="line">  measureTooltipElement.className = &#x27;tooltip tooltip-measure&#x27;;</span><br><span class="line">  //提示框的覆盖层</span><br><span class="line">  measureTooltip = new Overlay(&#123;</span><br><span class="line">    element: measureTooltipElement,</span><br><span class="line">    offset: [0, -15],</span><br><span class="line">    positioning: &#x27;bottom-center&#x27;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // 只是添加 Overlay 但是还没设置坐标 所以不会显示</span><br><span class="line">  map.addOverlay(measureTooltip);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 动态显示帮助提示框内容</span><br><span class="line">const pointerMoveHandler = (event: MapBrowserEvent&lt;any&gt;) =&gt; &#123;</span><br><span class="line">  // 指示地图当前是否正在被拖动 dragging&#123;boolean&#125;</span><br><span class="line">  if (event.dragging) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  //当前默认提示信息</span><br><span class="line">  let helpMsg = &#x27;Click to start drawing&#x27;;</span><br><span class="line">  //判断绘制几何类型设置相应的帮助提示信息</span><br><span class="line">  let geom = sketch?.getGeometry();</span><br><span class="line">  if (geom instanceof Polygon) &#123;</span><br><span class="line">    helpMsg = continuePolygonMsg; //绘制多边形时提示相应内容</span><br><span class="line">  &#125; else if (geom instanceof LineString) &#123;</span><br><span class="line">    helpMsg = continueLineMsg; //绘制线时提示相应内容</span><br><span class="line">  &#125;</span><br><span class="line">  helpTooltipElement.innerHTML = helpMsg; //将提示信息设置到对话框中显示</span><br><span class="line">  // helpTooltip 为 Overlay 对象</span><br><span class="line">  helpTooltip.setPosition(event.coordinate); //设置帮助提示框的位置</span><br><span class="line">  //$(helpTooltipElement).removeClass(&#x27;hidden&#x27;);//移除帮助提示框的隐藏样式进行显示</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 加载交互绘制控件函数</span><br><span class="line">const addMeasure = (measureType: Type, source: VectorSource&lt;Feature&lt;Geometry&gt;&gt;) =&gt; &#123;</span><br><span class="line">  draw = new Draw(&#123;</span><br><span class="line">    source: source, //测量绘制层数据源</span><br><span class="line">    type: measureType, //几何图形类型</span><br><span class="line">    style: new Style(&#123;</span><br><span class="line">      //绘制几何图形的样式</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;rgba(255, 255, 255, 0.8)&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27;rgba(0, 0, 0, 0.5)&#x27;,</span><br><span class="line">        lineDash: [10, 10],</span><br><span class="line">        width: 2,</span><br><span class="line">      &#125;),</span><br><span class="line">      image: new CircleStyle(&#123;</span><br><span class="line">        radius: 7,</span><br><span class="line">        fill: new Fill(&#123;</span><br><span class="line">          color: &#x27; #ffcc33 &#x27;,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  //将绘制交互事件添加到地图中</span><br><span class="line">  map.addInteraction(draw);</span><br><span class="line">  //创建测量工具提示框</span><br><span class="line">  createMeasureTooltip();</span><br><span class="line">  //创建帮助提示框</span><br><span class="line">  createHelpTooltip();</span><br><span class="line"></span><br><span class="line">  //绑定交互绘制工具开始绘制的事件</span><br><span class="line">  draw.on(&#x27;drawstart&#x27;, (event: DrawEvent) =&gt; &#123;</span><br><span class="line">    sketch = event.feature; //绘制的要素</span><br><span class="line">    let tooltipCoord = event.target.coordinate; // 绘制的坐标</span><br><span class="line">    //绑定 change 事件，根据绘制几何类型得到测量长度值或面积值，并将其设置到测量工具提示框中显示</span><br><span class="line">    listener = sketch?.getGeometry()?.on(&#x27;change&#x27;, (event) =&gt; &#123;</span><br><span class="line">      let geom = event.target; //绘制几何要素</span><br><span class="line">      let output;</span><br><span class="line">      if (geom instanceof Polygon) &#123;</span><br><span class="line">        output = formatArea(geom); // 面积值</span><br><span class="line">        //获取一个在几何体中内部的坐标点</span><br><span class="line">        tooltipCoord = geom.getInteriorPoint().getCoordinates(); //坐标</span><br><span class="line">      &#125; else if (geom instanceof LineString) &#123;</span><br><span class="line">        output = formatLength(geom); //长度值</span><br><span class="line">        //测量长度获取到线的最后一个坐标</span><br><span class="line">        tooltipCoord = geom.getLastCoordinate(); //坐标</span><br><span class="line">      &#125;</span><br><span class="line">      if (measureTooltipElement &amp;&amp; output) measureTooltipElement.innerHTML = output; //将测量值设置到测量工具提示框中显示</span><br><span class="line">      measureTooltip.setPosition(tooltipCoord); //设置测量工具提示框的显示位置</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  //绑定交互绘制工具结束绘制的事件</span><br><span class="line">  draw.on(&#x27;drawend&#x27;, (event: DrawEvent) =&gt; &#123;</span><br><span class="line">    if (measureTooltipElement) measureTooltipElement.className = &#x27;tooltip tooltip-static&#x27;; //设置测量提示框的样式</span><br><span class="line">    measureTooltip.setOffset([0, -7]);</span><br><span class="line">    sketch = null; // 置空当前绘制的要素对象</span><br><span class="line">    measureTooltipElement = null; // 置空测量工具提示框对象 - 画图时的提示框 然后在重新创建一个</span><br><span class="line">    createMeasureTooltip(); //重新创建一个测试工具提示框显示结果</span><br><span class="line">    if (listener) &#123;</span><br><span class="line">      unByKey(listener); // 解除监听事件 Removes an event listener using the key returned by on() or once().</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 按钮点击事件</span><br><span class="line">const measureCtl = (measureType: Type) =&gt; &#123;</span><br><span class="line">  if (draw) &#123;</span><br><span class="line">    map.removeInteraction(draw);</span><br><span class="line">  &#125;</span><br><span class="line">  //定义一个数据源 用来画线和面元素</span><br><span class="line">  const source = new VectorSource();</span><br><span class="line">  const vectorLayer = new VectorLayer(&#123;</span><br><span class="line">    source: source,</span><br><span class="line">    style: new Style(&#123;</span><br><span class="line">      fill: new Fill(&#123;</span><br><span class="line">        color: &#x27;rgba(255, 255, 255, 0.2)&#x27;,</span><br><span class="line">      &#125;),</span><br><span class="line">      stroke: new Stroke(&#123;</span><br><span class="line">        color: &#x27; #ffcc33 &#x27;,</span><br><span class="line">        width: 2,</span><br><span class="line">      &#125;),</span><br><span class="line">      image: new CircleStyle(&#123;</span><br><span class="line">        radius: 5,</span><br><span class="line">        stroke: new Stroke(&#123;</span><br><span class="line">          color: &#x27;rgba(0, 0, 0, 0.7)&#x27;,</span><br><span class="line">        &#125;),</span><br><span class="line">        fill: new Fill(&#123;</span><br><span class="line">          color: &#x27;rgba(255, 255, 255, 0.5)&#x27;,</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">  map.addLayer(vectorLayer);</span><br><span class="line"></span><br><span class="line">  //地图容器绑定鼠标移动事件，动态显示帮助提示框内容</span><br><span class="line">  map.on(&#x27;pointermove&#x27;, pointerMoveHandler);</span><br><span class="line"></span><br><span class="line">  //根据不同类型添加绘制的交互</span><br><span class="line">  addMeasure(measureType, source);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  map = new Map(&#123;</span><br><span class="line">    target: &#x27;map&#x27;, //指定挂载 dom，注意必须是 id</span><br><span class="line">    layers: [</span><br><span class="line">      new TileLayer(&#123;</span><br><span class="line">        source: new OSM(), //加载 OpenStreetMap</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">    //配置视图</span><br><span class="line">    view: new View(&#123;</span><br><span class="line">      center: [113.24981689453125, 23.126468438108688], //视图中心位置</span><br><span class="line">      projection: &#x27;EPSG:4326&#x27;, //指定投影</span><br><span class="line">      zoom: 12, //缩放到的级别</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">#map &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.MapTool &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 0.5em;</span><br><span class="line">  right: 0.5em;</span><br><span class="line">  z-index: 9999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 提示框的样式信息</span><br><span class="line">*/</span><br><span class="line">#map :deep(.tooltip) &#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  background: rgba(0, 0, 0, 0.5);</span><br><span class="line">  border-radius: 4px;</span><br><span class="line">  color: white;</span><br><span class="line">  padding: 4px 8px;</span><br><span class="line">  opacity: 0.7;</span><br><span class="line">  white-space: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 正在测的数字 */</span><br><span class="line">#map :deep(.tooltip-measure) &#123;</span><br><span class="line">  opacity: 1;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 已经测的结果 */</span><br><span class="line">#map :deep(.tooltip-static) &#123;</span><br><span class="line">  background-color: #ffcc33 ;</span><br><span class="line">  color: black;</span><br><span class="line">  border: 1px solid white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#map :deep(.tooltip-measure:before) #map :deep(.tooltip-static:before) &#123;</span><br><span class="line">  border-top: 6px solid rgba(0, 0, 0, 0.5);</span><br><span class="line">  border-right: 6px solid transparent;</span><br><span class="line">  border-left: 6px solid transparent;</span><br><span class="line">  content: &#x27;&#x27;;</span><br><span class="line">  position: absolute;</span><br><span class="line">  bottom: -6px;</span><br><span class="line">  margin-left: -7px;</span><br><span class="line">  left: 50%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#map :deep(.tooltip-static:before) &#123;</span><br><span class="line">  border-top-color: #ffcc33 ;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="9-动画控件"><a href="#9-动画控件" class="headerlink" title="9 动画控件"></a>9 动画控件</h2><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786658806.png" alt="QQ_1721786658806.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;MapTool&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;rotateLocation&quot;</span>&gt;</span>旋转定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;elasticLocation&quot;</span>&gt;</span>弹性定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;reboundLocation&quot;</span>&gt;</span>反弹定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;warning&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;flyLocation&quot;</span>&gt;</span>飞行定位<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;aroundRotate&quot;</span>&gt;</span>围绕旋转<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Zoom, ZoomSlider, ZoomToExtent &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; defaults <span class="keyword">as</span> defaultControls &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type MapEvent <span class="keyword">from</span> <span class="string">&#x27;ol/MapEvent&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; fromLonLat &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/proj&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; easeIn, easeOut &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/easing&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">//注意参考系</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> beijing = fromLonLat([<span class="number">116.3898468017578</span>, <span class="number">39.91026292816486</span>], <span class="string">&#x27;EPSG:4326&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> guangzhou = fromLonLat([<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>], <span class="string">&#x27;EPSG:4326&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 旋转定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> rotateLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> center = view.getCenter();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">if</span> (center) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//动画结束时的视图中心,即当前视图中心同目标视图中心连线的中心点</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">center</span>: [center[<span class="number">0</span>], center[<span class="number">1</span>]],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">rotation</span>: <span class="built_in">Math</span>.PI, <span class="comment">//动画结束时的旋转角度，即180度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">easing</span>: easeIn, <span class="comment">//按每一帧动画控制的动画速度，即开始缓慢并逐渐加快速度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">center</span>: beijing, <span class="comment">//动画结束时的视图中心</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">rotation</span>: <span class="number">2</span> * <span class="built_in">Math</span>.PI, <span class="comment">//动画结束时的旋转角度，即360度回正</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">easing</span>: easeOut, <span class="comment">//按每一帧动画控制的动画速度，即开始快速并逐渐减速</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 弹性定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> elasticLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 弹性伸缩值</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="keyword">function</span> <span class="title">elastic</span>(<span class="params">t: number</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//函数-10*sin(t-0.075)**t*t+1</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">return</span> <span class="built_in">Math</span>.pow(<span class="number">2</span>, -<span class="number">10</span> * t) * <span class="built_in">Math</span>.sin(((t - <span class="number">0.075</span>) * (<span class="number">2</span> * <span class="built_in">Math</span>.PI)) / <span class="number">0.3</span>) + <span class="number">1</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> center = view.getCenter();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">if</span> (center) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: beijing, <span class="comment">///动画结束时的视图中心</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">duration</span>: <span class="number">3000</span>, <span class="comment">//动画的持续时间（以毫秒为单位）</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">easing</span>: elastic, <span class="comment">//按每一帧动画控制的动画持续时间函数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 反弹定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> reboundLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 反弹值</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="keyword">function</span> <span class="title">bounce</span>(<span class="params">t: number</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">var</span> s = <span class="number">7.5625</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      p = <span class="number">2.75</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      l;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (t &lt; <span class="number">1</span> / p) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      l = s * t * t;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">if</span> (t &lt; <span class="number">2</span> / p) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        t -= <span class="number">1.5</span> / p;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        l = s * t * t + <span class="number">0.75</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">if</span> (t &lt; <span class="number">2.5</span> / p) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          t -= <span class="number">2.25</span> / p;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          l = s * t * t + <span class="number">0.9375</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          t -= <span class="number">2.625</span> / p;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">          l = s * t * t + <span class="number">0.984375</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">return</span> l;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  view.animate(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">center</span>: guangzhou, <span class="comment">///动画结束时的视图中心</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">duration</span>: <span class="number">3000</span>, <span class="comment">//动画的持续时间（以毫秒为单位）</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">easing</span>: bounce, <span class="comment">//按每一帧动画控制的动画持续时间函数)</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 飞行定位</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> flyLocation = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> zoom = view.getZoom();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> duration = <span class="number">3000</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">//动画完成的回调函数</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">complete: boolean</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (complete) <span class="built_in">console</span>.log(<span class="string">&#x27;动画完成&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">if</span> (zoom) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第一个动画</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">center</span>: guangzhou,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">duration</span>: duration,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      callback,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第二个动画</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">zoom</span>: zoom - <span class="number">1</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">duration</span>: duration / <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">zoom</span>: zoom,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">duration</span>: duration / <span class="number">2</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      callback,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="comment">// 围绕旋转</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> aroundRotate = <span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> view = map.getView();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">var</span> rotation = view.getRotation();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  view.animate(</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第一个过程</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">rotation</span>: rotation + <span class="built_in">Math</span>.PI, <span class="comment">//第一次动画旋转角度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">anchor</span>: guangzhou, <span class="comment">//自旋的中心点</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">easing</span>: easeIn, <span class="comment">////按每一帧动画控制的动画速度，即开始缓慢并逐渐加快速度</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">//第二个过程</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">rotation</span>: rotation + <span class="number">2</span> * <span class="built_in">Math</span>.PI, <span class="comment">//动画结束时的旋转角度，即360度回正</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">anchor</span>: guangzhou, <span class="comment">// 旋转中心点</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">easing</span>: easeOut, <span class="comment">///按每一帧动画控制的动画速度，即开始快速并逐渐减速</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  );</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>], <span class="comment">//视图中心位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">12</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    ],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-class">.MapTool</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">top</span>: <span class="number">0.5em</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">right</span>: <span class="number">0.5em</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="10-ScaleLine-比例尺控件"><a href="#10-ScaleLine-比例尺控件" class="headerlink" title="10 ScaleLine - 比例尺控件"></a>10 ScaleLine - 比例尺控件</h2><blockquote>
<p> By default the scale line will show in the bottom left portion of the map, but this can be changed by using the css selector <code>.ol-scale-line</code>. When specifying <code>bar</code> as <code>true</code>, a scalebar will be rendered instead of a scaleline. For cartesian measurements of the scaleline, you need to set the <code>getPointResolution</code> method of your projection to simply return the input value, e.g. <code>projection.setGetPointResolution(r =&gt; r);</code></p>
</blockquote>
<h3 id="10-1-Extends"><a href="#10-1-Extends" class="headerlink" title="10.1 Extends"></a>10.1 Extends</h3><ul>
<li><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_Control-Control.html">Control</a></li>
</ul>
<h3 id="10-2-Observable-Properties"><a href="#10-2-Observable-Properties" class="headerlink" title="10.2 Observable Properties"></a>10.2 Observable Properties</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Settable</th>
<th><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_Object.ObjectEvent.html">ObjectEvent</a> type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>units</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ScaleLine.html#~Units">Units</a></td>
<td>yes</td>
<td><code>change:units</code></td>
<td>The units to use in the scale line.</td>
</tr>
</tbody></table>
<h3 id="10-3-new-ScaleLine-options"><a href="#10-3-new-ScaleLine-options" class="headerlink" title="10.3 new ScaleLine(options)"></a>10.3 new ScaleLine(options)</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>className</code></td>
<td>string | undefined</td>
<td>CSS class name. The default is <code>ol-scale-bar</code> when configured with <code>bar: true</code>. Otherwise the default is <code>ol-scale-line</code>.</td>
</tr>
<tr>
<td><code>minWidth</code></td>
<td>number (defaults to 64)</td>
<td>Minimum width in pixels at the OGC default dpi. The width will be adjusted to match the dpi used.</td>
</tr>
<tr>
<td><code>maxWidth</code></td>
<td>number | undefined</td>
<td>Maximum width in pixels at the OGC default dpi. The width will be adjusted to match the dpi used.</td>
</tr>
<tr>
<td><code>render</code></td>
<td>function | undefined</td>
<td>Function called when the control should be re-rendered. This is called in a <code>requestAnimationFrame</code> callback.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>HTMLElement | string | undefined</td>
<td>Specify a target if you want the control to be rendered outside of the map’s viewport.</td>
</tr>
<tr>
<td><code>units</code></td>
<td><a target="_blank" rel="noopener" href="https://openlayers.org/en/latest/apidoc/module-ol_control_ScaleLine.html#~Units">Units</a> (defaults to ‘metric’)</td>
<td>Units.</td>
</tr>
<tr>
<td><code>bar</code></td>
<td>boolean (defaults to false)</td>
<td>Render scalebars instead of a line.</td>
</tr>
<tr>
<td><code>steps</code></td>
<td>number (defaults to 4)</td>
<td>Number of steps the scalebar should use. Use even numbers for best results. Only applies when <code>bar</code> is <code>true</code>.</td>
</tr>
<tr>
<td><code>text</code></td>
<td>boolean (defaults to false)</td>
<td>Render the text scale above of the scalebar. Only applies when <code>bar</code> is <code>true</code>.</td>
</tr>
<tr>
<td><code>dpi</code></td>
<td>number | undefined</td>
<td>dpi of output device such as printer. Only applies when <code>bar</code> is <code>true</code>. If undefined the OGC default screen pixel size of 0.28mm will be assumed.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="10-4-Fires"><a href="#10-4-Fires" class="headerlink" title="10.4 Fires"></a>10.4 Fires</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20240724091945.png" alt="image.png"></p>
<p><code>bar:true</code>时</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786686345.png" alt="QQ_1721786686345.png"></p>
<p><code>bar:false</code>时</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786717387.png" alt="QQ_1721786717387.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加比例尺控件</span></span><br><span class="line"><span class="keyword">const</span> addScaleLineCtl = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> scaleLineControl = <span class="keyword">new</span> ScaleLine(&#123;</span><br><span class="line">    <span class="comment">//设置比例尺单位，degrees、imperial、us、nautical、metric（度量单位）</span></span><br><span class="line">    <span class="attr">units</span>: <span class="string">&#x27;metric&#x27;</span>,</span><br><span class="line">    <span class="attr">bar</span>: <span class="literal">true</span>, <span class="comment">// 渲染比例尺而不是一条线</span></span><br><span class="line">    <span class="attr">text</span>: <span class="literal">true</span>, <span class="comment">// 渲染比例尺上方的文本比例。仅适用于 bar is true</span></span><br><span class="line">  &#125;);</span><br><span class="line">  map.addControl(scaleLineControl);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="11-图层探索"><a href="#11-图层探索" class="headerlink" title="11 图层探索"></a>11 图层探索</h2><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1721786327484.png" alt="QQ_1721786327484.png"></p>
<p><code>let ctx = event.context;</code>是获取 canvas 画布</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;mapDom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> <span class="built_in">Map</span> <span class="keyword">from</span> <span class="string">&#x27;ol/Map.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> View <span class="keyword">from</span> <span class="string">&#x27;ol/View.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; Zoom, ZoomSlider, ZoomToExtent &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> TileLayer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Tile.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> OSM <span class="keyword">from</span> <span class="string">&#x27;ol/source/OSM.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; defaults <span class="keyword">as</span> defaultControls &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/control.js&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type MapEvent <span class="keyword">from</span> <span class="string">&#x27;ol/MapEvent&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> &#123; XYZ &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/source&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type Layer <span class="keyword">from</span> <span class="string">&#x27;ol/layer/Layer&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type &#123; Pixel &#125; <span class="keyword">from</span> <span class="string">&#x27;ol/pixel&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">import</span> type RenderEvent <span class="keyword">from</span> <span class="string">&#x27;ol/render/Event&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">let</span> map: <span class="built_in">Map</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> mapDom = ref&lt;HTMLElement | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="keyword">const</span> addLayerSearch = <span class="function">(<span class="params">layer: Layer</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 探查半径</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> radius = <span class="number">75</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 添加键盘按下事件监听，用来控制探查范围的大小</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="built_in">document</span>.addEventListener(<span class="string">&#x27;keydown&#x27;</span>, <span class="function">(<span class="params">event: KeyboardEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (event.keyCode === <span class="number">38</span>) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      radius = <span class="built_in">Math</span>.min(radius + <span class="number">5</span>, <span class="number">150</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">// 不会触发点击事件 - click, singleclick, doubleclick</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      event.preventDefault();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (event.keyCode == <span class="number">40</span>) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      radius = <span class="built_in">Math</span>.max(radius - <span class="number">5</span>, <span class="number">25</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      event.preventDefault();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 实时得到鼠标的像素位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">let</span> mousePosition: Pixel;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  mapDom.value?.addEventListener(<span class="string">&#x27;mousemove&#x27;</span>, <span class="function">(<span class="params">event: MouseEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取到地图鼠标的位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    mousePosition = map.getEventPixel(event);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 鼠标移动时强制渲染地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  mapDom.value?.addEventListener(<span class="string">&#x27;mouseout&#x27;</span>, <span class="function">(<span class="params">event: MouseEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取到地图鼠标的位置</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    mousePosition = map.getEventPixel(event);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 鼠标移出 map 就强制渲染</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    map.render();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 在渲染层之前,做剪裁</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  layer.on(<span class="string">&#x27;prerender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取 canvas 画布</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> ctx = event.context;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="comment">// 获取屏幕的像素比</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> pixelRatio = event?.frameState?.pixelRatio;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (ctx <span class="keyword">instanceof</span> CanvasRenderingContext2D &amp;&amp; pixelRatio) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      ctx.save();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      ctx.beginPath();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="keyword">if</span> (mousePosition) &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">//只显示一个围绕着鼠标的圆圈</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.arc(mousePosition[<span class="number">0</span>] * pixelRatio, mousePosition[<span class="number">1</span>] * pixelRatio, radius * pixelRatio, <span class="number">0</span>, <span class="number">2</span> * <span class="built_in">Math</span>.PI);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.lineWidth = <span class="number">5</span> * pixelRatio;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.strokeStyle = <span class="string">&#x27;rgba(0,0,0,0.5)&#x27;</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ctx.stroke();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="comment">//图层的其他地方通过 canvas 的上下文对象裁剪掉，只保留绘制的圆形的部分</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">      ctx.clip();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 呈现层后,恢复画布的背景</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  layer.on(<span class="string">&#x27;postrender&#x27;</span>, <span class="function">(<span class="params">event: RenderEvent</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">let</span> ctx = event.context;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">if</span> (ctx <span class="keyword">instanceof</span> CanvasRenderingContext2D) ctx.restore();</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">onMounted(<span class="function">() =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 加载 OSM</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> osmLayer = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> OSM(),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="comment">// 加载天地图</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">  <span class="keyword">const</span> tileLayer = <span class="keyword">new</span> TileLayer(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">visible</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">source</span>: <span class="keyword">new</span> XYZ(&#123; <span class="attr">url</span>: <span class="string">&#x27; http://wprd0 &#123;1-4&#125;.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x=&#123;x&#125;&amp;y=&#123;y&#125;&amp;z=&#123;z&#125;&#x27;</span> &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  map = <span class="keyword">new</span> <span class="built_in">Map</span>(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">target</span>: <span class="string">&#x27;map&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">view</span>: <span class="keyword">new</span> View(&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">center</span>: [<span class="number">113.24981689453125</span>, <span class="number">23.126468438108688</span>],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">projection</span>: <span class="string">&#x27;EPSG:4326&#x27;</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">      <span class="attr">zoom</span>: <span class="number">12</span>,</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;),</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="attr">layers</span>: [tileLayer, osmLayer],</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  &#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">  addLayerSearch(osmLayer);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;);</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml"><span class="selector-id">#map</span> &#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Scenery</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://vernalscenery.github.io/2024/07/26/02%20openLayer_Control%20%E6%8E%A7%E4%BB%B6/">https://vernalscenery.github.io/2024/07/26/02%20openLayer_Control%20%E6%8E%A7%E4%BB%B6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://VernalScenery.github.io" target="_blank">春和景明的记事本</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/openLayer/">openLayer</a><a class="post-meta__tags" href="/tags/WebGIS/">WebGIS</a></div><div class="post_share"><div class="social-share" data-image="/./img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/26/03%20openLayer_Layer%20+%20Source%20%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE/"><img class="prev-cover" src="/./img/1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">03 openLayer_Layer + Source 各种数据</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/26/01%20openLayer_%E5%85%A5%E9%97%A8/"><img class="next-cover" src="/./img/1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">01 openLayer_入门</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/07/26/01%20openLayer_%E5%85%A5%E9%97%A8/" title="01 openLayer_入门"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">01 openLayer_入门</div></div></a></div><div><a href="/2024/07/26/03%20openLayer_Layer%20+%20Source%20%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE/" title="03 openLayer_Layer + Source 各种数据"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">03 openLayer_Layer + Source 各种数据</div></div></a></div><div><a href="/2024/07/26/05%20openlayers_OGC%20%E6%9C%8D%E5%8A%A1/" title="05 openlayers_OGC 服务"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">05 openlayers_OGC 服务</div></div></a></div><div><a href="/2024/07/27/06%20openlayers_OGC%20%E8%BF%87%E6%BB%A4%E5%99%A8/" title="06 openlayers_OGC 过滤器"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-27</div><div class="title">06 openlayers_OGC 过滤器</div></div></a></div><div><a href="/2024/07/27/07%20openlayers_style%20%E6%A0%B7%E5%BC%8F%E9%85%8D%E7%BD%AE/" title="07 openlayers_style 样式配置"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-27</div><div class="title">07 openlayers_style 样式配置</div></div></a></div><div><a href="/2024/07/29/08%20openLayer_Proj4%20%E6%8A%95%E5%BD%B1%E8%BD%AC%E6%8D%A2/" title="08 openLayer_Proj4 投影转换"><img class="cover" src="/./img/1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-29</div><div class="title">08 openLayer_Proj4 投影转换</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Scenery</div><div class="author-info__description">今天不想跑，所以才去跑</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">37</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/chjm0121" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1595718686@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Control-%E7%88%B6%E7%B1%BB"><span class="toc-text">1 Control - 父类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Extends"><span class="toc-text">1.1 Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Subclasses"><span class="toc-text">1.2 Subclasses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-new-control-option"><span class="toc-text">1.3 new control(option)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-Fires"><span class="toc-text">1.4 Fires</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-Methods"><span class="toc-text">1.5 Methods</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Zoom-%E5%AF%BC%E8%88%AA%E6%8E%A7%E4%BB%B6"><span class="toc-text">2 Zoom - 导航控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Zoom"><span class="toc-text">2.1 Zoom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-ZoomSlider"><span class="toc-text">2.2 ZoomSlider</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-ZoomToExtent"><span class="toc-text">2.3 ZoomToExtent</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%9F%BA%E7%A1%80%E6%8E%A7%E4%BB%B6%E5%AE%9E%E7%8E%B0"><span class="toc-text">3 基础控件实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%9B%BE%E5%B1%82%E9%80%89%E6%8B%A9%E5%AE%9E%E7%8E%B0"><span class="toc-text">4 图层选择实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-MousePosition-%E4%BD%8D%E7%BD%AE%E6%8E%A7%E4%BB%B6"><span class="toc-text">5 MousePosition - 位置控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-Extends"><span class="toc-text">5.1 Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-new-MousePosition-options"><span class="toc-text">5.2 new MousePosition(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Observable-Properties"><span class="toc-text">5.3 Observable Properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-Fires"><span class="toc-text">5.4 Fires</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-OverviewMap-%E9%B9%B0%E7%9C%BC%E6%8E%A7%E4%BB%B6"><span class="toc-text">6 OverviewMap-鹰眼控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Extends"><span class="toc-text">6.1 Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-new-OverviewMap-options"><span class="toc-text">6.2 new OverviewMap(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-Fires"><span class="toc-text">6.3 Fires</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-FullScreen-%E5%85%A8%E5%B1%8F%E6%8E%A7%E4%BB%B6"><span class="toc-text">7 FullScreen - 全屏控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-Extends"><span class="toc-text">7.1 Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-new-FullScreen-options"><span class="toc-text">7.2 new FullScreen(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-Fires"><span class="toc-text">7.3 Fires</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E6%B5%8B%E9%87%8F%E6%8E%A7%E4%BB%B6"><span class="toc-text">8 测量控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-unByKey-key"><span class="toc-text">8.1 unByKey(key)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E5%8A%A8%E7%94%BB%E6%8E%A7%E4%BB%B6"><span class="toc-text">9 动画控件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-ScaleLine-%E6%AF%94%E4%BE%8B%E5%B0%BA%E6%8E%A7%E4%BB%B6"><span class="toc-text">10 ScaleLine - 比例尺控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-Extends"><span class="toc-text">10.1 Extends</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-Observable-Properties"><span class="toc-text">10.2 Observable Properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-new-ScaleLine-options"><span class="toc-text">10.3 new ScaleLine(options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-Fires"><span class="toc-text">10.4 Fires</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E5%9B%BE%E5%B1%82%E6%8E%A2%E7%B4%A2"><span class="toc-text">11 图层探索</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/07/13_ThreeJS_%E5%B0%84%E7%BA%BF%E6%8B%BE%E5%8F%96%E6%A8%A1%E5%9E%8B/" title="13_ThreeJS_射线拾取模型">13_ThreeJS_射线拾取模型</a><time datetime="2024-11-06T23:24:26.000Z" title="发表于 2024-11-07 07:24:26">2024-11-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/07/12_ThreeJS_%E5%90%8E%E5%A4%84%E7%90%86EffectComposer/" title="11_ThreeJS_后处理EffectComposer">11_ThreeJS_后处理EffectComposer</a><time datetime="2024-11-06T20:52:32.000Z" title="发表于 2024-11-07 04:52:32">2024-11-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/05/11_ThreeJS_%E5%85%89%E6%BA%90%E5%92%8C%E9%98%B4%E5%BD%B1/" title="11_ThreeJS_光源和阴影">11_ThreeJS_光源和阴影</a><time datetime="2024-11-04T21:41:29.000Z" title="发表于 2024-11-05 05:41:29">2024-11-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/24/10_ThreeJS_%E7%9B%B8%E6%9C%BA%E5%9F%BA%E7%A1%80/" title="10_ThreeJS_相机基础">10_ThreeJS_相机基础</a><time datetime="2024-09-24T00:18:54.000Z" title="发表于 2024-09-24 08:18:54">2024-09-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/12/02_ThreeJS_%E5%90%84%E7%A7%8D%E6%A8%A1%E5%9E%8B/" title="02_ThreeJS_各种模型">02_ThreeJS_各种模型</a><time datetime="2024-09-12T01:54:38.000Z" title="发表于 2024-09-12 09:54:38">2024-09-12</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./img/1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Scenery</div><div class="footer_custom_text"><div>波澜不惊</div><div class="footer-div"><img class="footer-icon" src="./img/备案图标.png"><a class="footer-a" target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">皖ICP备2021016944号-1</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>
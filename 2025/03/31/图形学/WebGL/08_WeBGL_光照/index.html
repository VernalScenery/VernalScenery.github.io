<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>08_WeBGL_光照 | 春和景明的记事本</title><meta name="author" content="Scenery"><meta name="copyright" content="Scenery"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1 概览在现实世界中，当光线照射到物体上时，发生了两个重要的现象：  根据光源和光线方向，物体不同表面的明暗程度变得不一致。 根据光源和光线方向，物体向地面投下了影子。  1.1 冯氏光照模型 环境光 (Ambient) 漫反射 (Diffuse)  平行光 点光源   镜面高光 (Specular"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://vernalscenery.github.io/2025/03/31/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/08_WeBGL_%E5%85%89%E7%85%A7/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '08_WeBGL_光照',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-05 14:17:15'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/1.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="春和景明的记事本"><span class="site-name">春和景明的记事本</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">08_WeBGL_光照</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-30T23:14:29.000Z" title="发表于 2025-03-31 07:14:29">2025-03-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-05T06:17:15.000Z" title="更新于 2025-08-05 14:17:15">2025-08-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>13分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="08_WeBGL_光照"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-概览"><a href="#1-概览" class="headerlink" title="1 概览"></a>1 概览</h2><p>在现实世界中，当光线照射到物体上时，发生了两个重要的现象：</p>
<ul>
<li>根据光源和光线方向，物体不同表面的<strong>明暗程度</strong>变得不一致。</li>
<li>根据光源和光线方向，物体向地面投下了<strong>影子</strong>。</li>
</ul>
<h3 id="1-1-冯氏光照模型"><a href="#1-1-冯氏光照模型" class="headerlink" title="1.1 冯氏光照模型"></a>1.1 冯氏光照模型</h3><ul>
<li>环境光 (Ambient)</li>
<li>漫反射 (Diffuse) <ul>
<li>平行光</li>
<li>点光源</li>
</ul>
</li>
<li>镜面高光 (Specular)</li>
</ul>
<table>
<thead>
<tr>
<th>光照分量</th>
<th>作用</th>
<th>计算方式</th>
<th>影响因素</th>
</tr>
</thead>
<tbody><tr>
<td><strong>环境光 (Ambient)</strong></td>
<td>模拟无直接光照时的亮度，例如夜晚或阴天</td>
<td><code>环境光 = 环境光强度 * 物体颜色</code></td>
<td>环境光强度、物体颜色</td>
</tr>
<tr>
<td><strong>漫反射 (Diffuse)</strong></td>
<td>模拟平行光照射下，表面正对光源时更亮，背对时更暗</td>
<td><code>漫反射光 = 光源颜色 * 物体颜色 * max(0, N·L)</code></td>
<td>光源方向、法线方向、光源颜色</td>
</tr>
<tr>
<td><strong>镜面高光 (Specular)</strong></td>
<td>模拟光滑表面上的高光反射，光源颜色影响明显</td>
<td><code>镜面光 = 光源颜色 * (R·V)^n</code></td>
<td>视角方向、法线方向、反射角、光滑度 (n)</td>
</tr>
</tbody></table>
<h3 id="1-2-反射类型"><a href="#1-2-反射类型" class="headerlink" title="1.2 反射类型"></a>1.2 反射类型</h3><table>
<thead>
<tr>
<th><strong>类型</strong></th>
<th><strong>作用</strong></th>
<th><strong>特点</strong></th>
<th><strong>计算方式</strong></th>
<th><strong>影响因素</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>环境反射 (Ambient)</strong></td>
<td>模拟间接光照，让物体在无光源直射时仍然可见</td>
<td>均匀分布，无方向性，不受光源方向影响</td>
<td><code>环境光 = 环境光强度 * 物体颜色</code></td>
<td>环境光强度、物体颜色</td>
</tr>
<tr>
<td><strong>漫反射 (Diffuse)</strong></td>
<td>模拟物体表面对光的均匀反射，使其表面具有立体感</td>
<td>受光源方向影响，但与视角无关</td>
<td><code>漫反射光 = 光源颜色 * 物体颜色 * max(0, N·L)</code></td>
<td>法线方向、光源方向、光源颜色</td>
</tr>
<tr>
<td><strong>高光反射 (Specular)</strong></td>
<td>模拟光滑表面上的镜面反射，产生高光效果</td>
<td>受光源方向和观察方向影响，光滑度决定高光大小</td>
<td><code>镜面光 = 光源颜色 * (R·V)^n</code></td>
<td>观察方向、法线方向、光滑度 (n)</td>
</tr>
</tbody></table>
<p><span style="color: #badc58; font-weight: 550;">关键区别</span></p>
<ol>
<li><strong>环境反射</strong>：无方向性，物体在阴影处仍然可见，整体增加亮度。</li>
<li><strong>漫反射</strong>：由物体表面均匀反射光线，形成明暗过渡，<strong>与光源角度有关，但与视角无关</strong>。</li>
<li><strong>高光反射</strong>：模拟镜面反射，光滑表面上出现强烈的高光斑点，<strong>受观察角度影响</strong>。</li>
</ol>
<h2 id="2-环境光"><a href="#2-环境光" class="headerlink" title="2 环境光"></a>2 环境光</h2><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401083120.png" alt="image.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401083126.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 顶点着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">VERTEX_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  uniform mat4 u_MvpMatrix;</span></span><br><span class="line"><span class="string">  attribute vec3 a_Position;</span></span><br><span class="line"><span class="string">  attribute vec4 a_Color;</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    gl_Position = u_MvpMatrix * vec4(a_Position, 1);</span></span><br><span class="line"><span class="string">    v_Color = a_Color;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="comment">// 片元着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FRAGMENT_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  precision mediump float;</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // 光源颜色</span></span><br><span class="line"><span class="string">  uniform vec3 u_LightColor;</span></span><br><span class="line"><span class="string">  // 环境光强度因子</span></span><br><span class="line"><span class="string">  uniform float u_AmbientFactor;</span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    vec3 ambientColor = u_AmbientFactor * u_LightColor;</span></span><br><span class="line"><span class="string">    gl_FragColor = vec4(ambientColor, 1) * v_Color;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> light = &#123;</span><br><span class="line">  <span class="attr">ambientFactor</span>: <span class="number">0.5</span>,</span><br><span class="line">  <span class="attr">color</span>: [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">&#125;</span><br><span class="line">gl.<span class="title function_">uniform1f</span>(u_AmbientFactor, light.<span class="property">ambientFactor</span>)</span><br><span class="line">gl.<span class="title function_">uniform3f</span>(u_LightColor, light.<span class="property">color</span>[<span class="number">0</span>], light.<span class="property">color</span>[<span class="number">1</span>], light.<span class="property">color</span>[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<h2 id="3-法线"><a href="#3-法线" class="headerlink" title="3 法线"></a>3 法线</h2><p>法线是指垂直于某个表面的方向向量，通常用于计算光照、反射、折射等效果。在计算机图形学中，法线用于确定物体表面的方向，从而影响光照计算。</p>
<h3 id="3-1-计算方法"><a href="#3-1-计算方法" class="headerlink" title="3.1 计算方法"></a>3.1 计算方法</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401085948.png" alt="image.png|625"></p>
<h3 id="3-2-特点"><a href="#3-2-特点" class="headerlink" title="3.2 特点"></a>3.2 特点</h3><ul>
<li>一个表面具有两个法向量</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401085429.png" alt="image.png"></p>
<ul>
<li>平面的法向量唯一</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401085403.png" alt="image.png"></p>
<h3 id="3-3-分类"><a href="#3-3-分类" class="headerlink" title="3.3 分类"></a>3.3 分类</h3><table>
<thead>
<tr>
<th><strong>类型</strong></th>
<th><strong>定义</strong></th>
<th><strong>计算方式</strong></th>
<th><strong>特点</strong></th>
<th><strong>适用场景</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>平面法线 (Face Normal)</strong></td>
<td>一个三角形（或平面）的法向量，表示整个面的朝向</td>
<td>由三角形的三个顶点计算：<code>N = normalize((V2 - V1) × (V3 - V1))</code></td>
<td>所有像素使用同一个法线，导致光照变化生硬</td>
<td>低多边形模型、立方体等硬表面物体</td>
</tr>
<tr>
<td><strong>顶点法线 (Vertex Normal)</strong></td>
<td>一个顶点的法向量，通常是该顶点所属面法线的平均值</td>
<td>对相邻面法线求平均后归一化：<code>N = normalize(Σ faceNormals)</code></td>
<td>产生平滑过渡，使光照更自然</td>
<td>曲面模型、光滑表面（如球体）</td>
</tr>
</tbody></table>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401085528.png" alt="image.png"></p>
<h2 id="4-漫反射"><a href="#4-漫反射" class="headerlink" title="4 漫反射"></a>4 漫反射</h2><h3 id="4-1-概览"><a href="#4-1-概览" class="headerlink" title="4.1 概览"></a>4.1 概览</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401083503.png" alt="image.png|765"></p>
<ul>
<li>平行光线<ul>
<li>光线方向是全局一致的，<strong>与照射点的位置无关</strong>，不会随着照射点的不同而不同，不是很真实。</li>
</ul>
</li>
<li>点光源。<ul>
<li>向四周发射光线，<strong>光线方向与照射点的位置有关</strong>，越靠近光源的部分越亮，光照效果比较真实。</li>
</ul>
</li>
</ul>
<h3 id="4-2-平行光"><a href="#4-2-平行光" class="headerlink" title="4.2 平行光"></a>4.2 平行光</h3><p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/15/16675cb83a87cba9~tplv-t2oaga2asx-image.image" alt="|558"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401083854.png" alt="image.png"></p>
<p>注意：</p>
<ul>
<li>因为平行光方向是全局一致的，<strong>与照射点的位置无关</strong>，故这里的入射角是 <code>vec3 lightDirection = u_LightPosition - vec3(0,0,0);</code></li>
<li>光照的计算不是在顶点着色器中。顶点着色器需要接收顶点法向量，<strong>插值化</strong>后传递给片元着色器</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 顶点着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">VERTEX_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  uniform mat4 u_MvpMatrix;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  attribute vec3 a_Position;</span></span><br><span class="line"><span class="string">  attribute vec4 a_Color;</span></span><br><span class="line"><span class="string">  attribute vec3 a_Normal;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  varying vec3 v_Normal;  // 传递给片元着色器的法向量</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    gl_Position = u_MvpMatrix * vec4(a_Position, 1);</span></span><br><span class="line"><span class="string">    v_Normal = a_Normal;</span></span><br><span class="line"><span class="string">    v_Color = a_Color;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="comment">// 片元着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FRAGMENT_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  precision mediump float;</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string">  varying vec3 v_Normal; // 片元法向量</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform vec3 u_LightColor;   // 光源颜色</span></span><br><span class="line"><span class="string">  uniform vec3 u_LightPosition; // 平行光光源位置</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform float u_AmbientFactor; // 环境光强度因子</span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    // 环境光分量</span></span><br><span class="line"><span class="string">    vec3 ambient = u_AmbientFactor * u_LightColor;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 光源照射方向向量</span></span><br><span class="line"><span class="string">    vec3 lightDirection = u_LightPosition - vec3(0,0,0);</span></span><br><span class="line"><span class="string">    // 漫反射因子  两个方向向量点乘得到的是cos值， cos和入射角成反比</span></span><br><span class="line"><span class="string">    float diffuseFactor = dot(normalize(lightDirection), normalize(v_Normal));</span></span><br><span class="line"><span class="string">    // 如果是负数，说明光线与法向量夹角大于 90 度，此时照不到平面上，所以没有光照，即黑色。</span></span><br><span class="line"><span class="string">    diffuseFactor = max(diffuseFactor, 0.0);</span></span><br><span class="line"><span class="string">    // 漫反射光照 = 光源颜色 * 漫反射因子。</span></span><br><span class="line"><span class="string">    vec3 diffuseLightColor = u_LightColor * diffuseFactor;</span></span><br><span class="line"><span class="string">    gl_FragColor = v_Color * vec4((ambient + diffuseLightColor), 1);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-动态计算法线"><a href="#4-3-动态计算法线" class="headerlink" title="4.3 动态计算法线"></a>4.3 动态计算法线</h3><p>立方体在转动时，转动到正对光源方向的平面并没有被照亮。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/16/1667aeaa119882d6~tplv-t2oaga2asx-image.image"></p>
<p>因为在转动的时候，各个顶点的法向量还是初始值，并没有随着物体的转动而更新，所以即使有平面转动到正对光源的位置，它的法向量还是原先的法向量，计算出来的漫反射光照仍然是 0。所以，我们需要在物体发生变换的时候，让法向量也跟着发生变换。</p>
<p>在 3D 渲染中，物体的每个顶点都会被 <strong>模型矩阵（Model Matrix）</strong> 变换，以完成<strong>平移、旋转、缩放</strong>等操作：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401090747.png" alt="image.png"></p>
<p>但是，<strong>法线不能直接用相同的模型矩阵变换！</strong> </p>
<ul>
<li><strong>平移（Translation）</strong> ✅ 不影响方向，可忽略</li>
<li><strong>旋转（Rotation）</strong> ✅ 可直接作用在法线向量上</li>
<li><strong>缩放（Scaling）</strong> ⚠️ 影响方向，不能直接作用！</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401090824.png" alt="image.png"></p>
<p>数学上，<strong>正确的法线变换矩阵是</strong> <strong>模型矩阵的逆转置矩阵</strong>（Normal Matrix）：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401090841.png" alt="image.png"></p>
<p>🔹 为什么要用 <code>M⁻¹</code>（逆矩阵）？</p>
<p>因为<strong>缩放变换会影响法线的方向</strong>，而<strong>逆矩阵可以抵消这种影响</strong>：</p>
<ul>
<li>如果 <code>M</code> 缩放 <code>x</code> 轴 2 倍，<code>M⁻¹</code> 让 <code>x</code> 轴的变换除以 2，恢复正确方向。</li>
<li>这样，法线方向始终与原表面垂直。</li>
</ul>
<p>🔹 为什么还要转置 <code>T</code>（转置矩阵）？</p>
<p>法线是<strong>向量</strong>，而物体顶点位置是<strong>点</strong>。<br>在<strong>仿射变换（Affine Transformation）</strong> 中，<strong>点的变换矩阵</strong>与<strong>向量的变换矩阵</strong>不同：</p>
<ul>
<li>点的变换用 <code>M</code>。</li>
<li>向量（如法线）要用 <code>M⁻¹</code> 的<strong>转置矩阵</strong>。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 顶点着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">VERTEX_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  uniform mat4 u_MvpMatrix;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  attribute vec3 a_Position;</span></span><br><span class="line"><span class="string">  attribute vec4 a_Color;</span></span><br><span class="line"><span class="string">  attribute vec3 a_Normal;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform mat4 u_NormalMatrix; // 法线变换矩阵</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  varying vec3 v_Normal;  // 传递给片元着色器的法向量</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    gl_Position = u_MvpMatrix * vec4(a_Position, 1);</span></span><br><span class="line"><span class="string">    v_Normal = mat3(u_NormalMatrix) * a_Normal;</span></span><br><span class="line"><span class="string">    v_Color = a_Color;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="comment">// 片元着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FRAGMENT_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  precision mediump float;</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string">  varying vec3 v_Normal; // 片元法向量</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform vec3 u_LightColor;   // 光源颜色</span></span><br><span class="line"><span class="string">  uniform vec3 u_LightPosition; // 平行光光源位置</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform float u_AmbientFactor; // 环境光强度因子</span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    // 环境光分量</span></span><br><span class="line"><span class="string">    vec3 ambient = u_AmbientFactor * u_LightColor;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 光源照射方向向量</span></span><br><span class="line"><span class="string">    vec3 lightDirection = u_LightPosition - vec3(0.0);</span></span><br><span class="line"><span class="string">    // 漫反射因子  两个方向向量点乘得到的是cos值， cos和入射角成反比</span></span><br><span class="line"><span class="string">    float diffuseFactor = dot(normalize(lightDirection), normalize(v_Normal));</span></span><br><span class="line"><span class="string">    // 如果是负数，说明光线与法向量夹角大于 90 度，此时照不到平面上，所以没有光照，即黑色。</span></span><br><span class="line"><span class="string">    diffuseFactor = max(diffuseFactor, 0.0);</span></span><br><span class="line"><span class="string">    // 漫反射光照 = 光源颜色 * 漫反射因子。</span></span><br><span class="line"><span class="string">    vec3 diffuseLightColor = u_LightColor * diffuseFactor;</span></span><br><span class="line"><span class="string">    gl_FragColor = v_Color * vec4((ambient + diffuseLightColor), 1);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">const</span> u_NormalMatrix = gl.<span class="title function_">getUniformLocation</span>(program, <span class="string">&#x27;u_NormalMatrix&#x27;</span>)</span><br><span class="line"><span class="comment">// 模型矩阵</span></span><br><span class="line"><span class="keyword">const</span> modelMatrix = <span class="keyword">new</span> <span class="title class_">Matrix4</span>().<span class="title function_">makeRotationY</span>(<span class="title function_">degToRad</span>(deg))</span><br><span class="line"><span class="comment">// 法线矩阵</span></span><br><span class="line"><span class="keyword">const</span> normalMatrix = modelMatrix.<span class="title function_">clone</span>().<span class="title function_">invert</span>().<span class="title function_">transpose</span>()</span><br><span class="line">gl.<span class="title function_">uniformMatrix4fv</span>(u_NormalMatrix, <span class="literal">false</span>, <span class="keyword">new</span> <span class="title class_">Float32Array</span>(normalMatrix.<span class="property">elements</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-4-点光源"><a href="#4-4-点光源" class="headerlink" title="4.4 点光源"></a>4.4 点光源</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401091246.png" alt="image.png"></p>
<p>注意：</p>
<ul>
<li>向四周发射光线，<strong>光线方向与照射点的位置有关</strong> -&gt; <code>vec3 lightDirection = u_LightPosition - v_Position;</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 顶点着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">VERTEX_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  uniform mat4 u_MvpMatrix;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  attribute vec3 a_Position;</span></span><br><span class="line"><span class="string">  attribute vec4 a_Color;</span></span><br><span class="line"><span class="string">  attribute vec3 a_Normal;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform mat4 u_NormalMatrix; // 法线变换矩阵</span></span><br><span class="line"><span class="string">  uniform mat4 u_ModelMatrix; // 模型变换矩阵</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  varying vec3 v_Normal;  // 传递给片元着色器的法向量</span></span><br><span class="line"><span class="string">  varying vec3 v_Position;</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    gl_Position = u_MvpMatrix * vec4(a_Position, 1);</span></span><br><span class="line"><span class="string">    v_Normal = mat3(u_NormalMatrix) * a_Normal;</span></span><br><span class="line"><span class="string">    v_Position = vec3(u_ModelMatrix * vec4(a_Position, 1));</span></span><br><span class="line"><span class="string">    v_Color = a_Color;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="comment">// 片元着色器</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FRAGMENT_SHADER_SOURCE</span> = <span class="comment">/* glsl */</span> <span class="string">`</span></span><br><span class="line"><span class="string">  precision mediump float;</span></span><br><span class="line"><span class="string">  varying vec4 v_Color;</span></span><br><span class="line"><span class="string">  varying vec3 v_Normal; // 片元法向量</span></span><br><span class="line"><span class="string">  varying vec3 v_Position;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform vec3 u_LightColor;   // 光源颜色</span></span><br><span class="line"><span class="string">  uniform vec3 u_LightPosition; // 平行光光源位置</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  uniform float u_AmbientFactor; // 环境光强度因子</span></span><br><span class="line"><span class="string">  void main() &#123;</span></span><br><span class="line"><span class="string">    // 环境光分量</span></span><br><span class="line"><span class="string">    vec3 ambient = u_AmbientFactor * u_LightColor;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 光源照射方向向量</span></span><br><span class="line"><span class="string">    vec3 lightDirection = u_LightPosition - v_Position;</span></span><br><span class="line"><span class="string">    // 漫反射因子  两个方向向量点乘得到的是cos值， cos和入射角成反比</span></span><br><span class="line"><span class="string">    float diffuseFactor = dot(normalize(lightDirection), normalize(v_Normal));</span></span><br><span class="line"><span class="string">    // 如果是负数，说明光线与法向量夹角大于 90 度，此时照不到平面上，所以没有光照，即黑色。</span></span><br><span class="line"><span class="string">    diffuseFactor = max(diffuseFactor, 0.0);</span></span><br><span class="line"><span class="string">    // 漫反射光照 = 光源颜色 * 漫反射因子。</span></span><br><span class="line"><span class="string">    vec3 diffuseLightColor = u_LightColor * diffuseFactor;</span></span><br><span class="line"><span class="string">    gl_FragColor = v_Color * vec4((ambient + diffuseLightColor), 1);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>

<h2 id="5-镜面高光"><a href="#5-镜面高光" class="headerlink" title="5 镜面高光"></a>5 镜面高光</h2><h3 id="5-1-基础实现"><a href="#5-1-基础实现" class="headerlink" title="5.1 基础实现"></a>5.1 基础实现</h3><p>与漫反射相同，镜面高光也是根据光线的入射方向向量和法向量来决定的，只不过镜面高光还需要依赖视线的观察方向，也就是眼睛是从什么方向观察的物体。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401091648.png" alt="image.png|520"></p>
<p>视线方向向量与反射光向量的之间的夹角越小，夹角余弦值就会越大，那么人眼感受到的光照就会越强，反之，光照越暗。</p>
<ul>
<li>定义向量 R 是镜面反射方向，当观察方向 V 与 R 越接近时，高光部分越明显。</li>
</ul>
<p>因此，我们使用夹角的余弦值表示镜面高光因子，然后再用镜面高光因子乘以光线颜色即可求出镜面高光分量：</p>
<ul>
<li>1、首先需要求出反射光向量 <code>reflectDirection</code> 和人眼视线方向向量 <code>viewDirection</code>。</li>
<li>2、归一化两个向量。</li>
<li>3、求出两个归一化向量的点积，得到镜面高光因子。</li>
<li>4、将上一步求出的高光因子乘以光线颜色，得到镜面高光分量。</li>
</ul>
<blockquote>
<p>GLSL 内置的反射向量算法 <code>reflect(inVec, normal)</code>，其中 <code>inVec</code> 为入射向量，<strong>方向由光源指向入射点</strong>，<code>normal</code> 为入射点的法向量</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 环境光分量</span></span><br><span class="line">vec3 ambient = u_AmbientFactor * u_LightColor;</span><br><span class="line"><span class="comment">// 入射角</span></span><br><span class="line">vec3 lightDirection = u_LightPosition - v_Position;</span><br><span class="line"><span class="comment">// 漫反射因子  两个方向向量点乘得到的是cos值， cos和入射角成反比</span></span><br><span class="line"><span class="type">float</span> diffuseFactor = dot(normalize(lightDirection), normalize(v_Normal));</span><br><span class="line"><span class="comment">// 如果是负数，说明光线与法向量夹角大于 90 度，此时照不到平面上，所以没有光照，即黑色。</span></span><br><span class="line">diffuseFactor = max(diffuseFactor, <span class="number">0.0</span>);</span><br><span class="line"><span class="comment">// 漫反射光照 = 光源颜色 * 漫反射因子。</span></span><br><span class="line">vec3 diffuseLightColor = u_LightColor * diffuseFactor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 镜面高光分量</span></span><br><span class="line"><span class="comment">// 反射向量：在使用reflect 函数计算反射光向量时，要确保入射光向量的方向是**从光源位置指向入射点位置**。</span></span><br><span class="line">vec3 reflectDirection = reflect(normalize(v_Position - u_LightPosition), normalize(v_Normal));</span><br><span class="line"><span class="comment">// 视线观察向量</span></span><br><span class="line">vec3 viewDirection = u_ViewPosition - v_Position;</span><br><span class="line"><span class="comment">// 归一化</span></span><br><span class="line">viewDirection = normalize(viewDirection);</span><br><span class="line">reflectDirection = normalize(reflectDirection);</span><br><span class="line"><span class="comment">// 镜面高光因子</span></span><br><span class="line"><span class="type">float</span> specialFactor = <span class="number">0.0</span>;</span><br><span class="line"><span class="comment">// 如果有光线进入人眼</span></span><br><span class="line"><span class="keyword">if</span>(diffuseFactor &gt; <span class="number">0.0</span>)&#123;</span><br><span class="line">  specialFactor = dot(normalize(viewDirection), normalize(reflectDirection));</span><br><span class="line">  specialFactor = max(specialFactor,<span class="number">0.0</span>);</span><br><span class="line">  specialFactor = <span class="built_in">pow</span>(specialFactor, u_Shininess); <span class="comment">// 添加反光度</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 计算镜面光照分量</span></span><br><span class="line">vec3 specialLightColor  = u_LightColor * specialFactor * <span class="number">0.5</span>;</span><br><span class="line"><span class="comment">// 计算总光照</span></span><br><span class="line">vec3 outColor = ambient + diffuseLightColor + specialLightColor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将物体自身颜色乘以总光照，即人眼看到的物体颜色。</span></span><br><span class="line">gl_FragColor = v_Color * vec4(outColor, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>无镜面高光时：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/18/16685394ede269fc~tplv-t2oaga2asx-image.image" alt="|417"></p>
<p>添加镜面高光后：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/18/166853931eb2c864~tplv-t2oaga2asx-image.image" alt="|513"></p>
<p>观察上面两幅图，我们能很直观地看到添加镜面高光后，球体正中央有一个明晃晃的光圈，符合真实世界中的场景。</p>
<h3 id="5-2-反光度"><a href="#5-2-反光度" class="headerlink" title="5.2 反光度"></a>5.2 反光度</h3><p>但是，这个刺眼的光圈面积太大了，我们需要给它添加一个称为 <code>反光度</code>(shininess) 的参数约束光圈的大小，一个物体的反光度越大，反光率就越强，散射的光就越少，我们看到的高光面积就越小。</p>
<p>我们定义一个 <code>u_Shininess</code> 的变量表示物体的反光度，然后用前面求得的高光因子乘以 2 的 shininess 次幂作为最终的高光因子。这样就可以让我们的光圈变得小一些。</p>
<blockquote>
<p>求幂计算可以通过 GLSL 内置的公式 pow(2, shininess) 求得。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 镜面高光分量</span></span><br><span class="line">vec3 viewDirection = u_ViewPosition - v_Position; <span class="comment">// 视线观察向量</span></span><br><span class="line">viewDirection = (viewDirection); <span class="comment">// 归一化</span></span><br><span class="line"><span class="comment">// 使用半程向量代替反射向量</span></span><br><span class="line">vec3 halfVector = lightDirection + viewDirection;</span><br><span class="line"><span class="comment">// 镜面高光因子</span></span><br><span class="line">float specialFactor = <span class="number">0.0</span>;</span><br><span class="line"><span class="comment">// 如果有光线进入人眼</span></span><br><span class="line"><span class="keyword">if</span>(diffuseFactor &gt; <span class="number">0.0</span>)&#123;</span><br><span class="line">  specialFactor = <span class="title function_">dot</span>(<span class="title function_">normalize</span>(v_Normal), <span class="title function_">normalize</span>(halfVector));</span><br><span class="line">  specialFactor = <span class="title function_">max</span>(specialFactor, <span class="number">0.0</span>);</span><br><span class="line">  specialFactor = <span class="title function_">pow</span>(specialFactor, u_Shininess); <span class="comment">// 添加反光度</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 计算镜面光照分量</span></span><br><span class="line">vec3 specialLightColor  = u_LightColor * specialFactor * <span class="number">0.5</span>;</span><br><span class="line"><span class="comment">// 计算总光照</span></span><br><span class="line">vec3 outColor = ambient + diffuseLightColor + specialLightColor;</span><br><span class="line"><span class="comment">// 将物体自身颜色乘以总光照，即人眼看到的物体颜色。</span></span><br><span class="line">gl_FragColor = v_Color * <span class="title function_">vec4</span>(outColor, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>我们将反光度设置成 32，看下增加反光度后的效果：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/17/16682af8af2b40a2~tplv-t2oaga2asx-image.image"></p>
<p>这会效果明显好多了，我们可以看到光圈点很小了</p>
<h3 id="5-3-Blinn-Phong-光照模型"><a href="#5-3-Blinn-Phong-光照模型" class="headerlink" title="5.3 Blinn-Phong 光照模型"></a>5.3 Blinn-Phong 光照模型</h3><h4 id="5-3-1-问题：冯氏光照模型的高光断痕"><a href="#5-3-1-问题：冯氏光照模型的高光断痕" class="headerlink" title="5.3.1 问题：冯氏光照模型的高光断痕"></a>5.3.1 问题：冯氏光照模型的高光断痕</h4><ul>
<li>在冯氏光照模型中，镜面高光由<strong>视线向量</strong>和<strong>反射向量</strong>的夹角余弦值决定。</li>
<li>当夹角大于 90° 时，余弦值小于 0，镜面高光分量被设为 0，导致高光区域的边缘出现明显的<strong>暗灰色断痕</strong>。</li>
<li>反光度（shininess）越高，高光区域越小，断痕不明显；反之，反光度越低，断痕更明显。</li>
</ul>
<p>如下图，反射光线和视线观察向量之间的夹角γ 大于 90 度，所以此时镜面高光分量为 0。</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/18/1668555808c1edac~tplv-t2oaga2asx-image.image" alt="|734"></p>
<h4 id="5-3-2-Blinn-Phong-光照模型的改进"><a href="#5-3-2-Blinn-Phong-光照模型的改进" class="headerlink" title="5.3.2 Blinn -Phong 光照模型的改进"></a>5.3.2 Blinn -Phong 光照模型的改进</h4><ul>
<li>用**半程向量 (h)**代替反射向量计算镜面高光。</li>
<li>半程向量是<strong>光源方向 (l) 与视线方向 (v) 的单位平均向量</strong>。</li>
<li>计算镜面高光时，使用<strong>法线与半程向量的夹角余弦值</strong>，避免了冯氏模型的高光断痕问题。</li>
<li>这样可以使高光区域更柔和，过渡更加自然，提升视觉效果。</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250401092636.png" alt="image.png"></p>
<p>按照向量的计算规则，半程向量只需要我们将<strong>视线观察向量和入射向量相加</strong>，然后将得出的结果归一化就可以求出了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 镜面高光分量</span></span><br><span class="line">vec3 lightDirection = <span class="title function_">normalize</span>(u_LightPosition - v_Posit) <span class="comment">// 入射向量</span></span><br><span class="line">vec3 viewDirection = <span class="title function_">normalize</span>(u_ViewPosition - v_Position); <span class="comment">// 视线观察向量</span></span><br><span class="line"><span class="comment">// 使用半程向量代替反射向量</span></span><br><span class="line">vec3 halfVector = lightDirection + viewDirection;</span><br><span class="line"><span class="comment">// 镜面高光因子</span></span><br><span class="line">float specialFactor = <span class="number">0.0</span>;</span><br><span class="line"><span class="comment">// 如果有光线进入人眼</span></span><br><span class="line"><span class="keyword">if</span>(diffuseFactor &gt; <span class="number">0.0</span>)&#123;</span><br><span class="line">  specialFactor = <span class="title function_">dot</span>(<span class="title function_">normalize</span>(v_Normal), <span class="title function_">normalize</span>(halfVector));</span><br><span class="line">  specialFactor = <span class="title function_">max</span>(specialFactor, <span class="number">0.0</span>);</span><br><span class="line">  specialFactor = <span class="title function_">pow</span>(specialFactor, u_Shininess); <span class="comment">// 添加反光度</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 计算镜面光照分量</span></span><br><span class="line">vec3 specialLightColor  = u_LightColor * specialFactor * <span class="number">0.5</span>;</span><br><span class="line"><span class="comment">// 计算总光照</span></span><br><span class="line">vec3 outColor = ambient + diffuseLightColor + specialLightColor;</span><br><span class="line"><span class="comment">// 将物体自身颜色乘以总光照，即人眼看到的物体颜色。</span></span><br><span class="line">gl_FragColor = v_Color * <span class="title function_">vec4</span>(outColor, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>冯氏光照效果：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/18/166853931eb2c864~tplv-t2oaga2asx-image.image"></p>
<p>Blin 光照效果：</p>
<p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/18/166856699653738b~tplv-t2oaga2asx-image.image"></p>
<p>可以看到，采用 <code>Blin光照模型</code> 后， 镜面高光区域过度的更加自然。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://VernalScenery.github.io">Scenery</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://vernalscenery.github.io/2025/03/31/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/08_WeBGL_%E5%85%89%E7%85%A7/">https://vernalscenery.github.io/2025/03/31/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/08_WeBGL_%E5%85%89%E7%85%A7/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://VernalScenery.github.io" target="_blank">春和景明的记事本</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WebGL/">WebGL</a></div><div class="post_share"><div class="social-share" data-image="/./img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/03/31/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/07_WeBGL_%E4%B8%89%E7%BB%B4%E5%9B%BE%E5%85%83/" title="08_WeBGL_三维图元"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">08_WeBGL_三维图元</div></div></a></div><div class="next-post pull-right"><a href="/2025/03/28/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/06_WeBGL_%E5%9D%90%E6%A0%87%E7%B3%BB%E8%AF%A6%E8%A7%A3/" title="07_WeBGL_坐标系详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">07_WeBGL_坐标系详解</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2025/03/26/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/01_WebGL_%E5%85%A5%E9%97%A8/" title="01_WebGL_入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-26</div><div class="title">01_WebGL_入门</div></div></a></div><div><a href="/2025/03/26/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/00_WebGL_%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%88%9D%E8%AF%86/" title="00_WebGL_图形学初识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-26</div><div class="title">00_WebGL_图形学初识</div></div></a></div><div><a href="/2024/12/31/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/03_WebGL_%E4%BB%BF%E5%B0%84%E5%8F%98%E6%8D%A2/" title="02_WebGL_仿射变换"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-31</div><div class="title">02_WebGL_仿射变换</div></div></a></div><div><a href="/2025/01/03/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/05_WeBGL_%E4%B8%89%E7%BB%B4%E5%9C%BA%E6%99%AF%E5%9F%BA%E7%A1%80/" title="05_WeBGL_三维场景基础"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-03</div><div class="title">05_WeBGL_三维场景基础</div></div></a></div><div><a href="/2025/03/26/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/02_WebGL_%E7%BB%98%E5%9B%BE%E8%AF%A6%E8%A7%A3/" title="02_WebGL_绘图详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-26</div><div class="title">02_WebGL_绘图详解</div></div></a></div><div><a href="/2025/01/03/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/04_WebGL_%E7%BA%B9%E7%90%86%E8%B4%B4%E5%9B%BE/" title="04_WebGL_纹理贴图"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-03</div><div class="title">04_WebGL_纹理贴图</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Scenery</div><div class="author-info__description">今天不想跑，所以才去跑</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/chjm0121" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1595718686@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A6%82%E8%A7%88"><span class="toc-text">1 概览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%86%AF%E6%B0%8F%E5%85%89%E7%85%A7%E6%A8%A1%E5%9E%8B"><span class="toc-text">1.1 冯氏光照模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%8F%8D%E5%B0%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">1.2 反射类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%8E%AF%E5%A2%83%E5%85%89"><span class="toc-text">2 环境光</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%B3%95%E7%BA%BF"><span class="toc-text">3 法线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95"><span class="toc-text">3.1 计算方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E7%89%B9%E7%82%B9"><span class="toc-text">3.2 特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%88%86%E7%B1%BB"><span class="toc-text">3.3 分类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%BC%AB%E5%8F%8D%E5%B0%84"><span class="toc-text">4 漫反射</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%A6%82%E8%A7%88"><span class="toc-text">4.1 概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%B9%B3%E8%A1%8C%E5%85%89"><span class="toc-text">4.2 平行光</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E5%8A%A8%E6%80%81%E8%AE%A1%E7%AE%97%E6%B3%95%E7%BA%BF"><span class="toc-text">4.3 动态计算法线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E7%82%B9%E5%85%89%E6%BA%90"><span class="toc-text">4.4 点光源</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%95%9C%E9%9D%A2%E9%AB%98%E5%85%89"><span class="toc-text">5 镜面高光</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%9F%BA%E7%A1%80%E5%AE%9E%E7%8E%B0"><span class="toc-text">5.1 基础实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%8F%8D%E5%85%89%E5%BA%A6"><span class="toc-text">5.2 反光度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Blinn-Phong-%E5%85%89%E7%85%A7%E6%A8%A1%E5%9E%8B"><span class="toc-text">5.3 Blinn-Phong 光照模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-1-%E9%97%AE%E9%A2%98%EF%BC%9A%E5%86%AF%E6%B0%8F%E5%85%89%E7%85%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E9%AB%98%E5%85%89%E6%96%AD%E7%97%95"><span class="toc-text">5.3.1 问题：冯氏光照模型的高光断痕</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-Blinn-Phong-%E5%85%89%E7%85%A7%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="toc-text">5.3.2 Blinn -Phong 光照模型的改进</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/05/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/02_%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_Numpy/" title="02_数据分析_Numpy">02_数据分析_Numpy</a><time datetime="2025-08-04T21:11:38.000Z" title="发表于 2025-08-05 05:11:38">2025-08-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/05/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/01_%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_python%E8%AF%AD%E6%B3%95/" title="01_数据分析_python语法">01_数据分析_python语法</a><time datetime="2025-08-04T18:44:45.000Z" title="发表于 2025-08-05 02:44:45">2025-08-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/29/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/13_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E6%A6%82%E7%8E%87%E5%9B%BE%E6%A8%A1%E5%9E%8B/" title="13_机器学习_概率图模型">13_机器学习_概率图模型</a><time datetime="2025-07-29T00:29:02.000Z" title="发表于 2025-07-29 08:29:02">2025-07-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/11_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E8%81%9A%E7%B1%BB/" title="11_机器学习_聚类">11_机器学习_聚类</a><time datetime="2025-07-28T00:19:53.000Z" title="发表于 2025-07-28 08:19:53">2025-07-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/12_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E9%99%8D%E7%BB%B4/" title="12_机器学习_降维">12_机器学习_降维</a><time datetime="2025-07-27T20:48:42.000Z" title="发表于 2025-07-28 04:48:42">2025-07-28</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./img/1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Scenery</div><div class="footer_custom_text"><div>波澜不惊</div><div class="footer-div"><img class="footer-icon" src="./img/备案图标.png"><a class="footer-a" target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">皖ICP备2021016944号-1</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>
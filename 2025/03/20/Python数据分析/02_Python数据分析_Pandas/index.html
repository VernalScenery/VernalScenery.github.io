<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>02_Python数据分析_Pandas | 春和景明的记事本</title><meta name="author" content="Scenery"><meta name="copyright" content="Scenery"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="简介Pandas 是 Python (opens new window) 的核心数据分析支持库，提供了快速、灵活、明确的数据结构，旨在简单、直观地处理关系型、标记型数据。Pandas 的目标是成为 Python 数据分析实践与实战的必备高级工具，其长远目标是成为最强大、最灵活、可以支持任何语言的开源"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://vernalscenery.github.io/2025/03/20/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/02_Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_Pandas/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '02_Python数据分析_Pandas',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-05 14:17:11'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/1.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="春和景明的记事本"><span class="site-name">春和景明的记事本</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">02_Python数据分析_Pandas</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-19T23:10:48.000Z" title="发表于 2025-03-20 07:10:48">2025-03-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-05T06:17:11.000Z" title="更新于 2025-08-05 14:17:11">2025-08-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">22k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>90分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="02_Python数据分析_Pandas"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><code>Pandas</code> 是 <code>Python</code> (<code>opens new window</code>) 的核心数据分析支持库，提供了快速、灵活、明确的数据结构，旨在简单、直观地处理关系型、标记型数据。<code>Pandas</code> 的目标是成为 <code>Python</code> 数据分析实践与实战的必备高级工具，其长远目标是成为最强大、最灵活、可以支持任何语言的开源数据分析工具。经过多年不懈的努力，Pandas 离这个目标已经越来越近了。  </p>
<p>Pandas 的官方网站是： <a target="_blank" rel="noopener" href="https://pandas.pydata.org/">https://pandas.pydata.org/</a></p>
<p>Looking into your past is the only way to discover your future.</p>
<h1 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h1><p>Pandas 的主要数据结构是 <code>Series</code>（一维数据）与 <code>DataFrame</code>（二维数据），这两种数据结构足以处理各领域里的大多数典型用例。</p>
<h2 id="1-Series"><a href="#1-Series" class="headerlink" title="1 Series"></a>1 Series</h2><p><code>Series</code> 是一维结构，由一组数据和一组与之相关的数据标签 (索引) 组成。序列结构只有行索引（<code>row index</code>），没有列名称（<code>column name</code>），但是序列有 <code>Name</code>、<code>dtype</code> 和 <code>index</code> 属性，其中 <code>Name</code> 属性是指序列的名称，<code>dtype</code> 属性是指序列值的类型，<code>index</code> 属性是序列的索引。  </p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/series_spreadsheet.png" alt="|514">  </p>
<p>从序列的结构图中，可以看出，实际上，序列包含数据（<code>values</code>）和索引（<code>index</code>）。左侧是索引，右侧是数据。</p>
<h3 id="1-1-创建方法"><a href="#1-1-创建方法" class="headerlink" title="1.1 创建方法"></a>1.1 创建方法</h3><h4 id="1-1-1-ndarray-创建"><a href="#1-1-1-ndarray-创建" class="headerlink" title="1.1.1 ndarray 创建"></a>1.1.1 ndarray 创建</h4><p>索引在左，值在右，由于没有为数据指定索引，于是<strong>会自动创建</strong>一个 0 到 N-1（N 为数据的长度）的<strong>整数型索引</strong>，取值的时候可以通过索引取值，跟之前学过的数组和列表一样。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320191710.png" alt="image.png|476"></p>
<p>下面传递了索引值。可以在输出中看到自定义的索引值跟之前的变化。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320191737.png" alt="image.png|443"></p>
<h4 id="1-1-2-字典创建"><a href="#1-1-2-字典创建" class="headerlink" title="1.1.2 字典创建"></a>1.1.2 字典创建</h4><p>字典 (dict) 可以作为输入传递，如果没有指定索引，则<strong>按排序顺序取得字典键以构造索引</strong>。 如果传递了索引，索引中与标签对应的数据中的值将被拉出。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320191843.png" alt="image.png|203"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320191856.png" alt="image.png|351"></p>
<p>如果指定的<strong>索引在字典中不存在</strong>，缺少的索引元素使用 <code>NaN</code> 填充。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320191935.png" alt="image.png"></p>
<h4 id="1-1-3-标量创建"><a href="#1-1-3-标量创建" class="headerlink" title="1.1.3 标量创建"></a>1.1.3 标量创建</h4><p>如果数据是<strong>标量值</strong>，则<strong>必须提供索引</strong>。将<strong>重复该值以匹配索引的长度</strong>。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320192016.png" alt="image.png"></p>
<h3 id="1-2-Series-属性与方法"><a href="#1-2-Series-属性与方法" class="headerlink" title="1.2 Series 属性与方法"></a>1.2 Series 属性与方法</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320192738.png" alt="image.png"></p>
<h4 id="1-2-1-常用属性"><a href="#1-2-1-常用属性" class="headerlink" title="1.2.1 常用属性"></a>1.2.1 常用属性</h4><table>
<thead>
<tr>
<th>属性名</th>
<th>描述</th>
<th>示例值（基于 <code>ds</code>）</th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>index</strong></td>
<td>自定义索引标签</td>
<td><code>Index([&#39;d&#39;, &#39;c&#39;, &#39;b&#39;, &#39;a&#39;])</code></td>
</tr>
<tr>
<td>​<strong>values</strong></td>
<td>值的 NumPy 数组</td>
<td><code>array([4.0, 3.0, 2.0, 1.0])</code></td>
</tr>
<tr>
<td>​<strong>dtype</strong></td>
<td>数据类型（显式指定）</td>
<td><code>float64</code></td>
</tr>
<tr>
<td>​<strong>name</strong></td>
<td>Series 名称</td>
<td><code>&#39;number&#39;</code></td>
</tr>
<tr>
<td>​<strong>shape</strong></td>
<td>数据维度</td>
<td><code>(4,)</code>（4 个元素）</td>
</tr>
<tr>
<td>​<strong>size</strong></td>
<td>元素数量</td>
<td><code>4</code></td>
</tr>
<tr>
<td>​<strong>ndim</strong></td>
<td>维度数</td>
<td><code>1</code>（一维）</td>
</tr>
<tr>
<td>​<strong>loc</strong></td>
<td>按标签索引</td>
<td><code>ds.loc[&#39;d&#39;]</code> → 获取值 <code>4.0</code></td>
</tr>
<tr>
<td>​<strong>iloc</strong></td>
<td>按位置索引</td>
<td><code>ds.iloc[0]</code> → 获取第 1 个元素 <code>4.0</code></td>
</tr>
</tbody></table>
<h4 id="1-2-2-常用方法"><a href="#1-2-2-常用方法" class="headerlink" title="1.2.2 常用方法"></a>1.2.2 常用方法</h4><table>
<thead>
<tr>
<th>方法名</th>
<th>描述</th>
<th>示例用法（基于 <code>ds</code>）</th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>head(n)</strong></td>
<td>查看前 <code>n</code> 行（默认 5）</td>
<td><code>ds.head(2)</code> → 显示前 2 行 <code>d=4.0, c=3.0</code></td>
</tr>
<tr>
<td>​<strong>tail(n)</strong></td>
<td>查看后 <code>n</code> 行（默认 5）</td>
<td><code>ds.tail(2)</code> → 显示后 2 行 <code>b=2.0, a=1.0</code></td>
</tr>
<tr>
<td>​<strong>sort_index()</strong></td>
<td>按索引排序</td>
<td><code>ds.sort_index()</code> → 索引变为 <code>[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;]</code></td>
</tr>
<tr>
<td>​<strong>sort_values()</strong></td>
<td>按值排序</td>
<td><code>ds.sort_values()</code> → 值排序为 <code>[1.0, 2.0, 3.0, 4.0]</code></td>
</tr>
<tr>
<td>​<strong>isnull()</strong></td>
<td>检测缺失值（示例无缺失值）</td>
<td><code>ds.isnull()</code> → 返回全 <code>False</code></td>
</tr>
<tr>
<td>​<strong>notnull()</strong></td>
<td>检测非缺失值</td>
<td><code>ds.notnull()</code> → 返回全 <code>True</code></td>
</tr>
<tr>
<td>​<strong>value_counts()</strong></td>
<td>统计唯一值频次（示例值均唯一）</td>
<td><code>ds.value_counts()</code> → 每个值出现 <code>1</code> 次</td>
</tr>
<tr>
<td>​<strong>astype()</strong></td>
<td>类型转换</td>
<td><code>ds.astype(&#39;int&#39;)</code> → 值变为 <code>4, 3, 2, 1</code></td>
</tr>
<tr>
<td>​<strong>describe()</strong></td>
<td>统计摘要（数值型）</td>
<td><code>ds.describe()</code> → 均值、标准差、四分位数等</td>
</tr>
</tbody></table>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320193025.png" alt="image.png"></p>
<p>当然也可以通过单独的函数分别计算出上面的统计量。</p>
<p>比如：<code>ds.min()</code>, <code>ds.max()</code>, <code>ds.median()</code>, <code>ds.quantile()</code>, <code>ds.counts()</code>… …  </p>
<p>常用的统计函数都可以直接调用</p>
<h2 id="2-DataFrame"><a href="#2-DataFrame" class="headerlink" title="2 DataFrame"></a>2 DataFrame</h2><p><code>DataFrame</code> 存储的是二维数据，数据框的结构由 <code>row</code> 和 <code>column</code> 构成，每一行都有一个 <code>row label</code>，每一列都有一个 <code>column label</code>，把 <code>row</code> 和 <code>column</code> 称作 <code>axis</code>，把 <code>row label</code> 和 <code>column label</code> 称作 <code>axis label</code>。通常情况下，<code>column label</code> 是文本类型，是<strong>列名称</strong>（<code>column name</code>），而 <code>row label</code> 是数值类型，也称作<strong>行索引</strong>（<code>row index</code>）。  </p>
<p>多维数组存储二维或三维数据时，编写函数要注意数据集的方向，这对用户来说是一种负担，就像上一章讲过的 <code>numpy</code> 中，经常遇到要填参数 <code>axis</code>，多少还是要过脑子思考一下的。不过在处理 <code>DataFrame</code> 等表格数据时，<code>index</code>（行）或 <code>columns</code>（列）比 <code>axis 0</code> 和 <code> axis 1</code> 更直观。用这种方式迭代 <code>DataFrame</code> 的列，代码更易读易懂。用“更恰当”的方式表示数据集的方向。这样做可以让用户编写数据转换函数时，少费点脑子。  </p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/pandas-data-structure.svg">  </p>
<p>从 <code>DataFrame</code> 的结构图中可以看出，<code>DataFrame</code> 结构由二部分构成：<strong>深色的区域</strong>叫做 <code>Axis Label</code>（轴标签），<strong>浅灰色的区域</strong>是 <code>data</code>，对于 <code>Axis</code>，左侧的轴称作 <code>index</code>、上方的轴称作 <code>columns</code>，而轴的结构实际上是一个 <code>Index</code> 类型。</p>
<h3 id="2-1-创建方式"><a href="#2-1-创建方式" class="headerlink" title="2.1 创建方式"></a>2.1 创建方式</h3><h4 id="2-1-1-ndarrays-Lists-字典创建"><a href="#2-1-1-ndarrays-Lists-字典创建" class="headerlink" title="2.1.1 ndarrays/Lists 字典创建"></a>2.1.1 ndarrays/Lists 字典创建</h4><p>创建一个 <code>DataFrame</code> 数组可以有多种方式，其中最为常用的方式就是利用包含 <code>等长度列表</code> 或 <code>Numpy</code> 数组的字典来创建。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320193434.png" alt="image.png"></p>
<p>通过 <code>columns</code> 参数可以指定列的顺序</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320193500.png" alt="image.png"></p>
<p>除了列表还可以通过 <code>numpy</code> 的方式生成数组创建 <code>dataframe</code></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320193539.png" alt="image.png"></p>
<h4 id="2-1-2-Series-创建"><a href="#2-1-2-Series-创建" class="headerlink" title="2.1.2 Series 创建"></a>2.1.2 Series 创建</h4><p>当然除了 <code>List</code> 和 <code>ndarray</code> 之外，也支持用 <code>pandas</code> 原生的 <code>Series</code> 生成 <code>DataFrame</code> 类型</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320193612.png" alt="image.png|502"></p>
<h3 id="2-2-DataFrame-的属性与方法"><a href="#2-2-DataFrame-的属性与方法" class="headerlink" title="2.2 DataFrame 的属性与方法"></a>2.2 DataFrame 的属性与方法</h3><p><code>DataFrame</code> 和 <code>Series</code> 有很多属性与方法都是通用的，不过在此基础上还增加了一些更多的方法供我们调用。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320193747.png" alt="image.png"></p>
<h4 id="2-2-1-常用属性"><a href="#2-2-1-常用属性" class="headerlink" title="2.2.1 常用属性"></a>2.2.1 常用属性</h4><table>
<thead>
<tr>
<th>属性名</th>
<th>描述</th>
<th>示例值（基于 <code>df</code>）</th>
</tr>
</thead>
<tbody><tr>
<td><code>axes</code></td>
<td>获取数据的行轴（行索引）和列轴（列索引）的<strong>标签</strong>集合</td>
<td><code>[Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;], dtype=&#39;object&#39;), Index([&#39;one&#39;, &#39;two&#39;], dtype=&#39;object&#39;)]</code></td>
</tr>
<tr>
<td>​<code>index</code></td>
<td>行索引</td>
<td><code>Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;])</code></td>
</tr>
<tr>
<td>​<code>columns</code></td>
<td>列标签</td>
<td><code>Index([&#39;one&#39;, &#39;two&#39;], dtype=&#39;object&#39;)</code></td>
</tr>
<tr>
<td>​<code>values</code></td>
<td>二维 <code>NumPy</code> 数组形式数据</td>
<td><code>array([[1., 1], [2., 2], [3., 3], [nan, 4]])</code></td>
</tr>
<tr>
<td>​<code>shape</code></td>
<td>数据维度（行数, 列数）</td>
<td><code>(4, 2)</code></td>
</tr>
<tr>
<td>​<code>dtypes</code></td>
<td>各列数据类型</td>
<td><code>one: float64</code>, <code>two: int64</code></td>
</tr>
<tr>
<td>​<code>size</code></td>
<td>元素总数（含 <code>NaN</code>）</td>
<td><code>8</code>（4 行 × 2 列）</td>
</tr>
<tr>
<td>​<code>ndim</code></td>
<td>维度数</td>
<td><code>2</code>（一维）</td>
</tr>
<tr>
<td>​<code>empty</code></td>
<td>是否为空</td>
<td><code>False</code></td>
</tr>
<tr>
<td>​<code>T</code></td>
<td>转置行与列</td>
<td>转置后列索引为 <code>[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]</code>，行索引为 <code>[&#39;one&#39;, &#39;two&#39;]</code></td>
</tr>
</tbody></table>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320194657.png" alt="image.png"></p>
<p><code>shape</code> 输出的是个元组类型，可继续用 <code>df.shape[0]</code> 获取第一个值，用 <code>df.shape[1] </code> 获取第二个值</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320194730.png" alt="image.png"></p>
<h4 id="2-2-2-常用方法"><a href="#2-2-2-常用方法" class="headerlink" title="2.2.2 常用方法"></a>2.2.2 常用方法</h4><h5 id="1-数据查看与统计"><a href="#1-数据查看与统计" class="headerlink" title="1. 数据查看与统计"></a>1. 数据查看与统计</h5><table>
<thead>
<tr>
<th>方法名</th>
<th>描述与示例（基于 <code>df</code>）</th>
</tr>
</thead>
<tbody><tr>
<td>​**<code>head(n)</code>**</td>
<td>查看前 <code>n</code> 行：<code>df.head(2)</code> 显示 <code>a</code> 和 <code>b</code> 行数据</td>
</tr>
<tr>
<td>​**<code>tail(n)</code>**</td>
<td>查看后 <code>n</code> 行：<code>df.tail(1)</code> 显示 <code>d</code> 行数据</td>
</tr>
<tr>
<td>​**<code>describe()</code>**</td>
<td>统计摘要：<code>df.describe()</code> 显示 <code>count</code>（<code>one</code> 列非空值 3）、<code>mean</code>、<code>std</code> 等</td>
</tr>
<tr>
<td>​**<code>info()</code>**</td>
<td>数据概览：显示列名、非空值数量及数据类型</td>
</tr>
</tbody></table>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320194839.png" alt="image.png"></p>
<h5 id="2-数据操作"><a href="#2-数据操作" class="headerlink" title="2. 数据操作"></a>2. 数据操作</h5><table>
<thead>
<tr>
<th>方法名</th>
<th>描述与示例（基于 <code>df</code>）</th>
</tr>
</thead>
<tbody><tr>
<td>​**<code>dropna()</code>**</td>
<td>删除含 <code>NaN</code> 的行：<code>df.dropna()</code> 删除 <code>d</code> 行</td>
</tr>
<tr>
<td>​**<code>fillna(x)</code>**</td>
<td>填充缺失值：<code>df.fillna(0)</code> 将 <code>d</code> 行 <code>one</code> 列设为 <code>0</code></td>
</tr>
<tr>
<td>​**<code>drop()</code>**</td>
<td>删除行/列：<code>df.drop(columns=&#39;one&#39;)</code> 删除 <code>one</code> 列</td>
</tr>
<tr>
<td>​**<code>rename()</code>**</td>
<td>重命名列：<code>df.rename(columns=&#123;&#39;one&#39;: &#39;col1&#39;&#125;)</code></td>
</tr>
</tbody></table>
<h5 id="3-数据选择与筛选"><a href="#3-数据选择与筛选" class="headerlink" title="3. 数据选择与筛选"></a>3. 数据选择与筛选</h5><table>
<thead>
<tr>
<th>方法名</th>
<th>描述与示例（基于 <code>df</code>）</th>
</tr>
</thead>
<tbody><tr>
<td>​**<code>loc[]</code>**</td>
<td>按标签选择：<code>df.loc[&#39;a&#39;, &#39;one&#39;]</code> 返回 <code>1.0</code></td>
</tr>
<tr>
<td>​**<code>iloc[]</code>**</td>
<td>按位置选择：<code>df.iloc[0, 1]</code> 返回第 1 行第 2 列的值 <code>1</code></td>
</tr>
<tr>
<td>​**<code>query()</code>**</td>
<td>条件筛选：<code>df.query(&#39;two &gt; 2&#39;)</code> 筛选 <code>c</code> 和 <code>d</code> 行</td>
</tr>
</tbody></table>
<h5 id="4-类型转换与计算"><a href="#4-类型转换与计算" class="headerlink" title="4. 类型转换与计算"></a>4. 类型转换与计算</h5><table>
<thead>
<tr>
<th>方法名</th>
<th>描述与示例（基于 <code>df</code>）</th>
</tr>
</thead>
<tbody><tr>
<td>​**<code>astype()</code>**</td>
<td>类型转换：<code>df[&#39;one&#39;].astype(&#39;int&#39;)</code> 转为整数（<code>NaN</code> 会报错）</td>
</tr>
<tr>
<td>​**<code>apply()</code>**</td>
<td>应用函数：<code>df[&#39;two&#39;].apply(lambda x: x**2)</code> 计算平方</td>
</tr>
</tbody></table>
<h1 id="数据的读取"><a href="#数据的读取" class="headerlink" title="数据的读取"></a>数据的读取</h1><h2 id="1-csv-文件读取"><a href="#1-csv-文件读取" class="headerlink" title="1 csv 文件读取"></a>1 <code>csv</code> 文件读取</h2><p><code>CSV</code>（<code>Comma-Separated Values</code>）格式的文件是指以纯文本形式存储的表格数据，这意味着不能简单的使用 <code>Excel</code> 表格工具进行处理，而且 <code>Excel</code> 表格处理的数据量十分有限，而使用 <code>Pandas</code> 来处理数据量巨大的 <code>CSV</code> 文件就容易的多了。  </p>
<p>我们在处理气象数据的时候，经常会遇到 <code>csv</code> 格式的数据，同时 <code>pandas</code> 在读取 <code>csv</code> 格式的时候提供了非常丰富的参数供大家操作，因此非常有必要给大家详细的讲解一下该格式数据的读取。</p>
<h3 id="1-1-基本参数"><a href="#1-1-基本参数" class="headerlink" title="1.1 基本参数"></a>1.1 基本参数</h3><h4 id="1-1-1-基本语法-read-csv"><a href="#1-1-1-基本语法-read-csv" class="headerlink" title="1.1.1 基本语法 read_csv()"></a>1.1.1 基本语法 <code>read_csv()</code></h4><p><code>read_csv()</code> 就是 <code>pandas</code> 中提给的读取 <code>csv</code> 格式的方法，大家可以通过下面这张图看到该函数包含的全部参数。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220209214126.png"></p>
<p>接下来我们会使用一个实际的空气质量数据给大家讲解其中参数应该怎么使用。</p>
<ul>
<li><code>filepath_or_buffer</code> 为第一个参数，没有默认值，也不能为空，根据 Python 的语法，第一个参数传参时可以不写参数名，可以传文件路径。  </li>
</ul>
<p>需要注意的是，<code>Linux</code> 中和 <code>Windows</code> 中路径的写法不一样，下面是 <code>Linux</code> 中的写法，<code>Windows</code> 中的路径需要使用反斜杠‘\’。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320195647.png" alt="image.png|668"></p>
<p>可以通过 <code>info</code> 查看基本信息</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320195820.png" alt="image.png|488"></p>
<p>除了读取本地文件以外，还可以直接读取网络上的 <code>csv</code> 文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">&#x27;https://vincentarelbundock.github.io/Rdatasets/csv/AER/ChinaIncome.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-1-2-分隔符-sep"><a href="#1-1-2-分隔符-sep" class="headerlink" title="1.1.2 分隔符 sep"></a>1.1.2 分隔符 <code>sep</code></h4><h5 id="sep-与-delimiter"><a href="#sep-与-delimiter" class="headerlink" title="sep 与 delimiter"></a>sep 与 delimiter</h5><p><code>sep</code>，<code>delimiter</code> 这两个参数都是表示分隔符，即原数据中每列之间是用什么符号去进行区分的，默认是逗号分隔。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, sep=<span class="string">&#x27;,&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>如果分隔符设置的与原数据不符合，则全部数据归为一列，不进行分割。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, sep=<span class="string">&#x27; &#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320200152.png" alt="image.png"></p>
<p>分隔符还支持正则表达式：</p>
<ol>
<li><p><code>\s</code> 是正则表达式中用于匹配<strong>任意空白字符</strong>的元字符，其覆盖的空白符号包括：</p>
<ul>
<li>空格符（ <code> </code> ）</li>
<li>水平制表符（<code>\t</code>）</li>
<li>垂直制表符（<code>\v</code>）</li>
<li>换行符（<code>\n</code>）</li>
<li>回车符（<code>\r</code>）</li>
<li>换页符（<code>\f</code>）</li>
<li><strong>示例</strong>：字符串 <code>&quot;a\tb\nc&quot;</code> 中的 <code>\t</code> 和 <code>\n</code> 均可被 <code>\s</code> 匹配</li>
</ul>
</li>
<li><p><code>\S</code> 是 <code>\s</code> 的反向匹配符，表示<strong>任意非空白字符</strong>​（如字母、数字、标点等）</p>
</li>
<li><p><code>+</code> 表示其<strong>紧邻的前置表达式需至少出现一次</strong>，且默认采用<strong>贪婪模式</strong>​（尽可能多匹配）</p>
<ul>
<li><code>a+</code> 可匹配 <code>&quot;a&quot;</code>、<code>&quot;aaa&quot;</code>，但无法匹配空字符串。</li>
<li><code>\d+</code> 可匹配连续数字如 <code>&quot;123&quot;</code>，而非单个数字</li>
</ul>
</li>
<li><p>在 <code>+</code> 后添加 <code>?</code>（即 <code>+?</code>）可切换为<strong>非贪婪模式</strong>，仅匹配最短可能的字符串。  </p>
<ul>
<li>字符串 <code>&quot;&lt;div&gt;text&lt;/div&gt;&quot;</code> 中，<code>&lt;.*?&gt;</code> 会匹配单个标签 <code>&lt;div&gt;</code>，而 <code>&lt;.*&gt;</code> 会匹配整个 <code>&lt;div&gt;text&lt;/div&gt;</code></li>
</ul>
</li>
</ol>
<p>因此用 <code>\s+</code> 来匹配至少有一个空白字符存在的分隔符。</p>
<h5 id="delim-whitespace"><a href="#delim-whitespace" class="headerlink" title="delim_whitespace"></a>delim_whitespace</h5><ul>
<li>当 <code>delim_whitespace=True</code> 时，表示<strong>分隔符为空白字符</strong>​（包括空格 、制表符 <code>\t</code>、换行符 <code>\n</code> 等），等效于设置 <code>sep=&#39;\s+&#39;</code>（正则表达式匹配任意数量的连续空白字符）</li>
<li>​<strong>默认值</strong>为 <code>False</code>，此时需通过 <code>sep</code> 或 <code>delimiter</code> 参数指定分隔符</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以下两种方式等效</span></span><br><span class="line">pd.read_csv(<span class="string">&quot;data.txt&quot;</span>, delim_whitespace=<span class="literal">True</span>)</span><br><span class="line">pd.read_csv(<span class="string">&quot;data.txt&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-1-3-表头-header-与列名-names"><a href="#1-1-3-表头-header-与列名-names" class="headerlink" title="1.1.3 表头 header 与列名 names"></a>1.1.3 表头 <code>header</code> 与列名 <code>names</code></h4><h5 id="表头-header"><a href="#表头-header" class="headerlink" title="表头 (header)"></a>表头 (header)</h5><p><code>header</code> 参数支持整型和由<strong>整型组成的列表</strong>，指定第几行是表头，默认会自动推断把第一行作为表头，如果没有表头设置为 <code>None</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.<span class="title function_">read_csv</span>(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, sep=<span class="string">&#x27;,&#x27;</span>, header=<span class="title class_">None</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320202034.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.<span class="title function_">read_csv</span>(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, sep=<span class="string">&#x27;,&#x27;</span>, header=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320202048.png" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.<span class="title function_">read_csv</span>(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, sep=<span class="string">&#x27;,&#x27;</span>, header=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320202058.png" alt="image.png"></p>
<h5 id="列名-names"><a href="#列名-names" class="headerlink" title="列名 (names)"></a>列名 (names)</h5><p><code>names</code> 用来指定列的名称，它是一个<strong>类似列表的序列</strong>，<strong>与数据一一对应</strong>。如果文件不包含列名，那么应该设置 <code>header=None</code>，<strong>列名列表中不允许有重复值</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, sep=<span class="string">&#x27;,&#x27;</span>, names=<span class="built_in">range</span>(<span class="number">38</span>), header=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320202419.png" alt="image.png"></p>
<p>表头和列名的适用场景：  </p>
<ol>
<li><code>csv</code> 文件有表头并且是第一行，那么 <code>names</code> 和 <code>header</code> 都无需指定;</li>
<li><code>csv</code> 文件有表头、但表头不是第一行，可能从下面几行开始才是真正的表头和数据，这个时候指定 <code>header</code> 即可;</li>
<li><code>csv</code> 文件没有表头，全部是纯数据，那么我们可以通过 <code>names</code> 手动生成表头;</li>
<li><code>csv</code> 文件有表头、但是这个表头你不想用，这个时候同时指定 <code>names</code> 和 <code>header</code>。先用 <code>header</code> 选出表头和数据，然后再用 <code>names</code> 将表头替换掉，就等价于将数据读取进来之后再对列名进行 <code>rename</code>；</li>
</ol>
<h4 id="1-1-4-索引-index-col"><a href="#1-1-4-索引-index-col" class="headerlink" title="1.1.4 索引 index_col"></a>1.1.4 索引 <code>index_col</code></h4><p><code>index_col</code> 用来指定索引列，可以是行索引的列编号或者列名，如果给一个列表，则有多个行索引。</p>
<p><span style="color: #badc58; font-weight: 550;">1、Pandas 不会自动将第一列作为索引，不指定时会自动使用以 <code>0</code> 开始的自然索引。</span></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320203001.png" alt="image.png"></p>
<p><span style="color: #badc58; font-weight: 550;">2、index_col = “ 列名 “</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, index_col=<span class="string">&#x27;hour&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320203154.png" alt="image.png"></p>
<p><span style="color: #badc58; font-weight: 550;">3、index_col = 列表</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, index_col=[<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;type&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320203253.png" alt="image.png"></p>
<h4 id="1-1-5-使用部分列-usecols"><a href="#1-1-5-使用部分列-usecols" class="headerlink" title="1.1.5 使用部分列 usecols"></a>1.1.5 使用部分列 <code>usecols</code></h4><p>如果只使用数据的部分列，可以用 <code>usecols</code> 来指定，这样可以加快加载速度并降低内存消耗。</p>
<p><span style="color: #badc58; font-weight: 550;">1、可以直接指明列数</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, usecols=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320203447.png"></p>
<p><span style="color: #badc58; font-weight: 550;">2、可以通过指定列名</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, usecols=[<span class="string">&#x27;东四&#x27;</span>, <span class="string">&#x27;天坛&#x27;</span>, <span class="string">&#x27;官园&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320203548.png" alt="image.png"></p>
<h4 id="1-1-6-跳过指定行-skiprows"><a href="#1-1-6-跳过指定行-skiprows" class="headerlink" title="1.1.6 跳过指定行 skiprows"></a>1.1.6 跳过指定行 <code>skiprows</code></h4><h5 id="1、值为列表"><a href="#1、值为列表" class="headerlink" title="1、值为列表"></a>1、值为列表</h5><p>表示过滤行，想过滤掉哪些行，就写在一个列表里面传递给 <code>skiprows</code> 即可。</p>
<blockquote>
<p>第 0 行是表头</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, skiprows=[<span class="number">1</span>,<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1742474477115.png" alt="QQ_1742474477115.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320204131.png" alt="image.png"></p>
<p>这里把<strong>第一行 (索引为 0)</strong> 过滤掉了，因为第一行是表头，所以在过滤掉之后<strong>第二行（索引为 2）</strong> 就变成表头了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, skiprows=[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320204251.png" alt="image.png"></p>
<p>要想解决表头的问题我们需要设置 <code>header</code> 为 <code>None</code>，这样就可以得到一个递增的数列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, skiprows=[<span class="number">0</span>], header=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320204326.png" alt="image.png"></p>
<h5 id="2、值为数"><a href="#2、值为数" class="headerlink" title="2、值为数"></a>2、值为数</h5><p>如果 <code>skiprows</code> 不传递列表，只传一个数 <code>N</code> 的话，是默认把前 <code>N</code> 行跳过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, skiprows=<span class="number">8</span>)</span><br></pre></td></tr></table></figure>

<p>这里就跳过前 8 行</p>
<h5 id="3、值为函数"><a href="#3、值为函数" class="headerlink" title="3、值为函数"></a>3、值为函数</h5><p>除了传入具体的数值，来表明要过滤掉哪些行，还可以传入一个函数，隔行跳过。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, skiprows=<span class="keyword">lambda</span> x: x % <span class="number">2</span> != <span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-1-7-跳过空行-skip-blank-lines"><a href="#1-1-7-跳过空行-skip-blank-lines" class="headerlink" title="1.1.7 跳过空行 skip_blank_lines"></a>1.1.7 跳过空行 <code>skip_blank_lines</code></h4><p><code>skip_blank_lines</code> 指定是否跳过空行，如果为 <code>True</code>，则跳过空行，否则数据记为 <code>NaN</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, skip_blank_lines=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-1-8-读取指定行-nrows"><a href="#1-1-8-读取指定行-nrows" class="headerlink" title="1.1.8 读取指定行 nrows"></a>1.1.8 读取指定行 <code>nrows</code></h4><p><code>nrows</code> 参数用于指定需要读取的行数，从文件第一行算起，经常用于较大的数据，先取部分进行代码编写。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, nrows=<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320211426.png" alt="image.png"></p>
<h4 id="1-1-9-列数据处理-converters"><a href="#1-1-9-列数据处理-converters" class="headerlink" title="1.1.9 列数据处理 converters"></a>1.1.9 列数据处理 <code>converters</code></h4><p>使用 <code>converters</code> 参数<strong>对列的数据进行转换</strong>，参数中指定列名与针对此列的处理函数，最终以字典的形式传入，字典的键可以是列名或者列的序号。</p>
<p>如果没有对 <code>date</code> 列做时间转换，原来的列就只是整数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320212539.png" alt="image.png"></p>
<p>使用 <code>converters</code> 参数对 <code>date</code> 列做时间转换，将其转换为 <code>datetime64</code> 的类型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, converters=&#123;<span class="string">&#x27;date&#x27;</span>: <span class="keyword">lambda</span> x: pd.to_datetime(x)&#125;)</span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320212159.png" alt="image.png"></p>
<p><code>datetime64</code> 类型支持我们做更多的时间上的操作，有关这一部分我们会在后面的章节继续学习，在此给大家举一个简单的例子，通过 <code>dt</code> 属性我们可以获取数组中具体的年月日。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, converters=&#123;<span class="string">&#x27;date&#x27;</span>: <span class="keyword">lambda</span> x: pd.to_datetime(x)&#125;)</span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>].dt.year, df[<span class="string">&#x27;date&#x27;</span>].dt.month, df[<span class="string">&#x27;date&#x27;</span>].dt.day</span><br></pre></td></tr></table></figure>

<h4 id="1-1-10-空值替换-na-values"><a href="#1-1-10-空值替换-na-values" class="headerlink" title="1.1.10 空值替换 na_values"></a>1.1.10 空值替换 <code>na_values</code></h4><p><code>na_values</code> 用来指定哪些值应被识别为空值（<code>NaN</code>），用于替换原始数据中的特定占位符（如 <code>&quot;N/A&quot;</code>、<code>&quot;-&quot;</code>、<code>&quot;NULL&quot;</code> 等）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>, na_values=<span class="number">20200101</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320212900.png" alt="image.png|677"></p>
<p>这里 <code>date</code> 之前都是 <code>20200101</code> 现在被替换为了 <code>NaN</code></p>
<h3 id="1-2-时间解析"><a href="#1-2-时间解析" class="headerlink" title="1.2 时间解析"></a>1.2 时间解析</h3><p><code>pd.to_datetime</code> 是 Pandas 中用于将数据转换为日期时间格式的函数。它能够将字符串、数字或混合格式的数据解析并转换为 <code>Pandas</code> 的 <code>datetime</code> 类型，这样你就可以方便地对时间序列数据进行操作和分析。</p>
<ul>
<li><strong>数据转换</strong>：无论是单个日期字符串、整个列表、Series 还是 DataFrame 中的列，都可以通过 <code>pd.to_datetime</code> 转换成日期时间格式，使得后续的时间计算和比较更简单。</li>
<li><strong>自动解析</strong>：该函数可以自动识别多种日期和时间格式，如果数据格式比较规范，可以自动推断出日期的排列顺序。</li>
<li><strong>格式参数</strong>：如果日期字符串格式比较固定，可以通过 <code>format</code> 参数指定具体的格式，从而提高解析速度和准确性。例如：<code>pd.to_datetime(date_str, format=&#39;%Y-%m-%d&#39;)</code>。</li>
<li><strong>错误处理</strong>：使用 <code>errors</code> 参数可以控制当转换出错时的行为（例如 <code>&#39;raise&#39;</code> 抛出错误，<code>&#39;coerce&#39;</code> 将无法解析的值转换为 NaT）。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(</span><br><span class="line">    <span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.csv&#x27;</span>,</span><br><span class="line">    converters=&#123;<span class="string">&#x27;hour&#x27;</span>: <span class="keyword">lambda</span> x: x.zfill(<span class="number">2</span>)&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 &#x27;date&#x27; 和 &#x27;hour&#x27; 列转换为字符串后再拼接，创建 &#x27;time&#x27; 列</span></span><br><span class="line">df[<span class="string">&#x27;time&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;date&#x27;</span>].astype(<span class="built_in">str</span>) + <span class="string">&#x27; &#x27;</span> + df[<span class="string">&#x27;hour&#x27;</span>].astype(<span class="built_in">str</span>).<span class="built_in">str</span>.zfill(<span class="number">2</span>) + <span class="string">&#x27;:00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果不再需要原始的 &#x27;date&#x27; 和 &#x27;hour&#x27; 列，可以删除</span></span><br><span class="line">df.drop(columns=[<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>], inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df[<span class="string">&#x27;time&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320214013.png" alt="image.png"></p>
<h2 id="2-txt-文件读取"><a href="#2-txt-文件读取" class="headerlink" title="2 txt 文件读取"></a>2 <code>txt</code> 文件读取</h2><p>之前我们在 Numpy 的章节里讲解了如何试用 <code>Numpy</code> 的 <code>loadtxt()</code> 函数区读取文件，基本的功能都是可以实现的。现在再给大家介绍如何用 <code>pandas</code> 来读取 <code>txt</code> 文件。  </p>
<p>有的同学可能会问，既然已经会了 <code>Numpy</code> 的方式为什么还要学 <code>pandas</code> 的读取方式呢，因为 <code>pandas</code> 比 <code>Numpy</code> 具有更丰富的功能，更便于做数据处理，而且前面也讲了，不管 <code>Series</code> 还是 <code>DataFrame</code> 的数据类型都可以通过 <code>.values</code> 的方式直接获得 <code>Numpy</code> 的 <code>ndarray</code> 数据类型，非常方便获取。</p>
<p><code>Pandas</code> 中有两个函数可以用来读取 <code>txt</code> 文件，一个是 <code>read_table()</code> 函数，另外一个就是上面一直使用的 <code>read_csv()</code> 函数。  </p>
<ul>
<li><strong>两个函数的作用基本相同</strong>：<br>  Pandas 提供了 <code>read_table()</code> 和 <code>read_csv()</code> 两个函数来读取文本文件。它们底层的实现是一致的，主要区别在于默认分隔符不同。</li>
<li><strong>默认分隔符</strong>：<ul>
<li><code>read_table()</code> 默认使用制表符（\t）作为分隔符。</li>
<li><code>read_csv()</code> 默认使用逗号（,）作为分隔符。</li>
</ul>
</li>
</ul>
<p>因此我们以后在遇到 <code>txt</code> 文件的时候就可以参照上面介绍的 <code>read_csv()</code> 的方法进行读取，记住一个函数还是要比记两个函数容易一点。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320214454.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_table(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/txt_read.txt&#x27;</span>, header=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320214505.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/txt_read.txt&#x27;</span>, sep=<span class="string">&#x27;\t&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320214521.png" alt="image.png"></p>
<h2 id="3-json-文件的读取"><a href="#3-json-文件的读取" class="headerlink" title="3 json 文件的读取"></a>3 json 文件的读取</h2><p>使用 <code>read_json</code> 读取 <code>json</code> 文件</p>
<h3 id="3-1-基础读取"><a href="#3-1-基础读取" class="headerlink" title="3.1 基础读取"></a>3.1 基础读取</h3><h4 id="3-1-1-path-or-buf"><a href="#3-1-1-path-or-buf" class="headerlink" title="3.1.1 path_or_buf"></a>3.1.1 <code>path_or_buf</code></h4><p><code>path_or_buf</code> 为第一个参数，没有默认值，也不能为空，表示数据的相应路径。</p>
<p>原始数据 <code>frame.json</code> 如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;up&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">,</span><span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">8</span><span class="punctuation">,</span><span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">12</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;down&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">5</span><span class="punctuation">,</span><span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">9</span><span class="punctuation">,</span><span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">13</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;right&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span><span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">6</span><span class="punctuation">,</span><span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">10</span><span class="punctuation">,</span><span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">14</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;left&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">,</span><span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">7</span><span class="punctuation">,</span><span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">11</span><span class="punctuation">,</span><span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">15</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/frame.json&#x27;</span>)</span><br><span class="line">df, <span class="built_in">type</span>(df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320214922.png" alt="image.png"></p>
<h4 id="3-1-2-typ"><a href="#3-1-2-typ" class="headerlink" title="3.1.2 typ"></a>3.1.2 <code>typ</code></h4><p><code>typ</code> 参数有两个值可选，<code>frame</code> 或 <code>series</code>，默认为 <code>frame</code>。表示最终的结果是以 <code>dataframe</code> 的结构还是以 <code>series</code> 的结构显示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/frame.json&#x27;</span>, typ=<span class="string">&#x27;series&#x27;</span>)</span><br><span class="line">df, <span class="built_in">type</span>(df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320215849.png" alt="image.png"></p>
<h4 id="3-1-3-orient"><a href="#3-1-3-orient" class="headerlink" title="3.1.3 orient"></a>3.1.3 <code>orient</code></h4><p><code>orient</code> 参数用于指定 JSON 数据的结构形式，帮助 Pandas 正确解析为 DataFrame。根据 JSON 的不同组织形式，需选择对应的 <code>orient</code> 类型。</p>
<table>
<thead>
<tr>
<th>​**<code>orient</code> 参数**</th>
<th>​<strong>JSON 结构示例</strong></th>
<th>​<strong>适用场景</strong></th>
<th>​<strong>生成的 DataFrame 结构</strong></th>
<th>​<strong>读取代码示例</strong></th>
</tr>
</thead>
<tbody><tr>
<td>​**<code>split</code>**</td>
<td><code>&#123;&quot;index&quot;: [0,1], &quot;columns&quot;: [&quot;A&quot;,&quot;B&quot;], &quot;data&quot;: [[1,2], [3,4]]&#125;</code></td>
<td>JSON 明确包含索引、列名和数据值</td>
<td>索引和列名由 <code>index</code> 和 <code>columns</code> 指定，数据为二维数组：  <br><code>A B</code>  <br><code>0 1 2</code>  <br><code>1 3 4</code></td>
<td><code>pd.read_json(json_str, orient=&#39;split&#39;)</code></td>
</tr>
<tr>
<td>​**<code>records</code>**</td>
<td><code>[&#123;&quot;A&quot;:1, &quot;B&quot;:2&#125;, &#123;&quot;A&quot;:3, &quot;B&quot;:4&#125;]</code></td>
<td>数据为字典列表，每行对应一个字典</td>
<td>字典键为列名，每行数据为字典值：  <br><code>A B</code>  <br><code>0 1 2</code>  <br><code>1 3 4</code></td>
<td><code>pd.read_json(json_str, orient=&#39;records&#39;)</code></td>
</tr>
<tr>
<td>​**<code>index</code>**</td>
<td><code>&#123;&quot;0&quot;: &#123;&quot;A&quot;:1, &quot;B&quot;:2&#125;, &quot;1&quot;: &#123;&quot;A&quot;:3, &quot;B&quot;:4&#125;&#125;</code></td>
<td>外层键为行索引，内层键为列名</td>
<td>外层键作为行索引，内层键作为列名：  <br><code>A B</code>  <br><code>0 1 2</code>  <br><code>1 3 4</code></td>
<td><code>pd.read_json(json_str, orient=&#39;index&#39;)</code></td>
</tr>
<tr>
<td>​**<code>columns</code>**</td>
<td><code>&#123;&quot;A&quot;: &#123;&quot;0&quot;:1, &quot;1&quot;:3&#125;, &quot;B&quot;: &#123;&quot;0&quot;:2, &quot;1&quot;:4&#125;&#125;</code></td>
<td>外层键为列名，内层键为行索引</td>
<td>外层键作为列名，内层键作为行索引：  <br><code>A B</code>  <br><code>0 1 2</code>  <br><code>1 3 4</code></td>
<td><code>pd.read_json(json_str, orient=&#39;columns&#39;)</code>  <br>（默认行为，若 JSON 外层为列名）</td>
</tr>
<tr>
<td>​**<code>values</code>**</td>
<td><code>[[1,2], [3,4]]</code></td>
<td>数据为纯嵌套数组，无索引和列名</td>
<td>生成默认索引和列名的 DataFrame：  <br><code>0 1</code>  <br><code>0 1 2</code>  <br><code>1 3 4</code></td>
<td><code>pd.read_json(json_str, orient=&#39;values&#39;)</code></td>
</tr>
</tbody></table>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;up&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span> <span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">,</span> <span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">8</span><span class="punctuation">,</span> <span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">12</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;down&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span> <span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">5</span><span class="punctuation">,</span> <span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">9</span><span class="punctuation">,</span> <span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">13</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;right&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span> <span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">6</span><span class="punctuation">,</span> <span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">14</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;left&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;white&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">,</span> <span class="attr">&quot;black&quot;</span><span class="punctuation">:</span><span class="number">7</span><span class="punctuation">,</span> <span class="attr">&quot;red&quot;</span><span class="punctuation">:</span><span class="number">11</span><span class="punctuation">,</span> <span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span><span class="number">15</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/frame.json&#x27;</span>, orient=<span class="string">&#x27;columns&#x27;</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<ul>
<li>​<strong>外层键</strong>​（<code>up</code>, <code>down</code>, <code>right</code>, <code>left</code>）→ ​<strong>列名</strong></li>
<li>​<strong>内层键</strong>​（<code>white</code>, <code>black</code>, <code>red</code>, <code>blue</code>）→ ​<strong>行索引</strong></li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320215924.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/frame.json&#x27;</span>, orient=<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320220323.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/frame.json&#x27;</span>, orient=<span class="string">&#x27;split&#x27;</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p>会报错，原因如下：</p>
<p><code>split</code> 要求 JSON 必须包含以下三个顶级键：</p>
<ul>
<li><code>index</code>: 行索引列表</li>
<li><code>columns</code>: 列名列表</li>
<li><code>data</code>: 二维数据列表</li>
</ul>
<p>而你的 JSON 文件结构为外层键（<code>up</code>, <code>down</code>, <code>right</code>, <code>left</code>）对应列名，内层键（<code>white</code>, <code>black</code>, <code>red</code>, <code>blue</code>）对应行索引，属于 <code>orient=&#39;columns&#39;</code> 或 <code>orient=&#39;index&#39;</code> 的结构。</p>
<h3 id="3-2-规范化"><a href="#3-2-规范化" class="headerlink" title="3.2 规范化"></a>3.2 规范化</h3><p>上述例子中因为 <code>frame.json</code> 文件是由 <code>DataFrame</code> 对象直接生成的结构化数据而来，所以可以直接读取。然而，有些时候数据半结构化数据，需要降其中的内容规范化，这时候我们就需要一个新的函数。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/16686703590641668670325894.png"></p>
<p><span style="color: #badc58; font-weight: 550;">源数据</span></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span> <span class="string">&quot;USA&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;books&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;XML Cookbook&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">23.56</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Python Fundamentals&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">50.70</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;The Numpy library&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">12.30</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UK&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;books&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Java Enterprise&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">28.60</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HTML5&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">31.35</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Python for Dummies&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">28.00</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><span style="color: #badc58; font-weight: 550;">基本读取</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/list.json&#x27;</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320220516.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/list.json&#x27;</span>, typ=<span class="string">&#x27;series&#x27;</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320220531.png" alt="image.png"></p>
<p><span style="color: #badc58; font-weight: 550;">参数详解</span></p>
<ul>
<li>​<code>record_path</code>：需展开的嵌套字段（如 <code>books</code>）。</li>
<li>​<code>meta</code>：要保留的元数据字段（如 <code>[&#39;writer&#39;, &#39;nationality&#39;]</code>）。</li>
<li>​<code>meta_prefix</code>​（可选）：元数据字段前缀（如 <code>meta_prefix=&#39;author_&#39;</code>）。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.json_normalize(df, record_path=<span class="string">&#x27;books&#x27;</span>, meta=[<span class="string">&#x27;writer&#x27;</span>, <span class="string">&#x27;nationality&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320220624.png" alt="image.png"></p>
<h2 id="4-excel-数据的读取"><a href="#4-excel-数据的读取" class="headerlink" title="4 excel 数据的读取"></a>4 <code>excel</code> 数据的读取</h2><h3 id="4-1-基本语法"><a href="#4-1-基本语法" class="headerlink" title="4.1 基本语法"></a>4.1 基本语法</h3><p><code>Excel</code> 文件的格式为 <code>xls</code> 和 <code>xlsx</code>，<code>pandas</code> 读取 <code>excel</code> 文件需要安装依赖库 <code>xlrd</code></p>
<p><code>read_excel</code> 方法读取 <code>xls</code> 格式文件，自动使用 <code>xlrd</code> 引擎</p>
<table>
<thead>
<tr>
<th>​<strong>文件格式</strong></th>
<th>​<strong>依赖库</strong></th>
<th>​<strong>安装命令</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>.xls</code></td>
<td><code>xlrd</code></td>
<td><code>pip install xlrd</code></td>
</tr>
<tr>
<td><code>.xlsx</code></td>
<td><code>openpyxl</code></td>
<td><code>pip install openpyxl</code></td>
</tr>
</tbody></table>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/16686758737201668675872740.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 Excel 文件</span></span><br><span class="line">df = pd.read_excel(</span><br><span class="line">    file_path,         <span class="comment"># 文件路径（必填）</span></span><br><span class="line">    sheet_name=<span class="number">0</span>,      <span class="comment"># 指定工作表（默认第一个）</span></span><br><span class="line">    header=<span class="number">0</span>,          <span class="comment"># 指定表头行（默认第0行）</span></span><br><span class="line">    names=<span class="literal">None</span>,        <span class="comment"># 自定义列名列表</span></span><br><span class="line">    index_col=<span class="literal">None</span>,    <span class="comment"># 指定索引列</span></span><br><span class="line">    usecols=<span class="literal">None</span>,      <span class="comment"># 指定读取的列（如 &quot;A:C&quot; 或 [0,1,2]）</span></span><br><span class="line">    converters=&#123;...&#125;,  <span class="comment"># 列数据类型转换（字典形式）</span></span><br><span class="line">    skiprows=<span class="literal">None</span>,     <span class="comment"># 跳过的行号列表（如 [0,2]）</span></span><br><span class="line">    nrows=<span class="literal">None</span>,        <span class="comment"># 读取的行数（从文件开头算起）</span></span><br><span class="line">    na_values=[...],   <span class="comment"># 指定识别为 NaN 的值</span></span><br><span class="line">    parse_dates=<span class="literal">False</span>, <span class="comment"># 解析日期列</span></span><br><span class="line">    engine=<span class="literal">None</span>        <span class="comment"># 指定引擎（&#x27;xlrd&#x27; 或 &#x27;openpyxl&#x27;）</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res = pd.read_excel(<span class="string">&#x27;../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><code>sheet_name</code> 参数，可以指定读取 <code>excel</code> 的 <code>sheet</code>，即指定读取的工作表。</p>
<p>取值分以下几种情况：</p>
<ul>
<li>​<strong>整数</strong>：按位置（从 0 开始），如 <code>sheet_name=0</code>（默认第一个工作表）。</li>
<li>​<strong>字符串</strong>：按名称，如 <code>sheet_name=&#39;Sheet2&#39;</code>。</li>
<li>​<strong>列表</strong>：读取多个工作表，返回字典（键为工作表名，值为 DataFrame）。</li>
<li>​<strong>None</strong>：读取所有工作表，返回字典。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_excel(<span class="string">&#x27;.../../../../../data/【任务3】Pandas/C3.2——3.3数据的读取/beijing.xlsx&#x27;</span>, sheet_name=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250320221629.png" alt="image.png"></p>
<p><code>read_excel()</code> 还有几个参数他们的作用与 <code>read_csv()</code> 里介绍的一致</p>
<table>
<thead>
<tr>
<th>​<strong>核心参数</strong></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><code>sheet_name</code></td>
<td>指定工作表名称或位置（默认读取第一个）</td>
<td><code>0</code>（第 1 个表）、<code>&#39;Sheet1&#39;</code>、<code>[0,1]</code>（多表）、<code>None</code>（全部表）</td>
<td>多表返回字典，键为表名，值为 DataFrame。</td>
</tr>
<tr>
<td><code>header</code></td>
<td>指定列名所在行号（默认第 0 行）</td>
<td><code>0</code>（首行）、<code>2</code>（第 3 行）、<code>None</code>（无表头）</td>
<td>无表头时自动生成列索引（0,1,2…）。</td>
</tr>
<tr>
<td><code>names</code></td>
<td>自定义列名列表</td>
<td><code>[&#39;ID&#39;, &#39;Name&#39;, &#39;Date&#39;]</code></td>
<td>覆盖原有列名，需与列数一致。</td>
</tr>
<tr>
<td><code>index_col</code></td>
<td>指定索引列位置或列名</td>
<td><code>0</code>（第 1 列）、<code>&#39;ID&#39;</code></td>
<td>常用于时间序列或唯一标识列。</td>
</tr>
<tr>
<td><code>usecols</code></td>
<td>指定读取的列（支持位置、列名或范围）</td>
<td><code>[0,1,2]</code>（前 3 列）、<code>&#39;A:C&#39;</code>（A 到 C 列）、<code>[&#39;ID&#39;, &#39;Name&#39;]</code></td>
<td>避免读取冗余列，提升效率。</td>
</tr>
<tr>
<td><code>skiprows</code></td>
<td>跳过指定行号或条件</td>
<td><code>[0,2]</code>（跳过第 1、3 行）、<code>lambda x: x &gt; 10</code>（跳过前 10 行）</td>
<td>处理文件头部注释或无效行。</td>
</tr>
<tr>
<td><code>nrows</code></td>
<td>读取的行数（从文件开头算起）</td>
<td><code>100</code>（仅读前 100 行）</td>
<td>适用于快速预览或分块处理。</td>
</tr>
<tr>
<td><code>na_values</code></td>
<td>指定识别为 <code>NaN</code> 的值</td>
<td><code>[&#39;NA&#39;, &#39;-&#39;, &#39;NULL&#39;]</code></td>
<td>覆盖默认空值列表（如 <code>&#39;NA&#39;</code>, <code>&#39;NaN&#39;</code>）。</td>
</tr>
<tr>
<td><code>parse_dates</code></td>
<td>解析日期列（列索引或列名）</td>
<td><code>[0]</code>（第 1 列）、<code>[&#39;OrderDate&#39;]</code></td>
<td>复杂日期格式需手动处理。</td>
</tr>
<tr>
<td><code>converters</code></td>
<td>列数据类型转换函数</td>
<td><code>&#123;&#39;Price&#39;: lambda x: x * 1.1&#125;</code>（对 Price 列加 10%）</td>
<td>避免与 <code>dtype</code> 参数冲突。</td>
</tr>
<tr>
<td><code>engine</code></td>
<td>指定解析引擎</td>
<td><code>&#39;xlrd&#39;</code>（.xls）、<code>&#39;openpyxl&#39;</code>（.xlsx）</td>
<td>自动根据文件后缀选择，冲突时需显式指定。</td>
</tr>
<tr>
<td>​</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="数据的保存"><a href="#数据的保存" class="headerlink" title="数据的保存"></a>数据的保存</h1><ol>
<li><p>​<strong>CSV 文件</strong></p>
<ul>
<li><p>​<strong>保存方法</strong>：<code>df.to_csv(&#39;output.csv&#39;, index=False)</code></p>
<ul>
<li><code>encoding=&#39;utf-8-sig&#39;</code> 解决中文乱码问题</li>
<li><code>sep=&#39;;&#39;</code> 自定义分隔符（默认逗号）</li>
<li><code>compression=&#39;gzip&#39;</code> 支持压缩存储</li>
</ul>
</li>
<li><p>​<strong>适用场景</strong>：数据分享、跨平台兼容性高，但处理大文件效率较低。</p>
</li>
</ul>
</li>
<li><p>​<strong>Excel 文件</strong></p>
<ul>
<li>​<strong>保存方法</strong>：<code>df.to_excel(&#39;output.xlsx&#39;, sheet_name=&#39;Sheet1&#39;, index=False)</code><ul>
<li><code>engine=&#39;openpyxl&#39;</code> 需安装依赖库</li>
<li>多表写入：结合 <code>ExcelWriter</code> 分批次写入多个 Sheet</li>
</ul>
</li>
<li>​<strong>注意</strong>：Excel 文件体积较大，适合小规模数据或需保留样式的场景。</li>
</ul>
</li>
</ol>
<h2 id="1-csv-文件的写入"><a href="#1-csv-文件的写入" class="headerlink" title="1 csv 文件的写入"></a>1 <code>csv</code> 文件的写入</h2><p><code>to_csv()</code> 就是 pandas 中提的写入 csv 格式的方法，大家可以通过下面这张图看到该函数包含的全部参数。</p>
<p><img src="https://fastly.jsdelivr.net/gh/guoanby/cloudimg@master/img/166865765513920221117101255.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.to_csv(<span class="string">&#x27;./data/C3.2 常规数据格式读写/write.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>以下是 <code>pandas.DataFrame.to_csv()</code> 方法的常用参数总结表格</p>
<table>
<thead>
<tr>
<th>​<strong>参数名</strong></th>
<th>​<strong>英文参数</strong></th>
<th>​<strong>默认值</strong></th>
<th>​<strong>描述</strong></th>
<th>​<strong>示例</strong></th>
</tr>
</thead>
<tbody><tr>
<td>文件路径/缓冲区</td>
<td><code>path_or_buf</code></td>
<td>无</td>
<td>文件路径或文件对象（必填）。支持字符串路径、路径对象或文件句柄。</td>
<td><code>df.to_csv(&#39;data.csv&#39;)</code></td>
</tr>
<tr>
<td>分隔符</td>
<td><code>sep</code></td>
<td><code>&#39;,&#39;</code></td>
<td>指定列之间的分隔符，类型是<strong>长度为 1</strong> 的字符串</td>
<td><code>df.to_csv(sep=&#39;\t&#39;)</code>（制表符分隔）</td>
</tr>
<tr>
<td>是否保留索引</td>
<td><code>index</code></td>
<td><code>True</code></td>
<td>是否将 DataFrame 的索引写入文件。</td>
<td><code>df.to_csv(index=False)</code>（不保留索引）</td>
</tr>
<tr>
<td>是否保留列名</td>
<td><code>header</code></td>
<td><code>True</code></td>
<td>是否将列名（表头）写入文件。</td>
<td><code>df.to_csv(header=False)</code>（无表头）</td>
</tr>
<tr>
<td>编码方式</td>
<td><code>encoding</code></td>
<td><code>&#39;utf-8&#39;</code></td>
<td>指定文件编码格式。</td>
<td><code>df.to_csv(encoding=&#39;gbk&#39;)</code>（适用于中文）</td>
</tr>
<tr>
<td>空值表示</td>
<td><code>na_rep</code></td>
<td><code>&#39;&#39;</code></td>
<td>指定缺失值（NaN）的填充字符串。</td>
<td><code>df.to_csv(na_rep=&#39;NA&#39;)</code>（将 NaN 替换为 “NA”）</td>
</tr>
<tr>
<td>浮点数格式</td>
<td><code>float_format</code></td>
<td><code>None</code></td>
<td>控制浮点数的输出格式。</td>
<td><code>df.to_csv(float_format=&#39;%.2f&#39;)</code>（保留两位小数）</td>
</tr>
<tr>
<td>日期时间格式</td>
<td><code>date_format</code></td>
<td><code>None</code></td>
<td>指定日期时间列的格式。</td>
<td><code>df.to_csv(date_format=&#39;%Y-%m-%d&#39;)</code>（日期格式化为年 - 月 - 日）</td>
</tr>
<tr>
<td>引用规则</td>
<td><code>quoting</code></td>
<td><code>None</code></td>
<td>控制字段的引用规则（如 <code>csv.QUOTE_ALL</code> 或 <code>csv.QUOTE_NONNUMERIC</code>）。</td>
<td><code>df.to_csv(quoting=csv.QUOTE_NONNUMERIC)</code>（非数字字段加引号）</td>
</tr>
<tr>
<td>行结束符</td>
<td><code>line_terminator</code></td>
<td><code>&#39;\n&#39;</code></td>
<td>指定行结束符（如 <code>&#39;\r\n&#39;</code> 兼容 Windows）。</td>
<td><code>df.to_csv(line_terminator=&#39;\r\n&#39;)</code></td>
</tr>
<tr>
<td>压缩格式</td>
<td><code>compression</code></td>
<td><code>&#39;infer&#39;</code></td>
<td>指定文件压缩格式（如 <code>&#39;gzip&#39;</code>、<code>&#39;bz2&#39;</code>）。</td>
<td><code>df.to_csv(&#39;data.csv.gz&#39;, compression=&#39;gzip&#39;)</code>（导出为 gzip 压缩文件）</td>
</tr>
<tr>
<td>选择列</td>
<td><code>columns</code></td>
<td><code>None</code></td>
<td>指定要导出的列名列表。</td>
<td><code>df.to_csv(columns=[&#39;col1&#39;, &#39;col2&#39;])</code>（仅导出指定列）</td>
</tr>
<tr>
<td>模式</td>
<td><code>mode</code></td>
<td><code>&#39;w&#39;</code></td>
<td>文件写入模式（<code>&#39;w&#39;</code> 覆盖写入，<code>&#39;a&#39;</code> 追加）。</td>
<td><code>df.to_csv(mode=&#39;a&#39;)</code>（追加到现有文件）</td>
</tr>
<tr>
<td>小数点符号</td>
<td><code>decimal</code></td>
<td><code>&#39;.&#39;</code></td>
<td>指定浮点数的小数点符号（如欧洲常用 <code>&#39;,&#39;</code>）。</td>
<td><code>df.to_csv(decimal=&#39;,&#39;)</code>（用逗号表示小数点）</td>
</tr>
</tbody></table>
<ul>
<li>​<strong>必填参数</strong>：<code>path_or_buf</code> 必须指定，其他参数可选。</li>
<li>​<strong>常用组合</strong>：<ul>
<li>导出无索引、无表头的 CSV：<code>df.to_csv(&#39;data.csv&#39;, index=False, header=False)</code></li>
<li>导出制表符分隔文件：<code>df.to_csv(&#39;data.tsv&#39;, sep=&#39;\t&#39;)</code></li>
<li>处理中文编码：<code>df.to_csv(encoding=&#39;gb18030&#39;)</code></li>
<li>压缩文件：<code>df.to_csv(&#39;data.csv.gz&#39;, compression=&#39;gzip&#39;)</code></li>
</ul>
</li>
</ul>
<h2 id="2-json-文件的写入"><a href="#2-json-文件的写入" class="headerlink" title="2 json 文件的写入"></a>2 <code>json</code> 文件的写入</h2><p>以下是 <code>pandas.DataFrame.to_json()</code> 方法的常用参数总结表格：</p>
<table>
<thead>
<tr>
<th>​<strong>参数名</strong></th>
<th>​<strong>英文参数</strong></th>
<th>​<strong>默认值</strong></th>
<th>​<strong>描述</strong></th>
<th>​<strong>示例</strong></th>
</tr>
</thead>
<tbody><tr>
<td>文件路径/缓冲区</td>
<td><code>path_or_buf</code></td>
<td>无</td>
<td>文件路径或文件对象（必填）。支持字符串路径、路径对象或文件句柄。</td>
<td><code>df.to_json(&#39;data.json&#39;)</code></td>
</tr>
<tr>
<td>JSON 格式方向</td>
<td><code>orient</code></td>
<td><code>&#39;index&#39;</code></td>
<td>指定 JSON 结构格式，可选值：<code>&#39;split&#39;</code>、<code>&#39;records&#39;</code>、<code>&#39;index&#39;</code>、<code>&#39;columns&#39;</code>、<code>&#39;values&#39;</code>、<code>&#39;table&#39;</code>。</td>
<td><code>df.to_json(orient=&#39;records&#39;)</code>（每行作为一个独立对象）</td>
</tr>
<tr>
<td>日期格式</td>
<td><code>date_format</code></td>
<td><code>&#39;epoch&#39;</code></td>
<td>指定日期时间格式，可选 <code>&#39;epoch&#39;</code>（时间戳）或 <code>&#39;iso&#39;</code>（ISO 8601 格式）。</td>
<td><code>df.to_json(date_format=&#39;iso&#39;)</code>（日期格式化为 <code>YYYY-MM-DDTHH:MM:SS</code>）</td>
</tr>
<tr>
<td>浮点数精度</td>
<td><code>double_precision</code></td>
<td><code>10</code></td>
<td>控制浮点数的小数位数精度。</td>
<td><code>df.to_json(double_precision=2)</code>（保留两位小数）</td>
</tr>
<tr>
<td>是否强制 ASCII 字符</td>
<td><code>force_ascii</code></td>
<td><code>True</code></td>
<td>是否将非 ASCII 字符转义为 Unicode 转义序列（如 <code>\uXXXX</code>）。</td>
<td><code>df.to_json(force_ascii=False)</code>（允许直接输出中文等字符）</td>
</tr>
<tr>
<td>是否保留索引</td>
<td><code>index</code></td>
<td><code>True</code></td>
<td>是否将索引包含在 JSON 中（部分 <code>orient</code> 模式下无效）。</td>
<td><code>df.to_json(index=False)</code>（忽略索引）</td>
</tr>
<tr>
<td>缩进格式化</td>
<td><code>indent</code></td>
<td><code>None</code></td>
<td>指定缩进空格数，使 JSON 可读（若为 <code>None</code>，则为紧凑格式）。</td>
<td><code>df.to_json(indent=4)</code>（格式化输出，缩进 4 空格）</td>
</tr>
<tr>
<td>压缩格式</td>
<td><code>compression</code></td>
<td><code>&#39;infer&#39;</code></td>
<td>指定文件压缩格式（如 <code>&#39;gzip&#39;</code>、<code>&#39;bz2&#39;</code>）。</td>
<td><code>df.to_json(&#39;data.json.gz&#39;, compression=&#39;gzip&#39;)</code>（导出为 gzip 压缩文件）</td>
</tr>
<tr>
<td>模式</td>
<td><code>mode</code></td>
<td><code>&#39;w&#39;</code></td>
<td>文件写入模式（<code>&#39;w&#39;</code> 覆盖写入，<code>&#39;a&#39;</code> 追加）。</td>
<td><code>df.to_json(mode=&#39;a&#39;)</code>（追加到现有文件）</td>
</tr>
<tr>
<td>行分隔模式</td>
<td><code>lines</code></td>
<td><code>False</code></td>
<td>当 <code>orient=&#39;records&#39;</code> 时，是否以每行一个 JSON 对象的形式输出（类似 JSON Lines）。</td>
<td><code>df.to_json(lines=True, orient=&#39;records&#39;)</code></td>
</tr>
<tr>
<td>表结构模式</td>
<td><code>schema</code></td>
<td><code>None</code></td>
<td>当 <code>orient=&#39;table&#39;</code> 时，指定表结构的元数据（需配合 <code>pandas.io.json.build_table_schema</code>）。</td>
<td><code>df.to_json(orient=&#39;table&#39;, schema=schema)</code></td>
</tr>
</tbody></table>
<ol>
<li>​<strong>必填参数</strong>：<code>path_or_buf</code> 必须指定。</li>
<li>​<strong>常用 <code>orient</code> 模式</strong>：<ul>
<li><code>&#39;index&#39;</code>：以索引为外层键，如 <code>&#123;index: &#123;column: value&#125;&#125;</code>。</li>
<li><code>&#39;records&#39;</code>：输出为对象列表，每行一个字典，如 <code>[&#123;column: value&#125;, ...]</code>。</li>
<li><code>&#39;table&#39;</code>：包含 <code>schema</code> 元数据和 <code>data</code> 的完整表结构（兼容 JSON Schema）。</li>
</ul>
</li>
<li>​<strong>处理非 ASCII 字符</strong>：若需直接显示中文、日文等，设置 <code>force_ascii=False</code>。</li>
<li>​<strong>日期时间处理</strong>：<ul>
<li><code>date_format=&#39;epoch&#39;</code>：日期转为时间戳（如 <code>1638316800000</code>）。</li>
<li><code>date_format=&#39;iso&#39;</code>：日期转为字符串（如 <code>&quot;2023-12-01T00:00:00&quot;</code>）</li>
</ul>
</li>
</ol>
<h3 id="2-1-orient"><a href="#2-1-orient" class="headerlink" title="2.1 orient"></a>2.1 orient</h3><h4 id="2-1-1-原始-JSON-数据"><a href="#2-1-1-原始-JSON-数据" class="headerlink" title="2.1.1 原始 JSON 数据"></a>2.1.1 原始 JSON 数据</h4><p><code>json</code> 文件的写入和读取参数比较相似，其最重要的一个参数是 <code>orient</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始 JSON 数据 (默认是 `orient=&#x27;index&#x27;` 格式)</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;columns&quot;</span>: [<span class="string">&quot;title&quot;</span>, <span class="string">&quot;price&quot;</span>, <span class="string">&quot;writer&quot;</span>, <span class="string">&quot;nationality&quot;</span>],</span><br><span class="line">    <span class="string">&quot;index&quot;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: [</span><br><span class="line">        [<span class="string">&quot;XML Cookbook&quot;</span>, <span class="number">23.56</span>, <span class="string">&quot;mark Ross&quot;</span>, <span class="string">&quot;USA&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;Python Fundamentals&quot;</span>, <span class="number">50.7</span>, <span class="string">&quot;mark Ross&quot;</span>, <span class="string">&quot;USA&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;The Numpy library&quot;</span>, <span class="number">12.3</span>, <span class="string">&quot;mark Ross&quot;</span>, <span class="string">&quot;USA&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;Java Enterprise&quot;</span>, <span class="number">28.6</span>, <span class="string">&quot;Barbara Bracket&quot;</span>, <span class="string">&quot;UK&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;HTML5&quot;</span>, <span class="number">31.35</span>, <span class="string">&quot;Barbara Bracket&quot;</span>, <span class="string">&quot;UK&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;Python for Dummies&quot;</span>, <span class="number">28.0</span>, <span class="string">&quot;Barbara Bracket&quot;</span>, <span class="string">&quot;UK&quot;</span>]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-orient-39-split-39"><a href="#2-1-2-orient-39-split-39" class="headerlink" title="2.1.2 orient=&#39;split&#39;"></a>2.1.2 <code>orient=&#39;split&#39;</code></h4><p>将数据拆分为 <code>columns</code>、<code>index</code> 和 <code>data</code> 三个独立部分：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;columns&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;title&quot;</span><span class="punctuation">,</span> <span class="string">&quot;price&quot;</span><span class="punctuation">,</span> <span class="string">&quot;writer&quot;</span><span class="punctuation">,</span> <span class="string">&quot;nationality&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span><span class="string">&quot;XML Cookbook&quot;</span><span class="punctuation">,</span><span class="number">23.56</span><span class="punctuation">,</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="string">&quot;USA&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span><span class="string">&quot;Python Fundamentals&quot;</span><span class="punctuation">,</span><span class="number">50.7</span><span class="punctuation">,</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="string">&quot;USA&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span><span class="string">&quot;The Numpy library&quot;</span><span class="punctuation">,</span><span class="number">12.3</span><span class="punctuation">,</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="string">&quot;USA&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span><span class="string">&quot;Java Enterprise&quot;</span><span class="punctuation">,</span><span class="number">28.6</span><span class="punctuation">,</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="string">&quot;UK&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span><span class="string">&quot;HTML5&quot;</span><span class="punctuation">,</span><span class="number">31.35</span><span class="punctuation">,</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="string">&quot;UK&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span><span class="string">&quot;Python for Dummies&quot;</span><span class="punctuation">,</span><span class="number">28.0</span><span class="punctuation">,</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="string">&quot;UK&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>适用场景</strong>：需要明确分离元数据（列名、索引）和实际数据时。</p>
<h4 id="2-1-3-orient-39-records-39"><a href="#2-1-3-orient-39-records-39" class="headerlink" title="2.1.3 orient=&#39;records&#39;"></a>2.1.3 <code>orient=&#39;records&#39;</code></h4><p>每行数据为一个独立的 JSON 对象（列表格式）：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;XML Cookbook&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">23.56</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python Fundamentals&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">50.7</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;The Numpy library&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">12.3</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Java Enterprise&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">28.6</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;HTML5&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">31.35</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python for Dummies&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">28.0</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><strong>适用场景</strong>：API 接口或数据库存储（如 MongoDB），每条记录独立处理。</p>
<h4 id="2-1-4-​orient-39-index-39-默认模式"><a href="#2-1-4-​orient-39-index-39-默认模式" class="headerlink" title="2.1.4 ​orient=&#39;index&#39; (默认模式)"></a>2.1.4 ​<code>orient=&#39;index&#39;</code> (默认模式)</h4><p>以索引为外层键，每行数据为嵌套对象：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;0&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;XML Cookbook&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">23.56</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;1&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python Fundamentals&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">50.7</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;2&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;The Numpy library&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">12.3</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;3&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Java Enterprise&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">28.6</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;4&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;HTML5&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">31.35</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;5&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python for Dummies&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">28.0</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>适用场景</strong>：需要通过索引快速查找某一行数据。</p>
<hr>
<h4 id="2-1-5-​orient-39-columns-39"><a href="#2-1-5-​orient-39-columns-39" class="headerlink" title="2.1.5 ​orient=&#39;columns&#39;"></a>2.1.5 ​<code>orient=&#39;columns&#39;</code></h4><p>以列名为外层键，每列数据为嵌套对象：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;0&quot;</span><span class="punctuation">:</span><span class="string">&quot;XML Cookbook&quot;</span><span class="punctuation">,</span><span class="attr">&quot;1&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python Fundamentals&quot;</span><span class="punctuation">,</span><span class="attr">&quot;2&quot;</span><span class="punctuation">:</span><span class="string">&quot;The Numpy library&quot;</span><span class="punctuation">,</span><span class="attr">&quot;3&quot;</span><span class="punctuation">:</span><span class="string">&quot;Java Enterprise&quot;</span><span class="punctuation">,</span><span class="attr">&quot;4&quot;</span><span class="punctuation">:</span><span class="string">&quot;HTML5&quot;</span><span class="punctuation">,</span><span class="attr">&quot;5&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python for Dummies&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;0&quot;</span><span class="punctuation">:</span><span class="number">23.56</span><span class="punctuation">,</span><span class="attr">&quot;1&quot;</span><span class="punctuation">:</span><span class="number">50.7</span><span class="punctuation">,</span><span class="attr">&quot;2&quot;</span><span class="punctuation">:</span><span class="number">12.3</span><span class="punctuation">,</span><span class="attr">&quot;3&quot;</span><span class="punctuation">:</span><span class="number">28.6</span><span class="punctuation">,</span><span class="attr">&quot;4&quot;</span><span class="punctuation">:</span><span class="number">31.35</span><span class="punctuation">,</span><span class="attr">&quot;5&quot;</span><span class="punctuation">:</span><span class="number">28.0</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;0&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;1&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;2&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;3&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;4&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;5&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;0&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">,</span><span class="attr">&quot;1&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">,</span><span class="attr">&quot;2&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">,</span><span class="attr">&quot;3&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">,</span><span class="attr">&quot;4&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">,</span><span class="attr">&quot;5&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>适用场景</strong>：按列提取数据（如分析某一列的值）。</p>
<h4 id="2-1-6-​orient-39-values-39"><a href="#2-1-6-​orient-39-values-39" class="headerlink" title="2.1.6 ​orient=&#39;values&#39;"></a>2.1.6 ​<code>orient=&#39;values&#39;</code></h4><p>仅保留数据值（二维数组，无列名和索引）：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span><span class="string">&quot;XML Cookbook&quot;</span><span class="punctuation">,</span><span class="number">23.56</span><span class="punctuation">,</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="string">&quot;USA&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span><span class="string">&quot;Python Fundamentals&quot;</span><span class="punctuation">,</span><span class="number">50.7</span><span class="punctuation">,</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="string">&quot;USA&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span><span class="string">&quot;The Numpy library&quot;</span><span class="punctuation">,</span><span class="number">12.3</span><span class="punctuation">,</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="string">&quot;USA&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span><span class="string">&quot;Java Enterprise&quot;</span><span class="punctuation">,</span><span class="number">28.6</span><span class="punctuation">,</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="string">&quot;UK&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span><span class="string">&quot;HTML5&quot;</span><span class="punctuation">,</span><span class="number">31.35</span><span class="punctuation">,</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="string">&quot;UK&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span><span class="string">&quot;Python for Dummies&quot;</span><span class="punctuation">,</span><span class="number">28.0</span><span class="punctuation">,</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="string">&quot;UK&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><strong>适用场景</strong>：仅需要原始数值，不关心元数据时。</p>
<h4 id="2-1-7-orient-39-table-39"><a href="#2-1-7-orient-39-table-39" class="headerlink" title="2.1.7 orient=&#39;table&#39;"></a>2.1.7 <code>orient=&#39;table&#39;</code></h4><p>包含完整的表结构元数据（兼容 <a target="_blank" rel="noopener" href="https://json-schema.org/">JSON Schema</a>）：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;schema&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;fields&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;index&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;integer&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;title&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;price&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;number&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;writer&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;nationality&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;primaryKey&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;index&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pandas_version&quot;</span><span class="punctuation">:</span><span class="string">&quot;1.4.0&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;XML Cookbook&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">23.56</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python Fundamentals&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">50.7</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;The Numpy library&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">12.3</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;mark Ross&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;USA&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span><span class="number">3</span><span class="punctuation">,</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Java Enterprise&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">28.6</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">,</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;HTML5&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">31.35</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span><span class="number">5</span><span class="punctuation">,</span><span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;Python for Dummies&quot;</span><span class="punctuation">,</span><span class="attr">&quot;price&quot;</span><span class="punctuation">:</span><span class="number">28.0</span><span class="punctuation">,</span><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span><span class="string">&quot;Barbara Bracket&quot;</span><span class="punctuation">,</span><span class="attr">&quot;nationality&quot;</span><span class="punctuation">:</span><span class="string">&quot;UK&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>适用场景</strong>：需要完整元数据（如数据类型、主键）的严格数据交换。</p>
<h2 id="3-Excel-文件写入"><a href="#3-Excel-文件写入" class="headerlink" title="3 Excel 文件写入"></a>3 <code>Excel</code> 文件写入</h2><p><code>to_excel()</code> 和 <code>to_csv()</code> 函数的参数很多都很相似，我们不做过多强调，比较特殊的就是 <code>sheet_name</code> 这个参数，代表着 <code>Excel</code> 中最下面 <code>sheet</code> 的名字</p>
<h3 id="3-1-to-excel-特有参数"><a href="#3-1-to-excel-特有参数" class="headerlink" title="3.1 to_excel() 特有参数"></a>3.1 <code>to_excel()</code> 特有参数</h3><table>
<thead>
<tr>
<th>​<strong>参数名</strong></th>
<th>​<strong>默认值</strong></th>
<th>​<strong>描述</strong></th>
<th>​<strong>示例</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>sheet_name</code></td>
<td><code>&#39;Sheet1&#39;</code></td>
<td>指定 Excel 工作表的名称（字符串或索引）。</td>
<td><code>df.to_excel(sheet_name=&#39;SalesData&#39;)</code></td>
</tr>
<tr>
<td><code>startrow</code></td>
<td><code>0</code></td>
<td>写入数据的起始行（从 0 开始计数）。</td>
<td><code>df.to_excel(startrow=2)</code>（从第 3 行开始写入）</td>
</tr>
<tr>
<td><code>startcol</code></td>
<td><code>0</code></td>
<td>写入数据的起始列（从 0 开始计数）。</td>
<td><code>df.to_excel(startcol=1)</code>（从第 2 列开始写入）</td>
</tr>
<tr>
<td><code>engine</code></td>
<td><code>&#39;openpyxl&#39;</code></td>
<td>指定写入 Excel 文件的引擎，可选 <code>&#39;openpyxl&#39;</code>（xlsx 格式）或 <code>&#39;xlsxwriter&#39;</code>。</td>
<td><code>df.to_excel(engine=&#39;xlsxwriter&#39;)</code></td>
</tr>
<tr>
<td><code>merge_cells</code></td>
<td><code>True</code></td>
<td>是否合并多级索引（如行或列标题的合并）。</td>
<td><code>df.to_excel(merge_cells=False)</code>（禁止自动合并单元格）</td>
</tr>
<tr>
<td><code>inf_rep</code></td>
<td><code>&#39;inf&#39;</code></td>
<td>表示无穷大（<code>np.inf</code>）的字符串。</td>
<td><code>df.to_excel(inf_rep=&#39;∞&#39;)</code>（用符号 ∞ 替代无穷大）</td>
</tr>
<tr>
<td><code>freeze_panes</code></td>
<td><code>None</code></td>
<td>指定冻结窗格的位置（如 <code>(2, 1)</code> 表示冻结第 3 行和第 2 列）。</td>
<td><code>df.to_excel(freeze_panes=(1, 0))</code>（冻结首行和首列）</td>
</tr>
</tbody></table>
<ol>
<li>​<strong>多工作表操作</strong>：通过 <code>sheet_name</code> 指定工作表，或多次调用追加到不同工作表。</li>
<li>​<strong>格式控制</strong>：<ul>
<li>合并单元格（<code>merge_cells</code>）用于多级表头。</li>
<li>冻结窗格（<code>freeze_panes</code>）优化数据浏览体验</li>
</ul>
</li>
</ol>
<h3 id="3-2-to-csv-特有参数"><a href="#3-2-to-csv-特有参数" class="headerlink" title="3.2 to_csv() 特有参数"></a>3.2 <code>to_csv()</code> 特有参数</h3><table>
<thead>
<tr>
<th>​<strong>参数名</strong></th>
<th>​<strong>默认值</strong></th>
<th>​<strong>描述</strong></th>
<th>​<strong>示例</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>sep</code></td>
<td><code>&#39;,&#39;</code></td>
<td>指定列分隔符（如 <code>\t</code> 表示制表符）。</td>
<td><code>df.to_csv(sep=&#39;;&#39;)</code>（用分号分隔列）</td>
</tr>
<tr>
<td><code>line_terminator</code></td>
<td><code>&#39;\n&#39;</code></td>
<td>指定行结束符（如 <code>\r\n</code> 兼容 Windows）。</td>
<td><code>df.to_csv(line_terminator=&#39;\r\n&#39;)</code></td>
</tr>
<tr>
<td><code>quoting</code></td>
<td><code>None</code></td>
<td>控制字段的引用规则（如 <code>csv.QUOTE_ALL</code> 强制所有字段加引号）。</td>
<td><code>df.to_csv(quoting=csv.QUOTE_NONNUMERIC)</code>（非数字字段加引号）</td>
</tr>
<tr>
<td><code>quotechar</code></td>
<td><code>&#39;&quot;&#39;</code></td>
<td>指定引用字符（如单引号 <code>&#39;</code>）。</td>
<td><code>df.to_csv(quotechar=&quot;&#39;&quot;)</code></td>
</tr>
<tr>
<td><code>escapechar</code></td>
<td><code>None</code></td>
<td>指定转义字符（用于转义分隔符或换行符）。</td>
<td><code>df.to_csv(escapechar=&#39;\\&#39;)</code></td>
</tr>
<tr>
<td><code>compression</code></td>
<td><code>&#39;infer&#39;</code></td>
<td>指定文件压缩格式（如 <code>&#39;gzip&#39;</code>、<code>&#39;bz2&#39;</code>）。</td>
<td></td>
</tr>
</tbody></table>
<h1 id="数据的索引与切片"><a href="#数据的索引与切片" class="headerlink" title="数据的索引与切片"></a>数据的索引与切片</h1><p>索引在 <code>Pandas</code> 中非常重要，通过索引我们可以获取 <code>Series</code> 或 <code>DataFrame</code> 中的任意数据。  </p>
<p><code>Series</code> 和 <code>DataFrame</code> 在索引上的使用是一致的，而且实际中我们更常使用的类型是 <code>DataFrame</code>，因此在自处我们讲解都以 <code>DataFrame</code> 为例，学会 <code>DataFrame</code> 的切片与索引后, <code>Series</code> 类型的使用方法大家也就明白了。</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>类型</th>
<th>索引方式</th>
<th>功能</th>
<th>示例</th>
<th>注意事项</th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>点字符</strong></td>
<td>属性访问</td>
<td>列名（标签）</td>
<td>访问单列（返回 <code>Series</code>）</td>
<td><code>df.Name</code></td>
<td>不推荐！列名需无空格，且不能与函数名/保留字冲突（如 <code>df.max</code> 会冲突）</td>
</tr>
<tr>
<td>​<strong>中括号 <code>[]</code></strong></td>
<td>通用索引</td>
<td>列名、布尔条件</td>
<td>1. 单列/多列选择  <br>2. 布尔筛选  <br>3. 行切片（仅数字位置）</td>
<td><code>df[&#39;Name&#39;]</code>  <br><code>df[[&#39;Name&#39;, &#39;Age&#39;]]</code>  <br><code>df[df.Age &gt; 30]</code>  <br><code>df[0:3]</code></td>
<td>行切片只能通过位置（类似列表），无法用标签；多列需传入列表</td>
</tr>
<tr>
<td>​**<code>.loc[]</code>**</td>
<td>标签索引</td>
<td>行/列标签</td>
<td>按标签批量选取行或列（闭区间）</td>
<td><code>df.loc[&#39;a&#39;]</code>  <br><code>df.loc[&#39;a&#39;:&#39;c&#39;, &#39;Age&#39;]</code>  <br><code>df.loc[df.Age &gt; 30, &#39;Name&#39;]</code></td>
<td>支持切片、多标签、条件筛选；<code>&#39;a&#39;:&#39;c&#39;</code> 包含两端</td>
</tr>
<tr>
<td>​**<code>.iloc[]</code>**</td>
<td>位置索引</td>
<td>行/列位置</td>
<td>按整数位置批量选取行或列</td>
<td><code>df.iloc[0]</code>  <br><code>df.iloc[0:3, 1:2]</code>  <br><code>df.iloc[[0,2], [1,3]]</code></td>
<td>切片左闭右开（<code>0:3</code> 取 0,1,2）；支持列表指定位置</td>
</tr>
<tr>
<td>​**<code>.at[]</code>**</td>
<td>标签索引</td>
<td>行/列标签</td>
<td>快速访问单个元素</td>
<td><code>df.at[&#39;a&#39;, &#39;Age&#39;]</code></td>
<td>比 <code>.loc</code> 更快，但只能取一个元素</td>
</tr>
<tr>
<td>​**<code>.iat[]</code>**</td>
<td>位置索引</td>
<td>行/列位置</td>
<td>快速访问单个元素</td>
<td><code>df.iat[0, 1]</code></td>
<td>比 <code>.iloc</code> 更快，但只能取一个元素</td>
</tr>
</tbody></table>
<h2 id="1-基本结构"><a href="#1-基本结构" class="headerlink" title="1 基本结构"></a>1 基本结构</h2><p><code>DataFrame</code> 是二维表格型数据结构，包含：</p>
<ul>
<li>​<strong>行索引（index）​</strong>：标识每一行。</li>
<li>​<strong>列索引（columns）​</strong>：标识每一列。</li>
<li>​<strong>数据（values）​</strong>：二维数组，每个位置存储具体值。</li>
</ul>
<h2 id="2-中括号的方式"><a href="#2-中括号的方式" class="headerlink" title="2 中括号的方式"></a>2 中括号的方式</h2><p>使用中括号访问数据是 <code>Numpy</code> 遗留下来的方式</p>
<h3 id="2-1-列索引"><a href="#2-1-列索引" class="headerlink" title="2.1 列索引"></a>2.1 列索引</h3><p>直接通过列名选择列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;Age&#x27;</span>]          <span class="comment"># 返回 Series</span></span><br><span class="line">df[[<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>]] <span class="comment"># 选择多列，返回 DataFrame</span></span><br><span class="line">df.Age             <span class="comment"># 属性式访问（列名无空格或特殊字符时可用）</span></span><br></pre></td></tr></table></figure>

<ul>
<li>多列索引不是 <code>df[‘Name’,&#39;Age&#39;]</code>, 索引多列时， 传入的必须是一个 <code>list</code> ，而不是多个列名标签，<strong>方括号应该有两层</strong></li>
</ul>
<h3 id="2-2-行索引"><a href="#2-2-行索引" class="headerlink" title="2.2 行索引"></a>2.2 行索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="number">0</span>:<span class="number">2</span>]   </span><br></pre></td></tr></table></figure>

<ul>
<li>末端不包含<br><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321201325.png" alt="image.png"></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="number">0</span>::<span class="number">5</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>第二个不填就是一直到尾</li>
<li>5 代表每隔 5 行取一次</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321201349.png" alt="image.png"></p>
<h3 id="2-3-联合索引"><a href="#2-3-联合索引" class="headerlink" title="2.3 联合索引"></a>2.3 联合索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="number">2</span>::<span class="number">5</span>][[<span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;type&#x27;</span>, <span class="string">&#x27;东四&#x27;</span>, <span class="string">&#x27;天坛&#x27;</span>, <span class="string">&#x27;官园&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321201650.png" alt="image.png"></p>
<h2 id="3-loc-索引"><a href="#3-loc-索引" class="headerlink" title="3 loc 索引"></a>3 <code>loc</code> 索引</h2><ol>
<li>​<strong>严格基于标签</strong>：<ul>
<li>即使行/列标签是数字（如 <code>0, 1, 2</code>），<code>loc</code> 仍将其视为标签，而非位置下标。</li>
<li>错误示例：<code>df.loc[0]</code> → 如果索引标签不是 <code>0</code>，会触发 <code>KeyError</code>。</li>
</ul>
</li>
<li>​<strong>切片规则</strong>：<ul>
<li>​<strong>标签切片</strong>：闭区间（包含两端），如 <code>&#39;a&#39;:&#39;c&#39;</code> 包含 <code>a</code> 和 <code>c</code>。</li>
<li>对比 <code>.iloc</code>：位置切片为左闭右开，如 <code>0:3</code> 取 <code>0,1,2</code>。</li>
</ul>
</li>
<li>​<strong>行列联合筛选</strong>：<ul>
<li>可同时指定行和列，例如：<br>  <code>df.loc[[&#39;a&#39;, &#39;b&#39;], &#39;Name&#39;:&#39;Age&#39;]</code> → 选择行标签 <code>a</code> 和 <code>b</code>，列从 <code>Name</code> 到 <code>Age</code>。</li>
</ul>
</li>
</ol>
<table>
<thead>
<tr>
<th>语法格式</th>
<th>功能描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>df.loc[行标签, 列标签]</code></td>
<td>同时筛选行和列（返回子集）</td>
<td><code>df.loc[&#39;a&#39;, &#39;Age&#39;]</code></td>
</tr>
<tr>
<td><code>df.loc[行标签]</code></td>
<td>筛选指定行（返回行 Series）</td>
<td><code>df.loc[&#39;a&#39;]</code></td>
</tr>
<tr>
<td><code>df.loc[:, 列标签]</code></td>
<td>筛选指定列（返回列 Series）</td>
<td><code>df.loc[:, [&#39;Name&#39;, &#39;Age&#39;]]</code></td>
</tr>
</tbody></table>
<p><code>loc</code> 接受的输入类型及用法：</p>
<table>
<thead>
<tr>
<th>输入类型</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>单个标签</strong></td>
<td>精确匹配一个行或列标签</td>
<td><code>df.loc[&#39;Alice&#39;, &#39;City&#39;]</code></td>
</tr>
<tr>
<td>​<strong>标签列表</strong></td>
<td>匹配多个行或列标签</td>
<td><code>df.loc[[&#39;Alice&#39;, &#39;Bob&#39;], &#39;Age&#39;]</code></td>
</tr>
<tr>
<td>​<strong>标签切片</strong></td>
<td>闭区间切片（包含两端）</td>
<td><code>df.loc[&#39;Alice&#39;:&#39;Charlie&#39;, :]</code></td>
</tr>
<tr>
<td>​<strong>布尔条件</strong></td>
<td>通过条件筛选行或列</td>
<td><code>df.loc[df[&#39;Age&#39;] &gt; 30, :]</code></td>
</tr>
<tr>
<td>​<strong>函数</strong></td>
<td>接受返回标签、列表或布尔的函数</td>
<td><code>df.loc[lambda df: df.Age &gt; 25, :]</code></td>
</tr>
</tbody></table>
<p><code>df</code> 原始数据如下</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321202253.png" alt="image.png"></p>
<h3 id="3-1-单行索引"><a href="#3-1-单行索引" class="headerlink" title="3.1 单行索引"></a>3.1 单行索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p>返回的是一个 <code>Series</code></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321202323.png" alt="image.png|133"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[[<span class="number">0</span>]]</span><br></pre></td></tr></table></figure>

<p>返回的是一个 <code>DataFrame</code></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321202714.png" alt="image.png|641"></p>
<h3 id="3-2-多行索引"><a href="#3-2-多行索引" class="headerlink" title="3.2 多行索引"></a>3.2 多行索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[[<span class="number">0</span>, <span class="number">5</span>]]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321202820.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="number">3</span>::<span class="number">5</span>]</span><br></pre></td></tr></table></figure>

<p>这里设置了步长</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321202832.png" alt="image.png"></p>
<h3 id="3-3-单列索引"><a href="#3-3-单列索引" class="headerlink" title="3.3 单列索引"></a>3.3 单列索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">&#x27;date&#x27;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>返回的是一个 <code>Series</code></li>
<li>等价的更简单的获取列的方法: <code>df[&#39;date&#39;]</code></li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203009.png" alt="image.png"></p>
<h3 id="3-4-多行索引"><a href="#3-4-多行索引" class="headerlink" title="3.4 多行索引"></a>3.4 多行索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, [<span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;type&#x27;</span>, <span class="string">&#x27;东四&#x27;</span>, <span class="string">&#x27;天坛&#x27;</span>, <span class="string">&#x27;官园&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203117.png" alt="image.png"></p>
<h3 id="3-5-联合索引"><a href="#3-5-联合索引" class="headerlink" title="3.5 联合索引"></a>3.5 联合索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="number">4</span>::<span class="number">5</span>, [<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;type&#x27;</span>, <span class="string">&#x27;东四&#x27;</span>, <span class="string">&#x27;天坛&#x27;</span>, <span class="string">&#x27;官园&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203206.png" alt="image.png"></p>
<h2 id="4-iloc-索引"><a href="#4-iloc-索引" class="headerlink" title="4 iloc 索引"></a>4 <code>iloc</code> 索引</h2><ol>
<li>​<strong>严格基于位置</strong>：<ul>
<li>仅接受整数位置下标，如 <code>0, 1, 2</code>，​<strong>不支持标签</strong>​（如 <code>df.iloc[&#39;a&#39;]</code> 会报错）。</li>
<li>示例：<code>df.iloc[0]</code> → 第 1 行（无论行索引标签是什么）。</li>
</ul>
</li>
<li>​<strong>切片规则</strong>：<ul>
<li>​<strong>左闭右开</strong>：<code>0:3</code> 选取位置 0、1、2 的行/列。</li>
<li>对比 <code>loc</code>：标签切片为闭区间（包含两端）。</li>
</ul>
</li>
<li>​<strong>布尔条件使用</strong>：<ul>
<li>需直接传入布尔数组（长度必须与轴一致），例如：<br>  <code>df.iloc[df[&#39;Age&#39;].values &gt; 30]</code> → 筛选 <code>Age &gt; 30</code> 的行（需用 <code>.values</code> 避免对齐问题）。</li>
</ul>
</li>
</ol>
<table>
<thead>
<tr>
<th>语法格式</th>
<th>功能描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>df.iloc[行位置, 列位置]</code></td>
<td>同时筛选行和列（返回子集）</td>
<td><code>df.iloc[0, 1]</code></td>
</tr>
<tr>
<td><code>df.iloc[行位置]</code></td>
<td>筛选指定行（返回行 Series）</td>
<td><code>df.iloc[2]</code></td>
</tr>
<tr>
<td><code>df.iloc[:, 列位置]</code></td>
<td>筛选指定列（返回列 Series）</td>
<td><code>df.iloc[:, 1:3]</code></td>
</tr>
</tbody></table>
<p><code>iloc</code> 接受的输入类型及用法：</p>
<table>
<thead>
<tr>
<th>输入类型</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>单个位置</strong></td>
<td>整数位置（从 0 开始）</td>
<td><code>df.iloc[0]</code> → 第 1 行</td>
</tr>
<tr>
<td>​<strong>位置列表</strong></td>
<td>整数列表或数组</td>
<td><code>df.iloc[[0, 2]]</code> → 第 1、3 行</td>
</tr>
<tr>
<td>​<strong>位置切片</strong></td>
<td>左闭右开区间（<code>start:end</code>）</td>
<td><code>df.iloc[0:3]</code> → 行 0、1、2</td>
</tr>
<tr>
<td>​<strong>布尔数组</strong></td>
<td>长度与轴一致的布尔条件</td>
<td><code>df.iloc[df[&#39;Age&#39;].values &gt; 30]</code></td>
</tr>
<tr>
<td>​<strong>函数</strong></td>
<td>返回位置、列表或布尔的函数</td>
<td><code>df.iloc[lambda df: [0, 2]]</code></td>
</tr>
</tbody></table>
<h3 id="4-1-单行索引"><a href="#4-1-单行索引" class="headerlink" title="4.1 单行索引"></a>4.1 单行索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">5</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>返回的是一个 <code>Series</code></li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203543.png" alt="image.png|164"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[[<span class="number">5</span>]]</span><br></pre></td></tr></table></figure>

<ul>
<li>返回的是一个 <code>DataFrame</code></li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203653.png" alt="image.png"></p>
<h3 id="4-2-多行索引"><a href="#4-2-多行索引" class="headerlink" title="4.2 多行索引"></a>4.2 多行索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203719.png" alt="image.png"></p>
<h3 id="4-3-单列索引"><a href="#4-3-单列索引" class="headerlink" title="4.3 单列索引"></a>4.3 单列索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[:, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>返回的是一个 <code>Series</code></li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203757.png" alt="image.png"></p>
<p>是原数据中从 0 开始的 第 3 列</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321203912.png" alt="image.png"></p>
<h3 id="4-4-多列索引"><a href="#4-4-多列索引" class="headerlink" title="4.4 多列索引"></a>4.4 多列索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[:, <span class="number">0</span>:<span class="number">10</span>:<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321204012.png"></p>
<h3 id="4-5-联合索引"><a href="#4-5-联合索引" class="headerlink" title="4.5 联合索引"></a>4.5 联合索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[::<span class="number">10</span>, <span class="number">1</span>:<span class="number">20</span>:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321204031.png"></p>
<h2 id="5-布尔索引"><a href="#5-布尔索引" class="headerlink" title="5 布尔索引"></a>5 布尔索引</h2><p>布尔索引通过 ​<strong>条件表达式</strong> 生成布尔值（<code>True</code>/<code>False</code>），DataFrame 仅保留条件为 <code>True</code> 的行。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>示例</th>
<th>注意</th>
</tr>
</thead>
<tbody><tr>
<td>“&amp;”</td>
<td>逻辑与</td>
<td><code>(df.A &gt; 2) &amp; (df.B &lt; 5)</code></td>
<td>每个条件必须用括号括起</td>
</tr>
<tr>
<td>“ | ”</td>
<td>逻辑或</td>
<td><code>(df.A == 0) | (df.B == 0)</code></td>
<td></td>
</tr>
<tr>
<td>“~”</td>
<td>逻辑非</td>
<td><code>~(df.A &gt; 30)</code></td>
<td>取反操作</td>
</tr>
</tbody></table>
<ol>
<li>​<strong>括号不可省略</strong>：<br> 错误写法：<code>df[&#39;A&#39;] &gt; 2 &amp; df[&#39;B&#39;] &lt; 5</code> → 触发 <code>KeyError</code><br> 正确写法：<code>(df[&#39;A&#39;] &gt; 2) &amp; (df[&#39;B&#39;] &lt; 5)</code></li>
<li>​<strong>布尔数组长度</strong>：<br> 条件生成的布尔数组长度必须与 DataFrame 行数一致。</li>
<li>​<strong>避免链式操作</strong>：<br> 错误写法：<code>df[df.A &gt; 2][df.B &lt; 5]</code> → 触发 <code>SettingWithCopyWarning</code><br> 正确写法：<code>df[(df.A &gt; 2) &amp; (df.B &lt; 5)]</code></li>
<li>​<strong>性能优化</strong>：<br> 对大型 DataFrame，优先使用 <code>.loc</code> 或 <code>query()</code> 方法。</li>
</ol>
<h3 id="5-1-基本使用"><a href="#5-1-基本使用" class="headerlink" title="5.1 基本使用"></a>5.1 基本使用</h3><p>最简单的就是直接给出判断的规则进行索引，比如要找出 <code>AQI</code> 的所有行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;type&#x27;</span>]==<span class="string">&#x27;AQI&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321205002.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">&#x27;type&#x27;</span>]==<span class="string">&#x27;AQI&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321205020.png" alt="image.png|399"></p>
<h3 id="5-2-直接使用中括号"><a href="#5-2-直接使用中括号" class="headerlink" title="5.2 直接使用中括号 []"></a>5.2 直接使用中括号 <code>[]</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单条件筛选</span></span><br><span class="line">df[df[<span class="string">&#x27;Age&#x27;</span>] &gt; <span class="number">30</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多条件组合（与）</span></span><br><span class="line">df[(df[<span class="string">&#x27;Age&#x27;</span>] &gt; <span class="number">30</span>) &amp; (df[<span class="string">&#x27;City&#x27;</span>] == <span class="string">&#x27;北京&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多条件组合（或）</span></span><br><span class="line">df[(df[<span class="string">&#x27;Age&#x27;</span>] &lt; <span class="number">18</span>) | (df[<span class="string">&#x27;Age&#x27;</span>] &gt; <span class="number">60</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取反操作</span></span><br><span class="line">df[~(df[<span class="string">&#x27;City&#x27;</span>] == <span class="string">&#x27;上海&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<h3 id="5-3-结合-loc-方法"><a href="#5-3-结合-loc-方法" class="headerlink" title="5.3 结合 .loc 方法"></a>5.3 结合 <code>.loc</code> 方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选行并选择特定列</span></span><br><span class="line">df.loc[df[<span class="string">&#x27;Age&#x27;</span>] &gt; <span class="number">30</span>, [<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复杂条件筛选</span></span><br><span class="line">df.loc[(df[<span class="string">&#x27;Age&#x27;</span>] &gt; <span class="number">30</span>) &amp; (df[<span class="string">&#x27;Gender&#x27;</span>] == <span class="string">&#x27;F&#x27;</span>), :]</span><br></pre></td></tr></table></figure>

<h3 id="5-4-筛选特定值"><a href="#5-4-筛选特定值" class="headerlink" title="5.4 筛选特定值"></a>5.4 筛选特定值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 isin()</span></span><br><span class="line">df[df[<span class="string">&#x27;City&#x27;</span>].isin([<span class="string">&#x27;北京&#x27;</span>, <span class="string">&#x27;上海&#x27;</span>])]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 排除特定值</span></span><br><span class="line">df[~df[<span class="string">&#x27;City&#x27;</span>].isin([<span class="string">&#x27;广州&#x27;</span>])]</span><br></pre></td></tr></table></figure>

<h3 id="5-5-处理缺失值"><a href="#5-5-处理缺失值" class="headerlink" title="5.5 处理缺失值"></a>5.5 处理缺失值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选某列非空的行</span></span><br><span class="line">df[df[<span class="string">&#x27;Salary&#x27;</span>].notna()]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选某列为空的行</span></span><br><span class="line">df[df[<span class="string">&#x27;Salary&#x27;</span>].isna()]</span><br></pre></td></tr></table></figure>

<h3 id="5-6-更新数据"><a href="#5-6-更新数据" class="headerlink" title="5.6 更新数据"></a>5.6 更新数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 Age &gt; 30 的行的 Status 列设为 &#x27;Senior&#x27;</span></span><br><span class="line">df.loc[df[<span class="string">&#x27;Age&#x27;</span>] &gt; <span class="number">30</span>, <span class="string">&#x27;Status&#x27;</span>] = <span class="string">&#x27;Senior&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="数据的清洗"><a href="#数据的清洗" class="headerlink" title="数据的清洗"></a>数据的清洗</h1><h2 id="1-缺失数据处理"><a href="#1-缺失数据处理" class="headerlink" title="1 缺失数据处理"></a>1 缺失数据处理</h2><ul>
<li><code>None</code> 表示空值，<code>None</code> 的类型是 <code>NoneType</code>，它是一个特殊 <code>Python</code> 对象, 并且它不支持任何运算，在 pandas 中使用某些函数的时候会报错。  </li>
<li><code>NaN(Not a Number)</code>，<code>NaN</code> 是没有办法和任何数据进行比较，它和任何值都不相等，包括他自己，它的类型是 <code>float</code>，但是和任何值做计算的结果都是 <code>NaN</code>，并且支持 pandas 中的函数运算。</li>
</ul>
<h3 id="1-1-检测缺失值"><a href="#1-1-检测缺失值" class="headerlink" title="1.1 检测缺失值"></a>1.1 检测缺失值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info() <span class="comment"># 各列缺失概况</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.isnull()  <span class="comment"># 布尔矩阵</span></span><br><span class="line">df.notnull()</span><br></pre></td></tr></table></figure>

<p>返回一个布尔矩阵，如下：</p>
<p>  <img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321210754.png" alt="image.png|296"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.isnull().<span class="built_in">sum</span>() <span class="comment"># 空值统计</span></span><br><span class="line">df.notnull().<span class="built_in">sum</span>() <span class="comment"># 非空值统计</span></span><br><span class="line">df.isnull().<span class="built_in">sum</span>(axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>统计行或列的空值信息，如下：</p>
<p>  <img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321210736.png" alt="image.png|340"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isnull().<span class="built_in">all</span>(axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>检测数据中是否整行全为缺失值</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321211034.png" alt="image.png|216"></p>
<h3 id="1-2-删除缺失值"><a href="#1-2-删除缺失值" class="headerlink" title="1.2 删除缺失值"></a>1.2 删除缺失值</h3><h4 id="1-2-1-Drop"><a href="#1-2-1-Drop" class="headerlink" title="1.2.1 Drop"></a>1.2.1 Drop</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220219180232.png"></p>
<p>删除某一列，下面两种写法等价</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.drop(columns=<span class="string">&#x27;date&#x27;</span>)</span><br><span class="line">df.drop(<span class="string">&#x27;date&#x27;</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-2-2-Dropna"><a href="#1-2-2-Dropna" class="headerlink" title="1.2.2 Dropna"></a>1.2.2 Dropna</h4><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220218153247.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除含缺失值的行（默认axis=0）</span></span><br><span class="line">df.dropna()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有值都为缺失的列              </span></span><br><span class="line">df.dropna(axis=<span class="number">1</span>, how=<span class="string">&#x27;all&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 保留至少3个非缺失值的行</span></span><br><span class="line">df.dropna(thresh=<span class="number">3</span>)  </span><br></pre></td></tr></table></figure>

<h3 id="1-3-填充缺失值"><a href="#1-3-填充缺失值" class="headerlink" title="1.3 填充缺失值"></a>1.3 填充缺失值</h3><p>缺失数据较少的情况下，可对数据进行填充。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220219234812.png" alt="|746"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 固定值填充</span></span><br><span class="line">df.fillna(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 前向填充（用前一个有效值）</span></span><br><span class="line">df.fillna(method=<span class="string">&#x27;ffill&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 后向填充（用后一个有效值） </span></span><br><span class="line">df.fillna(method=<span class="string">&#x27;bfill&#x27;</span>)   </span><br><span class="line"></span><br><span class="line"><span class="comment"># 列均值填充</span></span><br><span class="line">df[<span class="string">&#x27;B&#x27;</span>].fillna(df[<span class="string">&#x27;B&#x27;</span>].mean(), inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插值法（线性插值）</span></span><br><span class="line">df[<span class="string">&#x27;A&#x27;</span>].interpolate(method=<span class="string">&#x27;linear&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321214059.png" alt="image.png|494"></p>
<p>除了直接使用固定的数字来填充以外，我们还可以使用一些常用的算法，比如<strong>线性插值</strong>等来进行填充。尤其当我们所面对的数据在时间或者空间比较近的位置有缺测值的时候可以使用这种方式来进行填充。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220219234820.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.interpolate()</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/QQ_1742564727604.png" alt="QQ_1742564727604.png"></p>
<h2 id="2-重复值处理"><a href="#2-重复值处理" class="headerlink" title="2 重复值处理"></a>2 重复值处理</h2><p>简单来说，数据去重指的是删除重复数据。在一个数字文件集合中，找出重复的数据并将其删除，只保存唯一的数据单元。在我们的数据预处理过程中，这是一项我们经常需要进行的操作。</p>
<h3 id="2-1-duplicated-检测重复行"><a href="#2-1-duplicated-检测重复行" class="headerlink" title="2.1 duplicated() 检测重复行"></a>2.1 <code>duplicated()</code> 检测重复行</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220221104405.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321215119.png" alt="image.png"></p>
<p>默认标记第一次出现的重复行为 False，后续为 True</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.duplicated()  </span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321215139.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df.duplicated(</span><br><span class="line">    subset=[<span class="string">&#x27;product&#x27;</span>,<span class="string">&#x27;price&#x27;</span>],  <span class="comment"># 指定判断列（默认为全部列）</span></span><br><span class="line">    keep=<span class="string">&#x27;last&#x27;</span>                  <span class="comment"># 标记最后一次出现的为False（可选&#x27;first&#x27;/&#x27;last&#x27;/False)</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321215221.png" alt="image.png"></p>
<h3 id="2-2-drop-duplicates-删除重复行"><a href="#2-2-drop-duplicates-删除重复行" class="headerlink" title="2.2 drop_duplicates() 删除重复行"></a>2.2 <code>drop_duplicates()</code> 删除重复行</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220221103403.png"></p>
<p>这个方法默认是去除每一行中的重复行，可以指定特定的去重的 <code>columns</code> 参数位 <code>subset</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认删除完全重复行，保留第一条</span></span><br><span class="line">cleaned_df = df.drop_duplicates() </span><br><span class="line"><span class="comment"># 删除所有重复项（包括保留项）</span></span><br><span class="line">df.drop_duplicates(keep=<span class="literal">False</span>)  <span class="comment"># 等价于删除全部重复记录</span></span><br></pre></td></tr></table></figure>

<p>删除特定列重复</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除特定列重复</span></span><br><span class="line">df.drop_duplicates(subset=[<span class="string">&#x27;product&#x27;</span>], keep=<span class="string">&#x27;last&#x27;</span>) </span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321215348.png" alt="image.png"></p>
<p>或者使用如下方式筛选</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="string">&#x27;price&#x27;</span>] == <span class="number">30</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321215710.png" alt="image.png"></p>
<h2 id="3-数据替换"><a href="#3-数据替换" class="headerlink" title="3 数据替换"></a>3 数据替换</h2><h3 id="3-1-replace"><a href="#3-1-replace" class="headerlink" title="3.1 replace"></a>3.1 replace</h3><p>基于固定值的简单替换（一对一或字典映射）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单值替换</span></span><br><span class="line">df.replace(np.nan, -<span class="number">9999</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 正则表达式简单匹配</span></span><br><span class="line">df[<span class="string">&#x27;text&#x27;</span>].replace(<span class="string">r&#x27;\d+&#x27;</span>, <span class="string">&#x27;NUM&#x27;</span>, regex=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-2-apply-与-applymap"><a href="#3-2-apply-与-applymap" class="headerlink" title="3.2 apply 与 applymap"></a>3.2 apply 与 applymap</h3><p><code>replace</code> 可以进行简单的数据替换，但如果想进行更为复杂的操作 <code>replace</code> 是无法完成的。  然而对 <code>DataFrame</code> 而言，<code>apply</code> 是非常重要的数据处理方法，它可以接收各种各样的函数（<code>Python</code> 内置的或自定义的），处理方式很灵活，完成各种复杂的需求。他的实际作用是将函数作为一个对象，通过 <code>apply</code> 的调用对 <code>DataFrame</code> 里的数组元素应用这个函数。</p>
<p>我们现在设想这样一个需求，我们想把 AQI 的数值转换成日产中常说的空气质量等级，也就是优、良、轻度污染，重度污染，重度污染，严重污染。常规方法来说需要写一个循环，从 DataFrame 中取出这些数值，再根据相应的规则将 AQI 依次转为空气质量的类别。  </p>
<p>那么现在如果尝试方法呢，我们可以这样想：能不能只关注和设置这个规则，循环这种事情交给编程语言去处理呢？当然可以。当编程人员只关心规则（规则可能是一个条件，或者由某一个 function 来定义），代码将大大简化，可读性也更强。  </p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/v2-2294cf2d277863fbe117757f3f8bd63f_b.jpg"></p>
<p>下面就带大家来实现这个需求</p>
<p>定义一个分类函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">aqi_level</span>(<span class="params">aqi</span>):</span><br><span class="line">    <span class="keyword">if</span> aqi&gt;<span class="number">0</span> <span class="keyword">and</span> aqi&lt;=<span class="number">50</span>:</span><br><span class="line">        level = <span class="string">&#x27;优&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> aqi&gt;<span class="number">50</span> <span class="keyword">and</span> aqi&lt;=<span class="number">100</span>:</span><br><span class="line">        level = <span class="string">&#x27;良&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> aqi&gt;<span class="number">100</span> <span class="keyword">and</span> aqi&lt;=<span class="number">150</span>:</span><br><span class="line">        level = <span class="string">&#x27;轻度污染&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> aqi&gt;<span class="number">150</span> <span class="keyword">and</span> aqi&lt;=<span class="number">200</span>:</span><br><span class="line">        level = <span class="string">&#x27;中度污染&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> aqi&gt;<span class="number">200</span> <span class="keyword">and</span> aqi&lt;=<span class="number">300</span>:</span><br><span class="line">        level = <span class="string">&#x27;重度污染&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        level = <span class="string">&#x27;严重污染&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> level</span><br></pre></td></tr></table></figure>

<p>先把数据筛选一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aqi = df[df[<span class="string">&#x27;type&#x27;</span>]==<span class="string">&#x27;AQI&#x27;</span>]</span><br><span class="line">aqi</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321220435.png" alt="image.png"></p>
<p>应用一列试试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi[<span class="string">&#x27;东四&#x27;</span>].apply(aqi_level)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321220514.png" alt="image.png"></p>
<p>去除 3 列不要的字段</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi.loc[:, ~aqi.columns.isin([<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;type&#x27;</span>])]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321220832.png" alt="image.png|351"></p>
<p>在此基础上，按列 <code>(axis=0</code>) 方向计算均值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi.loc[:, ~aqi.columns.isin([<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;type&#x27;</span>])].apply(np.mean, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>也可以使用 <code>applymap</code> 对所有值进行转换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi.loc[:, ~aqi.columns.isin([<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;type&#x27;</span>])].applymap(aqi_level)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321220949.png" alt="image.png"></p>
<p>上面介绍过 <code>apply</code> 函数在 <code>series</code> 中的应用，是依次对 <code>series</code> 中每个元素运行函数，除此以外，<code>apply()</code> 函数还可以在 <code>dataframe</code> 上应用，是对 <code>datafram</code> 中每个 <code>series</code> 进行应用，下面让我来学习一下。</p>
<p>先定义一个方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x[<span class="string">&#x27;东四&#x27;</span>] + x[<span class="string">&#x27;天坛&#x27;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>让东四和天坛相加</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi.apply(add, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250321221650.png" alt="image.png"></p>
<h1 id="时间字符串的处理"><a href="#时间字符串的处理" class="headerlink" title="时间字符串的处理"></a>时间字符串的处理</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1 简介"></a>1 简介</h2><h3 id="1-1-1、Python-原生-datetime-模块"><a href="#1-1-1、Python-原生-datetime-模块" class="headerlink" title="1.1 1、Python 原生 datetime 模块"></a>1.1 1、Python 原生 <code>datetime</code> 模块</h3><ul>
<li>​<strong>优势</strong>：<ul>
<li>语法直观，提供完整的日期时间操作（如 <code>date</code>、<code>datetime</code>、<code>time</code>、<code>timedelta</code> 等对象）。</li>
<li>丰富的格式化（<code>strftime</code>/<code>strptime</code>）与时区操作（<code>pytz</code> 集成）。</li>
</ul>
</li>
<li>​<strong>缺陷</strong>：<ul>
<li>单对象处理，无法直接向量化操作（如批量计算、时间窗口分析）。</li>
<li>存储效率低，不适合大规模时间序列数据。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="1-2-、NumPy-的-datetime64-类型"><a href="#1-2-、NumPy-的-datetime64-类型" class="headerlink" title="1.2 、NumPy 的 datetime64 类型"></a>1.2 、NumPy 的 <code>datetime64</code> 类型</h3><ul>
<li>​<strong>优化点</strong>：<ul>
<li>将时间编码为 ​<strong>64 位整数</strong>，支持高效的数组化存储与计算。</li>
<li>提供纳秒级精度，适合科学计算和数值型时间操作。</li>
</ul>
</li>
<li>​<strong>局限性</strong>：<ul>
<li>缺少高级时间逻辑（如日期偏移、重采样）。</li>
<li>时间格式转换和时区处理需要额外代码。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="1-3-​3、Pandas-时间序列"><a href="#1-3-​3、Pandas-时间序列" class="headerlink" title="1.3 ​3、Pandas 时间序列"></a>1.3 ​3、Pandas 时间序列</h3><p><strong>Pandas 融合了 <code>datetime</code> 的灵活性与 <code>datetime64</code> 的高效性，是时间序列分析的终极工具。​</strong></p>
<p><span style="color: #9c88ff; font-weight: 550;">时间数据类型：</span></p>
<ul>
<li>​<strong>时间戳（Timestamp）​</strong>：表示具体的时间点（如 <code>2023-10-05 08:30:00</code>），用于定位数据到某一瞬间。</li>
<li>​<strong>时间段（Period）​</strong>：表示一个固定的时间区间（如 <code>2023-10</code> 表示整个 10 月），基于 <code>numpy.datetime64</code> 编码，具有明确的频率（年、月、日、小时等）。</li>
<li>​<strong>时间增量（Timedelta）​</strong>：时间间隔（如 <code>22.56秒</code>）。</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220305100641.png"></p>
<h2 id="2-时间戳-Timestamp"><a href="#2-时间戳-Timestamp" class="headerlink" title="2 时间戳 Timestamp"></a>2 时间戳 <code>Timestamp</code></h2><p>对于时间戳，<code>Pandas</code> 提供 <code>Timestamp</code> 类型。 如前所述，它本质上是 <code>Python</code> 原生 <code>datetime</code> 的替代品，但它基于更高效的 <code>numpy.datetime64</code> 数据类型。 相关的索引结构是 <code>DatetimeIndex</code>。</p>
<h3 id="2-1-生成时间戳"><a href="#2-1-生成时间戳" class="headerlink" title="2.1 生成时间戳"></a>2.1 生成时间戳</h3><p><code>Timestamp</code> 和 <code>DatetimeIndex</code> 是最基本的对象。虽然可以直接调用这些类对象，但更常见的是使用 <code>pd.to_datetime()</code> 函数，它可以解析各种格式。将单个日期传递给 <code>pd.to_datetime()</code> 就可以生成 <code>Timestamp</code>；默认情况下传递一系列日期会产生一个 <code>DatetimeIndex</code></p>
<ul>
<li><code>pd.Timestamp()</code>：直接创建单个时间点。</li>
<li><code>pd.to_datetime()</code>：解析字符串或序列，支持自定义格式（<code>format=&#39;%Y%m%d&#39;</code>）</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220304144848.png" alt="|713"></p>
<p><a target="_blank" rel="noopener" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">format格式详解</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd.Timestamp(<span class="string">&quot;2020/12/06&quot;</span>)</span><br><span class="line">pd.Timestamp(<span class="string">&quot;2020-12-06&quot;</span>)</span><br><span class="line">pd.Timestamp(year=<span class="number">2020</span>,month=<span class="number">12</span>,day=<span class="number">6</span>,hour=<span class="number">0</span>,minute=<span class="number">0</span>,second=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322160757.png" alt="image.png"></p>
<p>但是传入 <code>20201206</code></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322161030.png" alt="image.png|453"></p>
<p>这是需要使用 <code>pd.to_datetime</code>，并指定 <code>format</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">date = pd.to_datetime(<span class="number">20201206</span>, <span class="built_in">format</span>=<span class="string">&#x27;%Y%m%d&#x27;</span>)</span><br><span class="line">date</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322161153.png" alt="image.png"></p>
<p>注意这里的返回的类型是 <code>TimeStamp</code>，故可以调用 <code>TimeStamp</code> 的 <a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/reference/api/pandas.Timestamp.html#pandas.Timestamp">属性  </a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">date.year, date.month, date.day      <span class="comment"># 年、月、日</span></span><br><span class="line">date.hour, date.minute, date.second  <span class="comment"># 时、分、秒</span></span><br><span class="line">date.week, date.weekofyear           <span class="comment"># 周数</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-生成时间序列"><a href="#2-2-生成时间序列" class="headerlink" title="2.2 生成时间序列"></a>2.2 生成时间序列</h3><p>以上我们都是在对单个时间点进行操作，为了更方便地创建常规日期序列，<code>Pandas</code> 为此提供 <code>pd.date_range()</code> 用来直接创建一个时间序列，</p>
<ul>
<li><code>pd.date_range()</code>：生成连续时间序列，支持频率参数（<code>freq</code>）。</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220305223643.png"></p>
<p>具体的频率参数：  </p>
<p><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects">Time series / date functionality — pandas 2.2.3 documentation</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成每小时时间序列，或固定周期数</span></span><br><span class="line">pd.date_range(start=<span class="string">&#x27;2020-01-01&#x27;</span>, end=<span class="string">&#x27;2020-02-08&#x27;</span>, freq=<span class="string">&#x27;h&#x27;</span>) <span class="comment"># 在范围内每1小时一个采样点</span></span><br><span class="line">pd.date_range(start=<span class="string">&#x27;2020-01-01&#x27;</span>, periods=<span class="number">24</span>, freq=<span class="string">&#x27;3h&#x27;</span>)  <span class="comment"># 每3小时一个采样点，共24个点</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322162736.png" alt="image.png|622"></p>
<h3 id="2-3-时间的索引"><a href="#2-3-时间的索引" class="headerlink" title="2.3 时间的索引"></a>2.3 时间的索引</h3><ul>
<li>将 DataFrame 的列转换为时间索引，支持高效切片：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, parse_dates=&#123;<span class="string">&#x27;time&#x27;</span>: [<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>]&#125;)</span><br><span class="line">df.index = df[<span class="string">&#x27;time&#x27;</span>]</span><br><span class="line">df[<span class="string">&#x27;2020-01-01 20:00&#x27;</span>:<span class="string">&#x27;2020-01-01 22:00&#x27;</span>]  <span class="comment"># 按时间范围切片</span></span><br></pre></td></tr></table></figure>

<ul>
<li>读取时合并日期与小时列，并补零处理：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, </span><br><span class="line">            parse_dates=&#123;<span class="string">&#x27;time&#x27;</span>: [<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>]&#125;, </span><br><span class="line">            converters=&#123;<span class="string">&#x27;hour&#x27;</span>: <span class="keyword">lambda</span> x: x.zfill(<span class="number">2</span>)&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="3-时间周期-Period"><a href="#3-时间周期-Period" class="headerlink" title="3 时间周期 Period"></a>3 时间周期 <code>Period</code></h2><p>对于时间周期，<code>Pandas</code> 提供 <code>Period</code> 类型。这基于 <code>numpy.datetime64</code> 编码固定频率的间隔。 相关的索引结构是 <code>PeriodIndex</code>。</p>
<p><span style="color: #badc58; font-weight: 550;">关键特性</span></p>
<ul>
<li>​<strong>固定频率</strong>：每个 <code>Period</code> 对象必须明确频率（如年 -Y、月 -M、日 -D、小时 -H、秒 -S），<strong>运算需频率一致</strong>。</li>
<li>​<strong>不可变性</strong>：创建后不可修改，只能生成新对象。</li>
<li>​<strong>时间范围</strong>：自动覆盖整个频率区间（如 <code>freq=&#39;M&#39;</code> 时，<code>2023-10</code> 表示整个 10 月）。</li>
</ul>
<p><span style="color: #badc58; font-weight: 550;">应用场景</span></p>
<ul>
<li>​<strong>时间序列聚合</strong>：按固定周期（如按月、季度）统计数据。</li>
<li>​<strong>周期计算</strong>：计算跨时间段的偏移量（如“3 个月后”）。</li>
<li>​<strong>索引结构</strong>：结合 <code>PeriodIndex</code> 构建时间序列数据集。</li>
</ul>
<h3 id="3-1-生成时间周期"><a href="#3-1-生成时间周期" class="headerlink" title="3.1 生成时间周期"></a>3.1 生成时间周期</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220305223653.png" alt="|638"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd.Period(<span class="string">&quot;2020/12/06&quot;</span>)          <span class="comment"># 默认频率为 &#x27;D&#x27;（日）</span></span><br><span class="line">pd.Period(<span class="string">&quot;2020/12/06&quot;</span>, freq=<span class="string">&#x27;h&#x27;</span>) <span class="comment"># 频率为小时（&#x27;H&#x27;）</span></span><br><span class="line">pd.Period(freq=<span class="string">&#x27;s&#x27;</span>, year=<span class="number">2015</span>, month=<span class="number">3</span>, day=<span class="number">19</span>, hour=<span class="number">10</span>, minute=<span class="number">43</span>)  <span class="comment"># 精确到秒（需完整时间参数）</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">time = pd.Period(<span class="string">&quot;2020-12-06&quot;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">time - <span class="number">3</span>  <span class="comment"># 3天前 → Period(&#x27;2020-12-03&#x27;, &#x27;D&#x27;)</span></span><br><span class="line"></span><br><span class="line">time = pd.Period(<span class="string">&quot;2015-03-19 10:43:00&quot;</span>, freq=<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">time + <span class="number">15</span> <span class="comment"># 15秒后 → Period(&#x27;2015-03-19 10:43:15&#x27;, &#x27;S&#x27;)</span></span><br></pre></td></tr></table></figure>

<p><code>Period</code> 可以调用的属性：  </p>
<p><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Period.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Period.html</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">&quot;2023-10-05&quot;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">p.year    <span class="comment"># 2023</span></span><br><span class="line">p.month   <span class="comment"># 10</span></span><br><span class="line">p.day     <span class="comment"># 5</span></span><br><span class="line">p.freq    <span class="comment"># &lt;Day&gt;</span></span><br><span class="line">p.freqstr <span class="comment"># &#x27;D&#x27;（频率字符串表示）</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-生成时间序列"><a href="#3-2-生成时间序列" class="headerlink" title="3.2 生成时间序列"></a>3.2 生成时间序列</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220305223658.png"></p>
<table>
<thead>
<tr>
<th>别名</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>D</code></td>
<td>日</td>
</tr>
<tr>
<td><code>M</code></td>
<td>月（月末）</td>
</tr>
<tr>
<td><code>Q</code></td>
<td>季度</td>
</tr>
<tr>
<td><code>A</code></td>
<td>年</td>
</tr>
<tr>
<td><code>H</code></td>
<td>小时</td>
</tr>
<tr>
<td><code>T</code></td>
<td>分钟</td>
</tr>
</tbody></table>
<p>从 2010 年 1 月开始，每隔 3 个月生成一个周期，共生成 8 个周期</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dates = pd.period_range(start=<span class="string">&#x27;2010-01&#x27;</span>, freq=<span class="string">&#x27;3M&#x27;</span>, periods=<span class="number">8</span>)  </span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322170728.png" alt="image.png"></p>
<p>每个周期按 ​<strong>3 个月</strong> 的频率单位向后偏移 ​<strong>1 个单位</strong>​（即加 3 个月）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dates + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322170804.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dates.astype(<span class="string">&#x27;period[M]&#x27;</span>) - <span class="number">1</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>astype(&#39;period[M]&#39;)</code> 将周期转换为 ​<strong>月度频率</strong>​（<code>freq=&#39;M&#39;</code>）。</li>
<li>每个周期按 ​<strong>1 个月</strong> 的频率单位向前偏移 ​<strong>1 个单位</strong>​（即减 1 个月）。</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322170826.png" alt="image.png"></p>
<h2 id="4-时间增量"><a href="#4-时间增量" class="headerlink" title="4 时间增量"></a>4 时间增量</h2><table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>Timedelta</strong></td>
<td>表示时间增量（如 1 天、3 小时），基于 <code>numpy.timedelta64</code>，固定时间长度。</td>
<td>不考虑日历规则（如 1 天=24 小时，1 月=30 天）。</td>
</tr>
<tr>
<td>​<strong>DateOffset</strong></td>
<td>表示日历敏感的日期偏移（如 1 年、2 个月），基于日历规则。</td>
<td>考虑实际日历（如 1 天可能为 23/24/25 小时，1 月按实际天数，闰年自动处理）。</td>
</tr>
</tbody></table>
<h3 id="4-1-生成时间增量（Timedelta）"><a href="#4-1-生成时间增量（Timedelta）" class="headerlink" title="4.1 生成时间增量（Timedelta）"></a>4.1 生成时间增量（<code>Timedelta</code>）</h3><p>对于时间增量或间隔，Pandas 提供 <code>Timedelta</code> 类型，用于提供时间增量计算功能。 <code>Timedelta</code> 是 <code>Python</code> 原生 <code>datetime.timedelta</code> 类型的更有效的替代品，它基于 <code>numpy.timedelta64</code>。相关的索引结构是 <code>TimedeltaIndex</code>。</p>
<p><code>DateOffset</code> 表示的也是时间增量。它和 <code>Timedelta</code> 很类似，但是有特殊的日历规则。比如 <code>Timedelta</code> 一天肯定是 24 小時，而在 <code>DateOffset</code> 中根据夏令时的不同，一天可能会有 23，24 或者 25 小時。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220305224314.png"></p>
<h4 id="4-1-1-创建-Timedelta-对象"><a href="#4-1-1-创建-Timedelta-对象" class="headerlink" title="4.1.1 创建 Timedelta 对象"></a>4.1.1 创建 <code>Timedelta</code> 对象</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本语法</span></span><br><span class="line">pd.Timedelta(value, unit=<span class="string">&#x27;D&#x27;</span>)  <span class="comment"># unit: D（天）、h（小时）、m（分钟）、s（秒）、ms（毫秒）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">td1 = pd.Timedelta(<span class="number">1</span>, unit=<span class="string">&#x27;D&#x27;</span>)        <span class="comment"># 1天 → Timedelta(&#x27;1 days 00:00:00&#x27;)</span></span><br><span class="line">td2 = pd.Timedelta(days=<span class="number">2</span>, hours=<span class="number">3</span>)    <span class="comment"># 2天3小时 → Timedelta(&#x27;2 days 03:00:00&#x27;)</span></span><br><span class="line">td3 = pd.Timedelta(<span class="string">&#x27;3 days 12:30:45&#x27;</span>)  <span class="comment"># 字符串直接解析 → Timedelta(&#x27;3 days 12:30:45&#x27;)</span></span><br></pre></td></tr></table></figure>

<h4 id="4-1-2-时间运算"><a href="#4-1-2-时间运算" class="headerlink" title="4.1.2 时间运算"></a>4.1.2 时间运算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 与 Period 结合</span></span><br><span class="line">period = pd.Period(<span class="string">&quot;2020-12-06&quot;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">new_period = period + pd.Timedelta(days=<span class="number">2</span>)  <span class="comment"># Period(&#x27;2020-12-08&#x27;, &#x27;D&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 与 Timestamp 结合</span></span><br><span class="line">ts = pd.Timestamp(<span class="string">&quot;2020-12-06 08:00&quot;</span>)</span><br><span class="line">new_ts = ts + pd.Timedelta(hours=<span class="number">2</span>)        <span class="comment"># Timestamp(&#x27;2020-12-06 10:00:00&#x27;)</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-日期偏移（DateOffset）"><a href="#4-2-日期偏移（DateOffset）" class="headerlink" title="4.2 日期偏移（DateOffset）"></a>4.2 日期偏移（DateOffset）</h3><h4 id="4-2-1-创建-DateOffset-对象"><a href="#4-2-1-创建-DateOffset-对象" class="headerlink" title="4.2.1 创建 DateOffset 对象"></a>4.2.1 创建 <code>DateOffset</code> 对象</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本语法</span></span><br><span class="line">offset = pd.DateOffset(years=<span class="number">2</span>, months=<span class="number">1</span>, days=<span class="number">1</span>)  <span class="comment"># 2年1个月1天</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">ts = pd.Timestamp(<span class="string">&quot;2020-08-06&quot;</span>)</span><br><span class="line">new_ts = ts + offset  <span class="comment"># Timestamp(&#x27;2022-09-07 00:00:00&#x27;)（考虑月份进位）</span></span><br></pre></td></tr></table></figure>

<h4 id="4-2-2-与-Timedelta-的区别"><a href="#4-2-2-与-Timedelta-的区别" class="headerlink" title="4.2.2 与 Timedelta 的区别"></a>4.2.2 与 <code>Timedelta</code> 的区别</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例：增加1个月（DateOffset考虑实际月份天数）</span></span><br><span class="line">ts = pd.Timestamp(<span class="string">&quot;2020-01-31&quot;</span>)</span><br><span class="line">ts1 = ts + pd.DateOffset(months=<span class="number">1</span>)  <span class="comment"># 2020-02-29（自动处理月末）</span></span><br><span class="line">ts2 = ts + pd.Timedelta(days=<span class="number">30</span>)    <span class="comment"># 2020-03-02（固定30天）</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>操作类型</th>
<th>Timedelta</th>
<th>DateOffset</th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>1 天</strong></td>
<td>固定 24 小时</td>
<td>可能 23/24/25 小时（夏令时调整）</td>
</tr>
<tr>
<td>​<strong>1 月</strong></td>
<td>固定 30 天</td>
<td>实际月份天数（如 28-31 天）</td>
</tr>
<tr>
<td>​<strong>闰年处理</strong></td>
<td>无</td>
<td>自动处理闰年</td>
</tr>
<tr>
<td>​<strong>月末处理</strong></td>
<td>简单加法（可能导致非法日期）</td>
<td>自动调整为月末</td>
</tr>
</tbody></table>
<h3 id="4-3-时间增量索引（TimedeltaIndex）"><a href="#4-3-时间增量索引（TimedeltaIndex）" class="headerlink" title="4.3 时间增量索引（TimedeltaIndex）"></a>4.3 时间增量索引（<code>TimedeltaIndex</code>）</h3><p><a target="_blank" rel="noopener" href="https://www.gairuo.com/p/pandas-timedelta-index">pandas 时长索引 | pandas 教程 - 盖若</a></p>
<h4 id="4-3-1-创建-TimedeltaIndex"><a href="#4-3-1-创建-TimedeltaIndex" class="headerlink" title="4.3.1 创建 TimedeltaIndex"></a>4.3.1 创建 <code>TimedeltaIndex</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接生成</span></span><br><span class="line">tidx1 = pd.TimedeltaIndex([<span class="string">&#x27;0 days&#x27;</span>, <span class="string">&#x27;10 days&#x27;</span>, <span class="string">&#x27;20 days&#x27;</span>])</span><br><span class="line"><span class="comment"># 输出: TimedeltaIndex([&#x27;0 days&#x27;, &#x27;10 days&#x27;, &#x27;20 days&#x27;], dtype=&#x27;timedelta64[ns]&#x27;, freq=None)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 pd.timedelta_range 生成</span></span><br><span class="line">tidx2 = pd.timedelta_range(start=<span class="string">&#x27;1 day&#x27;</span>, periods=<span class="number">4</span>, freq=<span class="string">&#x27;6H&#x27;</span>)</span><br><span class="line"><span class="comment"># 输出: TimedeltaIndex([&#x27;1 days 00:00:00&#x27;, &#x27;1 days 06:00:00&#x27;, ..., &#x27;1 days 18:00:00&#x27;], freq=&#x27;6H&#x27;)</span></span><br></pre></td></tr></table></figure>

<h4 id="4-3-2-参数说明"><a href="#4-3-2-参数说明" class="headerlink" title="4.3.2 参数说明"></a>4.3.2 参数说明</h4><table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>start</code></td>
<td>起始时间增量（默认 0）</td>
<td><code>start=&#39;1 day&#39;</code></td>
</tr>
<tr>
<td><code>end</code></td>
<td>结束时间增量</td>
<td><code>end=&#39;2 days&#39;</code></td>
</tr>
<tr>
<td><code>periods</code></td>
<td>生成的周期数</td>
<td><code>periods=4</code> → 生成 4 个时间点</td>
</tr>
<tr>
<td><code>freq</code></td>
<td>频率（如 ‘D’, ‘6H’, ‘30T’）</td>
<td><code>freq=&#39;6H&#39;</code> → 每 6 小时</td>
</tr>
<tr>
<td><code>closed</code></td>
<td>区间闭合方式（’left’, ‘right’）</td>
<td><code>closed=&#39;right&#39;</code> → 不包含起始点</td>
</tr>
</tbody></table>
<h4 id="4-3-3-生成示例"><a href="#4-3-3-生成示例" class="headerlink" title="4.3.3 生成示例"></a>4.3.3 生成示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成4个间隔，从1天开始，频率为6小时</span></span><br><span class="line">tidx3 = pd.timedelta_range(start=<span class="string">&#x27;1 day&#x27;</span>, periods=<span class="number">4</span>, freq=<span class="string">&#x27;6H&#x27;</span>)</span><br><span class="line"><span class="comment"># 输出: [&#x27;1 days 00:00:00&#x27;, &#x27;1 days 06:00:00&#x27;, &#x27;1 days 12:00:00&#x27;, &#x27;1 days 18:00:00&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定结束时间和周期数</span></span><br><span class="line">tidx4 = pd.timedelta_range(start=<span class="string">&#x27;1 day&#x27;</span>, end=<span class="string">&#x27;5 days&#x27;</span>, periods=<span class="number">4</span>)</span><br><span class="line"><span class="comment"># 输出: 均匀间隔 → [&#x27;1 days&#x27;, &#x27;2 days 08:00:00&#x27;, &#x27;3 days 16:00:00&#x27;, &#x27;5 days&#x27;]</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4-应用场景"><a href="#4-4-应用场景" class="headerlink" title="4.4 应用场景"></a>4.4 应用场景</h3><h4 id="4-4-1-时间序列偏移"><a href="#4-4-1-时间序列偏移" class="headerlink" title="4.4.1 时间序列偏移"></a>4.4.1 时间序列偏移</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 批量偏移时间戳</span></span><br><span class="line">ts_series = pd.date_range(<span class="string">&#x27;2023-01-01&#x27;</span>, periods=<span class="number">3</span>)</span><br><span class="line">new_series = ts_series + pd.Timedelta(days=<span class="number">2</span>)  <span class="comment"># 所有时间戳后移2天</span></span><br></pre></td></tr></table></figure>

<h4 id="4-4-2-生成时间差序列"><a href="#4-4-2-生成时间差序列" class="headerlink" title="4.4.2 生成时间差序列"></a>4.4.2 生成时间差序列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算事件间隔</span></span><br><span class="line">events = pd.Series([pd.Timestamp(<span class="string">&#x27;2023-01-01&#x27;</span>), pd.Timestamp(<span class="string">&#x27;2023-01-03&#x27;</span>)])</span><br><span class="line">diffs = events.diff()  <span class="comment"># 生成 Timedelta 序列 → [NaT, &#x27;2 days&#x27;]</span></span><br></pre></td></tr></table></figure>

<h4 id="4-4-3-周期性任务调度"><a href="#4-4-3-周期性任务调度" class="headerlink" title="4.4.3 周期性任务调度"></a>4.4.3 周期性任务调度</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成任务执行时间点</span></span><br><span class="line">schedule = pd.timedelta_range(start=<span class="string">&#x27;09:00:00&#x27;</span>, end=<span class="string">&#x27;18:00:00&#x27;</span>, freq=<span class="string">&#x27;3H&#x27;</span>)</span><br><span class="line"><span class="comment"># 输出: [&#x27;09:00:00&#x27;, &#x27;12:00:00&#x27;, &#x27;15:00:00&#x27;, &#x27;18:00:00&#x27;]</span></span><br></pre></td></tr></table></figure>

<h1 id="向量化字符串"><a href="#向量化字符串" class="headerlink" title="向量化字符串"></a>向量化字符串</h1><h2 id="1-Python-中字符串方法"><a href="#1-Python-中字符串方法" class="headerlink" title="1 Python 中字符串方法"></a>1 Python 中字符串方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;1,000(万元人民币)&#x27;</span></span><br><span class="line"></span><br><span class="line">s.replace(<span class="string">&#x27;(万元人民币)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># 输出: &#x27;1,000&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span>.join(s.replace(<span class="string">&#x27;(万元人民币)&#x27;</span>, <span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;,&#x27;</span>))  <span class="comment"># 输出: &#x27;1000&#x27;</span></span><br><span class="line"></span><br><span class="line">s.__contains__(<span class="string">&#x27;人民币&#x27;</span>)  <span class="comment"># 输出: True</span></span><br><span class="line"><span class="comment"># 等效方法</span></span><br><span class="line"><span class="string">&#x27;人民币&#x27;</span> <span class="keyword">in</span> s  <span class="comment"># 输出: True</span></span><br></pre></td></tr></table></figure>

<h2 id="2-pandas-向量化字符方法"><a href="#2-pandas-向量化字符方法" class="headerlink" title="2 pandas 向量化字符方法"></a>2 pandas 向量化字符方法</h2><p><code>Python</code> 内置一系列强大的字符串处理方法，但这些方法只能处理单个字符串，处理一个序列的字符串时，需要用到 <code>for</code> 循环。</p>
<p>那么，有没有办法，不用循环就能同时处理多个字符串呢，<code>pandas</code> 的向量化操作就提供了这样的方法。</p>
<p><strong>优势</strong>：无需循环，直接操作整个 <code>Series</code>/<code>列</code>，自动处理缺失值（<code>NaN</code>）<br><strong>核心接口</strong>：通过 <code>.str</code> 访问器调用字符串方法</p>
<table>
<thead>
<tr>
<th>Python 方法</th>
<th>Pandas 向量化方法</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>s.replace(a, b)</code></td>
<td><code>ser.str.replace(a, b)</code></td>
<td>替换子串</td>
</tr>
<tr>
<td><code>s.split(sep)</code></td>
<td><code>ser.str.split(sep)</code></td>
<td>按分隔符拆分字符串</td>
</tr>
<tr>
<td><code>sep.join(list)</code></td>
<td><code>ser.str.join(sep)</code></td>
<td>连接列表元素</td>
</tr>
<tr>
<td><code>&#39;a&#39; in s</code></td>
<td><code>ser.str.contains(&#39;a&#39;)</code></td>
<td>检测子串存在性</td>
</tr>
<tr>
<td><code>s.startswith(&#39;a&#39;)</code></td>
<td><code>ser.str.startswith(&#39;a&#39;)</code></td>
<td>检测前缀</td>
</tr>
<tr>
<td><code>s.upper()</code></td>
<td><code>ser.str.upper()</code></td>
<td>转为大写</td>
</tr>
</tbody></table>
<p><strong>场景</strong>：处理包含金额的字符串列，提取纯数字并转为整型<br><strong>数据</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = &#123;<span class="string">&#x27;amount&#x27;</span>: [<span class="string">&#x27;1,000(万元人民币)&#x27;</span>, <span class="string">&#x27;2,500(美元)&#x27;</span>, <span class="string">&#x27;3,800(欧元)&#x27;</span>, <span class="literal">None</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br></pre></td></tr></table></figure>

<p><strong>处理步骤</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 移除括号及其内容</span></span><br><span class="line">df[<span class="string">&#x27;clean&#x27;</span>] = df[<span class="string">&#x27;amount&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">r&#x27;\(.*?\)&#x27;</span>, <span class="string">&#x27;&#x27;</span>, regex=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 2. 移除逗号并转为整型</span></span><br><span class="line">df[<span class="string">&#x27;value&#x27;</span>] = df[<span class="string">&#x27;clean&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>).astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="comment"># 3. 检测是否含人民币单位</span></span><br><span class="line">df[<span class="string">&#x27;is_cny&#x27;</span>] = df[<span class="string">&#x27;amount&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;人民币&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322174433.png" alt="image.png"></p>
<h2 id="3-pandas-向量化正则表达式"><a href="#3-pandas-向量化正则表达式" class="headerlink" title="3 pandas 向量化正则表达式"></a>3 pandas 向量化正则表达式</h2><p>向量化的操作使我们不必担心数组的长度和维度，只需要关系操作功能，尤为强大的是，除了支持常用的字符串操作方法，还集成了正则表达式的大部分功能，这使得 pandas 在处理字符串列时效率翻倍。</p>
<ul>
<li>使用 <code>str.replace()</code> 方法，可以对字符串列进行向量化的正则替换。</li>
<li><code>str.contains()</code>、<code>str.match()</code> 和 <code>str.fullmatch()</code> 支持正则表达式来匹配特定模式。</li>
<li><code>str.split()</code> 方法可以使用正则表达式来分割字符串列。</li>
<li><code>str.extract()</code> 允许你提取符合正则表达式的子字符串，并将其放到新的列中。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取金额部分（数字部分）</span></span><br><span class="line">df[<span class="string">&#x27;amount_value&#x27;</span>] = df[<span class="string">&#x27;amount&#x27;</span>].<span class="built_in">str</span>.extract(<span class="string">r&#x27;(\d&#123;1,3&#125;(?:,\d&#123;3&#125;)*)&#x27;</span>, expand=<span class="literal">False</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322174720.png" alt="image.png|538"></p>
<h1 id="数据的拼接和合并"><a href="#数据的拼接和合并" class="headerlink" title="数据的拼接和合并"></a>数据的拼接和合并</h1><ul>
<li><code>concat</code>：用于沿着<strong>某个轴</strong>（行或列）拼接多个 DataFrame，适合简单的拼接操作。</li>
<li><code>merge</code>：用于<strong>基于某些列</strong>进行合并，类似于 SQL 的 <code>JOIN</code> 操作，可以处理复杂的合并需求。</li>
<li><code>join</code>：<strong>基于索引</strong>进行合并，适用于索引为关键字的数据集，简化了合并操作。</li>
</ul>
<table>
<thead>
<tr>
<th>方法</th>
<th>核心特点</th>
<th>适用场景</th>
<th>性能</th>
</tr>
</thead>
<tbody><tr>
<td><code>concat</code></td>
<td>简单堆叠，轴对齐</td>
<td>合并结构相同/部分重叠的数据</td>
<td>高</td>
</tr>
<tr>
<td><code>merge</code></td>
<td>基于键关联，支持复杂连接逻辑</td>
<td>关联关系型数据（如 SQL 表）</td>
<td>中</td>
</tr>
<tr>
<td><code>join</code></td>
<td>索引对齐，快速左连接</td>
<td>索引一致的快速合并</td>
<td>最高</td>
</tr>
</tbody></table>
<h2 id="1-concat-方法"><a href="#1-concat-方法" class="headerlink" title="1 concat 方法"></a>1 concat 方法</h2><p><code>concat</code> 方法是拼接函数，有行拼接和列拼接，默认是行拼接，拼接方法默认是外拼接（并集），拼接的对象是 <code>pandas</code> 数据类型。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220306164849.png"></p>
<h3 id="1-1-纵向合并（默认-axis-0）"><a href="#1-1-纵向合并（默认-axis-0）" class="headerlink" title="1.1 纵向合并（默认 axis=0）"></a>1.1 纵向合并（默认 <code>axis=0</code>）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>]&#125;)</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;A3&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B2&#x27;</span>, <span class="string">&#x27;B3&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 纵向堆叠（默认axis=0）</span></span><br><span class="line">result = pd.concat([df1, df2], ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322180120.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = pd.concat([df1, df2], keys=[<span class="string">&#x27;df1&#x27;</span>, <span class="string">&#x27;df2&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322180354.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>]&#125;)</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;A3&#x27;</span>]&#125;)</span><br><span class="line"><span class="comment"># 使用pd.concat进行合并，并且只保留重复的部分（inner join）</span></span><br><span class="line">result = pd.concat([df1, df2], join=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line">result</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322181030.png" alt="image.png"></p>
<h3 id="1-2-横向合并（axis-1）"><a href="#1-2-横向合并（axis-1）" class="headerlink" title="1.2 横向合并（axis=1）"></a>1.2 横向合并（<code>axis=1</code>）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>]&#125;)</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;A3&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B2&#x27;</span>, <span class="string">&#x27;B3&#x27;</span>]&#125;)</span><br><span class="line"><span class="comment"># 横向合并（按列）</span></span><br><span class="line">result = pd.concat([df1, df2], axis=<span class="number">1</span>)</span><br><span class="line">result</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322180546.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = pd.concat([df1, df2], keys=[<span class="string">&#x27;df1&#x27;</span>, <span class="string">&#x27;df2&#x27;</span>],axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322180612.png" alt="image.png"></p>
<h2 id="2-merge-方法"><a href="#2-merge-方法" class="headerlink" title="2 merge 方法"></a>2 <code>merge</code> 方法</h2><p><code>pandas</code> 的 <code>merge</code> 是基于 <code>column</code> 连接，方法提供了一种类似于 SQL 的内存链接操作，官网文档提到它的性能会比其他开源语言的数据操作（例如 R）要高效。</p>
<p>根据一个或多个键将不同 <code>DataFrame</code> 中的不同列进行连接。  </p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220307085756.png"></p>
<h4 id="2-1-1-使用不同的合并方式："><a href="#2-1-1-使用不同的合并方式：" class="headerlink" title="2.1.1 使用不同的合并方式："></a>2.1.1 使用不同的合并方式：</h4><ul>
<li><code>how=&#39;inner&#39;</code>（默认）：只保留两个 DataFrame 中都有的。</li>
<li><code>how=&#39;left&#39;</code>：保留左侧 <code>DataFrame</code> 中的所有行，右侧只匹配相应的行，若没有匹配，则填充 NaN。</li>
<li><code>how=&#39;right&#39;</code>：保留右侧 <code>DataFrame</code> 中的所有行，左侧 DataFrame 只保留匹配的行。</li>
<li><code>how=&#39;outer&#39;</code>：保留两个 <code>DataFrame</code> 中的所有行，若没有匹配，则填充 NaN。</li>
</ul>
<h3 id="2-2-内连接（how-39-inner-39-）"><a href="#2-2-内连接（how-39-inner-39-）" class="headerlink" title="2.2 内连接（how=&#39;inner&#39;）"></a>2.2 内连接（<code>how=&#39;inner&#39;</code>）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">students = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;student_id&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">scores = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;student_id&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&#x27;math&#x27;</span>: [<span class="number">85</span>, <span class="number">90</span>, <span class="number">78</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 内连接（默认）</span></span><br><span class="line">merged = pd.merge(students, scores, on=<span class="string">&#x27;student_id&#x27;</span>, how=<span class="string">&#x27;inner&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322181254.png" alt="image.png"></p>
<h3 id="2-3-左连接（how-39-left-39-）与列名冲突处理"><a href="#2-3-左连接（how-39-left-39-）与列名冲突处理" class="headerlink" title="2.3 左连接（how=&#39;left&#39;）与列名冲突处理"></a>2.3 左连接（<code>how=&#39;left&#39;</code>）与列名冲突处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">students = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;student_id&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">scores = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;student_id&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&#x27;math&#x27;</span>: [<span class="number">85</span>, <span class="number">90</span>, <span class="number">78</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列名冲突时添加后缀</span></span><br><span class="line">merged = pd.merge(</span><br><span class="line">    students.rename(columns=&#123;<span class="string">&#x27;student_id&#x27;</span>: <span class="string">&#x27;id&#x27;</span>&#125;),</span><br><span class="line">    scores,</span><br><span class="line">    left_on=<span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">    right_on=<span class="string">&#x27;student_id&#x27;</span>,</span><br><span class="line">    suffixes=(<span class="string">&#x27;_学生&#x27;</span>, <span class="string">&#x27;_成绩&#x27;</span>),</span><br><span class="line">    how=<span class="string">&#x27;left&#x27;</span></span><br><span class="line">)</span><br><span class="line">merged</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322181620.png" alt="image.png"></p>
<ul>
<li><code>left_on</code>/<code>right_on</code>：处理不同列名的关联键</li>
<li><code>suffixes</code>：自动为重复列添加后缀</li>
</ul>
<h2 id="3-join-方法"><a href="#3-join-方法" class="headerlink" title="3 join 方法"></a>3 join 方法</h2><p><code>pandas</code> 的 <code>join</code> 是基于 <code>index</code> 连接 <code>dataframe</code>，主要用于基于<strong>行索引</strong>上的合并。  </p>
<p>只要两个表列名不同，不加任何参数就可以直接用。如果两个表有重复的列名，需指定 <code>lsuffix</code>, <code>rsuffix</code> 参数。其中参数的意义与 <code>merge</code> 方法基本相同。</p>
<p><strong>核心功能</strong>：默认按索引左连接，是 <code>merge</code> 的简化版，适用于索引对齐的场景</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220308184424.png" alt="|743"></p>
<h3 id="3-1-列名无重叠"><a href="#3-1-列名无重叠" class="headerlink" title="3.1 列名无重叠"></a>3.1 列名无重叠</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>])</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;C0&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>], <span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 左连接（默认）</span></span><br><span class="line">result = left.join(right)</span><br><span class="line">result</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322182114.png" alt="image.png|377"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>])</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;C0&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>], <span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 左连接（默认）</span></span><br><span class="line">result = left.join(right, how=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line">result</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322182837.png" alt="image.png|242"></p>
<h3 id="3-2-列名有重叠"><a href="#3-2-列名有重叠" class="headerlink" title="3.2 列名有重叠"></a>3.2 列名有重叠</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>])</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 左连接（默认）</span></span><br><span class="line">result = left.join(right)</span><br><span class="line">result</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322182421.png" alt="image.png"></p>
<p>会报错，这时候需要给重复列添加后缀</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>])</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>], <span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>]&#125;, index=[<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 左连接（默认）</span></span><br><span class="line">result = left.join(right, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span> )</span><br><span class="line">result</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250322182608.png" alt="image.png"></p>
<h1 id="数据的分组与聚合"><a href="#数据的分组与聚合" class="headerlink" title="数据的分组与聚合"></a>数据的分组与聚合</h1><p>在对数据处理的过程中，除了前期对数据的清洗，更多的工作是需要根据不同的分析需求对数据进行整合。比如需要统计某类数据的出现次数，或者需要按照不同级别来分别统计等等。为满足这些需求，比较常用的方法即分组和聚合。幸运的是，<code>pandas</code> 中完美支持了这样的功能，掌握好 <code>pandas</code> 中这些功能，可以使数据处理的效率大大提高。</p>
<p>分组是指使用特定的条件将原数据划分为多个组，聚合在这里指的是，对每个分组中的数据执行某些操作，最后将计算的结果进行整合。  </p>
<p>分组和聚合的过程主要分为以下三个步骤：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20210103195123590.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/img.png"></p>
<h2 id="1-分组"><a href="#1-分组" class="headerlink" title="1 分组"></a>1 分组</h2><h3 id="1-1-基础数据处理"><a href="#1-1-基础数据处理" class="headerlink" title="1.1 基础数据处理"></a>1.1 基础数据处理</h3><h4 id="1-1-1-读取文件路径与合并数据"><a href="#1-1-1-读取文件路径与合并数据" class="headerlink" title="1.1.1 读取文件路径与合并数据"></a>1.1.1 读取文件路径与合并数据</h4><p>读取文件夹下所有文件路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取所有CSV文件路径</span></span><br><span class="line">files = glob.glob(<span class="string">&#x27;./data/C3.9 数据的分组与聚合/*.csv&#x27;</span>)  <span class="comment"># 建议明确指定文件类型</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323125621.png" alt="image.png"></p>
<p>依次读取并合并</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.concat([pd.read_csv(f) <span class="keyword">for</span> f <span class="keyword">in</span> files])</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323125645.png" alt="image.png"></p>
<h4 id="1-1-2-日期列处理优化"><a href="#1-1-2-日期列处理优化" class="headerlink" title="1.1.2 日期列处理优化"></a>1.1.2 日期列处理优化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正确转换日期格式</span></span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;date&#x27;</span>], <span class="built_in">format</span>=<span class="string">&#x27;%Y%m%d&#x27;</span>)  <span class="comment"># 直接转换整列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取月份和日期</span></span><br><span class="line">df[<span class="string">&#x27;month&#x27;</span>] = df[<span class="string">&#x27;date&#x27;</span>].dt.month</span><br><span class="line">df[<span class="string">&#x27;day&#x27;</span>] = df[<span class="string">&#x27;date&#x27;</span>].dt.day</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除原始日期列（可选）</span></span><br><span class="line">df = df.drop(columns=<span class="string">&#x27;date&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323125916.png" alt="image.png"></p>
<h3 id="1-2-简单分组"><a href="#1-2-简单分组" class="headerlink" title="1.2 简单分组"></a>1.2 简单分组</h3><p>分组功能主要利用 <code>pandas</code> 的 <code>groupby</code> 函数。虽然分组功能用其他函数也可以完成，但是 <code>groupby</code> 函数是相对来说比较方便的。这个函数有很多神奇的功能，熟练后功能十分强大。<code>groupby</code> 函数的官方参数说明如下：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220310155241.png"></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323130342.png" alt="image.png|146"></p>
<p>这里 <code>type</code> 主要有三类：<code>AQI</code>,<code>PM10</code>,<code>PM2.5</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">group = df.groupby(<span class="string">&#x27;type&#x27;</span>)</span><br><span class="line"><span class="built_in">len</span>(group) <span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 遍历</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> group:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 查看所有分组键（List列表）</span></span><br><span class="line">group.groups.keys()</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323132054.png" alt="image.png"></p>
<p>获取某一组的数据，有如下两种方式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取 &#x27;PM10&#x27; 这一组的数据</span></span><br><span class="line">group.get_group(<span class="string">&#x27;PM10&#x27;</span>)</span><br><span class="line">df[df[<span class="string">&#x27;type&#x27;</span>]==<span class="string">&#x27;PM10&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323130523.png" alt="image.png|581"></p>
<p>对所有组进行操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按type分组后计算平均污染物含量</span></span><br><span class="line">df.groupby(<span class="string">&#x27;type&#x27;</span>)[<span class="string">&quot;天坛&quot;</span>].mean()</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323130740.png" alt="image.png"></p>
<h3 id="1-3-多重分组"><a href="#1-3-多重分组" class="headerlink" title="1.3 多重分组"></a>1.3 多重分组</h3><p>当使用 ​<strong>多列分组</strong>​（例如 <code>groupby([&#39;type&#39;, &#39;month&#39;])</code>）时，分组的键会变成一个 ​<strong>元组（Tuple）​</strong>，包含两列的值组合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">group = df.groupby([<span class="string">&#x27;type&#x27;</span>, <span class="string">&#x27;month&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> group:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 查看所有分组键（元组列表）</span></span><br><span class="line">group.groups.keys()</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323132135.png" alt="image.png"></p>
<p>获取某一组，注意参数是元组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```python</span><br><span class="line"><span class="comment"># 获取 type=&#x27;AQI&#x27; 且 month=1 的分组</span></span><br><span class="line">aqi_january = group.get_group((<span class="string">&#x27;AQI&#x27;</span>, <span class="number">1</span>))  <span class="comment"># 注意参数是元组</span></span><br><span class="line">df[(df[<span class="string">&#x27;type&#x27;</span>]==<span class="string">&#x27;AQI&#x27;</span>) &amp; (df[<span class="string">&#x27;month&#x27;</span>]==<span class="number">1</span>)]</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323131923.png" alt="image.png"></p>
<h2 id="2-聚合"><a href="#2-聚合" class="headerlink" title="2 聚合"></a>2 聚合</h2><p>所谓聚合就是在对数据进行合理分组后，再根据需要对数据进行的一列操作，比如求和、转换等。聚合函数通常是数据处理的最终目的，数据分组很多情况下也是为更好聚合来服务的。</p>
<p>下面是 <code>GroupBy</code> 对象常用的描述性统计方法</p>
<h3 id="2-1-使用内置统计方法聚合数据"><a href="#2-1-使用内置统计方法聚合数据" class="headerlink" title="2.1 使用内置统计方法聚合数据"></a>2.1 使用内置统计方法聚合数据</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20210103203404481.png" alt="|810"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">group = df[df[<span class="string">&#x27;type&#x27;</span>]==<span class="string">&#x27;AQI&#x27;</span>].groupby([<span class="string">&#x27;hour&#x27;</span>, <span class="string">&#x27;month&#x27;</span>])</span><br><span class="line">group.mean()</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323132312.png" alt="image.png|364"></p>
<h3 id="2-2-利用-agg-进行简单的聚合"><a href="#2-2-利用-agg-进行简单的聚合" class="headerlink" title="2.2 利用 agg 进行简单的聚合"></a>2.2 利用 agg 进行简单的聚合</h3><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220310155248.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">group.agg([<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;std&#x27;</span>])</span><br><span class="line">```data = &#123;</span><br><span class="line">    <span class="string">&#x27;Region&#x27;</span>: [<span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;East&#x27;</span>, <span class="string">&#x27;East&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Product&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Sales&#x27;</span>: [<span class="number">200</span>, <span class="number">150</span>, <span class="number">300</span>, <span class="number">250</span>, <span class="number">180</span>, <span class="number">220</span>],</span><br><span class="line">    <span class="string">&#x27;Quantity&#x27;</span>: [<span class="number">10</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">9</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323134206.png" alt="image.png"></p>
<ol>
<li>按 <code>Region</code>（地区）和 <code>Product</code>（产品类型）分组。</li>
<li>对 <code>Sales</code>（销售额）计算以下统计量：<ul>
<li>平均值（<code>mean</code>）</li>
<li>总和（<code>sum</code>）</li>
<li>最大值（<code>max</code>）</li>
</ul>
</li>
<li>对 <code>Quantity</code>（销量）计算：<ul>
<li>总和（<code>sum</code>）</li>
<li>标准差（<code>std</code>）</li>
</ul>
</li>
<li>自定义一个函数：计算销售额的极差（最大值 - 最小值）。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按两列分组</span></span><br><span class="line">grouped = df.groupby([<span class="string">&#x27;Region&#x27;</span>, <span class="string">&#x27;Product&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义聚合规则</span></span><br><span class="line">agg_rules = &#123;</span><br><span class="line">    <span class="string">&#x27;Sales&#x27;</span>: [<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="keyword">lambda</span> x: x.<span class="built_in">max</span>() - x.<span class="built_in">min</span>()],  <span class="comment"># 对 Sales 列应用多个函数</span></span><br><span class="line">    <span class="string">&#x27;Quantity&#x27;</span>: [<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;std&#x27;</span>]                                      <span class="comment"># 对 Quantity 列应用函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行聚合</span></span><br><span class="line">result = grouped.agg(agg_rules)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名自定义函数的列名</span></span><br><span class="line">result.columns = [<span class="string">&#x27;Sales_Mean&#x27;</span>, <span class="string">&#x27;Sales_Sum&#x27;</span>, <span class="string">&#x27;Sales_Max&#x27;</span>, <span class="string">&#x27;Sales_Range&#x27;</span>, <span class="string">&#x27;Quantity_Sum&#x27;</span>, <span class="string">&#x27;Quantity_Std&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323134322.png" alt="image.png|645"></p>
<h3 id="2-3-transform-函数"><a href="#2-3-transform-函数" class="headerlink" title="2.3 transform 函数"></a>2.3 transform 函数</h3><p>使用 <code>transform</code> 函数对 <code>groupby</code> 对象进行变换，<code>transform</code> 的计算结果和原始数据的形状保持一致。  </p>
<p><code>transform</code> 函数一开始可能有点难以理解。 但 <code>transform</code> 函数是一个用于数据清洗、转换或者生成报表的非常方便的工具，尤其是对于大量数据的处理速度上。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;Class&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Student&#x27;</span>: [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;David&#x27;</span>, <span class="string">&#x27;Eva&#x27;</span>, <span class="string">&#x27;Frank&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Score&#x27;</span>: [<span class="number">85</span>, <span class="number">70</span>, <span class="number">90</span>, <span class="number">78</span>, <span class="number">88</span>, <span class="number">82</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323134822.png" alt="image.png"></p>
<ol>
<li>按班级（<code>Class</code>）分组。</li>
<li>对每个学生的分数进行 ​<strong>组内标准化</strong>​（即 Z-Score）：<ul>
<li>计算每个班级的平均分（<code>mean</code>）和标准差（<code>std</code>）。</li>
<li>每个学生的标准化分数 = <code>(Score - 班级平均分) / 班级标准差</code>。</li>
</ul>
</li>
<li>结果需要保持与原数据相同的行数，以便新增一列存储标准化分数。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按班级分组</span></span><br><span class="line">grouped = df.groupby(<span class="string">&#x27;Class&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 transform 计算标准化分数</span></span><br><span class="line">df[<span class="string">&#x27;Z-Score&#x27;</span>] = grouped[<span class="string">&#x27;Score&#x27;</span>].transform(</span><br><span class="line">    <span class="keyword">lambda</span> x: (x - x.mean()) / x.std()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323135023.png" alt="image.png"></p>
<h3 id="2-4-对比-agg-与-transform"><a href="#2-4-对比-agg-与-transform" class="headerlink" title="2.4 对比 agg 与 transform"></a>2.4 对比 <code>agg</code> 与 <code>transform</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算每个班级的均值和标准差</span></span><br><span class="line">grouped[<span class="string">&#x27;Score&#x27;</span>].agg([<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;std&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323135157.png" alt="image.png"></p>
<ul>
<li><code>agg</code> 返回的是每个组的汇总统计，行数等于组数（这里是 2 行），无法直接合并回原始数据。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grouped[<span class="string">&#x27;Score&#x27;</span>].transform(<span class="string">&#x27;mean&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323135530.png" alt="image.png"></p>
<ul>
<li><code>transform</code> 的结果可以直接作为新列添加到原数据中</li>
</ul>
<h1 id="数据的重塑"><a href="#数据的重塑" class="headerlink" title="数据的重塑"></a>数据的重塑</h1><p>重塑的方式主要分为两种:  </p>
<ol>
<li>轴向旋转</li>
<li>堆叠</li>
</ol>
<table>
<thead>
<tr>
<th>函数</th>
<th>用途</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><code>pivot</code></td>
<td>无聚合的宽表转换（唯一索引）</td>
<td>简单行列转换，无重复值</td>
</tr>
<tr>
<td><code>pivot_table</code></td>
<td>支持聚合的透视表（处理重复值）</td>
<td>数据汇总、多维分析</td>
</tr>
<tr>
<td><code>stack</code></td>
<td>将列索引转为行索引（长格式）</td>
<td>从宽表到长表，多级索引处理</td>
</tr>
<tr>
<td><code>unstack</code></td>
<td>将行索引转为列索引（宽格式）</td>
<td>从长表到宽表，展开层级索引</td>
</tr>
</tbody></table>
<h2 id="轴向旋转"><a href="#轴向旋转" class="headerlink" title="轴向旋转"></a>轴向旋转</h2><p>轴向旋转可以使用 <code>pivot</code> 函数，它可以用来创建一个新的派生表，该函数有三个参数：<code>index</code>, <code>columns</code> 和 <code>values</code>。你需要在原始表中指定这三个参数所对定的列名，接下来 <code>pivot</code> 函数会创建一个新的表格，其中行索引和列索引都是唯一标示值，表格中的数值由原始表中参数 <code>value</code> 对应的数据所表示。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20220315212704.png"></p>
<h3 id="1-pivot：将长表转换为宽表"><a href="#1-pivot：将长表转换为宽表" class="headerlink" title="(1) pivot：将长表转换为宽表"></a>(1) <code>pivot</code>：将长表转换为宽表</h3><p>基于列的唯一值重新排列数据，适合无重复索引的场景。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;Date&#x27;</span>: [<span class="string">&#x27;2023-01-01&#x27;</span>, <span class="string">&#x27;2023-01-01&#x27;</span>, <span class="string">&#x27;2023-01-02&#x27;</span>, <span class="string">&#x27;2023-01-02&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Product&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Region&#x27;</span>: [<span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Sales&#x27;</span>: [<span class="number">100</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">180</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323141228.png" alt="image.png"></p>
<p>以 <code>Date</code> 为行索引，<code>Product</code> 为列，展示不同日期的销售情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pivot_df = df.pivot(index=<span class="string">&#x27;Date&#x27;</span>, columns=<span class="string">&#x27;Product&#x27;</span>, values=<span class="string">&#x27;Sales&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pivot_df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323141257.png" alt="image.png"></p>
<h3 id="2-pivot-table：支持聚合的透视表"><a href="#2-pivot-table：支持聚合的透视表" class="headerlink" title="(2) pivot_table：支持聚合的透视表"></a>(2) <code>pivot_table</code>：支持聚合的透视表</h3><p>类似 <code>pivot</code>，但可处理重复值并通过聚合函数（如 <code>sum</code>、<code>mean</code>）汇总数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;Date&#x27;</span>: [<span class="string">&#x27;2023-01-01&#x27;</span>, <span class="string">&#x27;2023-01-01&#x27;</span>, <span class="string">&#x27;2023-01-01&#x27;</span>, <span class="string">&#x27;2023-01-02&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Product&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Sales&#x27;</span>: [<span class="number">100</span>, <span class="number">120</span>, <span class="number">150</span>, <span class="number">180</span>]</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323141440.png" alt="image.png"></p>
<ul>
<li>这里针对 A 在 2023-01-01 添加了一个重复项</li>
</ul>
<p>按日期和产品汇总销售额（求和）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pivot_table_df = pd.pivot_table(</span><br><span class="line">    df,</span><br><span class="line">    index=<span class="string">&#x27;Date&#x27;</span>,</span><br><span class="line">    columns=<span class="string">&#x27;Product&#x27;</span>,</span><br><span class="line">    values=<span class="string">&#x27;Sales&#x27;</span>,</span><br><span class="line">    aggfunc=<span class="string">&#x27;sum&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(pivot_table_df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323141515.png" alt="image.png"></p>
<h2 id="堆叠"><a href="#堆叠" class="headerlink" title="堆叠"></a>堆叠</h2><p>实际上，轴向旋转 (<code>pivot</code>) 运算是堆叠 (stack) 过程的特例。<code>stack</code> 过程表示将数据集的列旋转为行，同理 <code>unstack</code> 过程表示将数据的行旋转为列。下图形象地展示了该过程：</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323143142.png" alt="image.png|529"></p>
<h3 id="1-stack：将列层级索引堆叠到行"><a href="#1-stack：将列层级索引堆叠到行" class="headerlink" title="(1) stack：将列层级索引堆叠到行"></a>(1) <code>stack</code>：将列层级索引堆叠到行</h3><p>将宽表中的列索引转换为行索引，生成多层索引的 ​<strong>长格式</strong> 数据。</p>
<p>示例数据 <code>pivot_df</code></p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323141257.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stacked_df = pivot_df.stack()</span><br><span class="line">stacked_df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323142525.png" alt="image.png"></p>
<h3 id="2-unstack：将行层级索引展开到列"><a href="#2-unstack：将行层级索引展开到列" class="headerlink" title="(2) unstack：将行层级索引展开到列"></a>(2) <code>unstack</code>：将行层级索引展开到列</h3><p>将多层行索引中的某一层展开为列，生成 ​<strong>宽格式</strong> 数据。</p>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323142525.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unstacked_df = stacked_df.unstack(level=<span class="string">&#x27;Product&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(unstacked_df)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323142620.png" alt="image.png"></p>
<h1 id="表格数据可视化"><a href="#表格数据可视化" class="headerlink" title="表格数据可视化"></a>表格数据可视化</h1><p><code>Pandas</code> 的数据可视化的实现底层依赖于 <code>matplotlib</code>，所以画图时很多基础知识需要涉及到 <code>matplotlib</code>。我们后面会有一个任务专门来讲解使用 <code>matplotlib</code> 来进行可视化。因此在这个关卡中，我们简单的介绍 <code>pandas</code> 中的可视化功能，主要是通过处理数据，将其转化为 <code>Pandas</code> 可以直接可视化的格式，我们数据的形态和分布</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install plotly</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>​<strong>图表类型</strong></th>
<th>​**<code>kind</code> 参数值**</th>
<th>​<strong>适用场景</strong></th>
<th>​<strong>常用参数</strong></th>
<th>​<strong>示例代码</strong></th>
</tr>
</thead>
<tbody><tr>
<td>​<strong>折线图</strong></td>
<td><code>&#39;line&#39;</code></td>
<td>时间序列趋势分析</td>
<td><code>x</code>, <code>y</code>, <code>linestyle</code>, <code>marker</code></td>
<td><code>df.plot(kind=&#39;line&#39;, x=&#39;date&#39;, y=&#39;sales&#39;)</code></td>
</tr>
<tr>
<td>​<strong>柱状图</strong></td>
<td><code>&#39;bar&#39;</code></td>
<td>分类数据对比（如不同类别销量）</td>
<td><code>x</code>, <code>y</code>, <code>rot</code>（旋转标签角度）</td>
<td><code>df.plot(kind=&#39;bar&#39;, x=&#39;category&#39;, y=&#39;count&#39;)</code></td>
</tr>
<tr>
<td>​<strong>条形图</strong></td>
<td><code>&#39;barh&#39;</code></td>
<td>分类数据对比（横向显示，适合长类别名）</td>
<td><code>x</code>, <code>y</code></td>
<td><code>df.plot(kind=&#39;barh&#39;, x=&#39;name&#39;, y=&#39;score&#39;)</code></td>
</tr>
<tr>
<td>​<strong>直方图</strong></td>
<td><code>&#39;hist&#39;</code></td>
<td>数值型数据分布分析（如年龄分布）</td>
<td><code>bins</code>（分组数）, <code>edgecolor</code></td>
<td><code>df[&#39;age&#39;].plot(kind=&#39;hist&#39;, bins=20, edgecolor=&#39;black&#39;)</code></td>
</tr>
<tr>
<td>​<strong>箱型图</strong></td>
<td><code>&#39;box&#39;</code></td>
<td>数据分布与异常值检测</td>
<td><code>by</code>（分组字段）</td>
<td><code>df.plot(kind=&#39;box&#39;, by=&#39;group&#39;)</code></td>
</tr>
<tr>
<td>​<strong>密度图</strong></td>
<td><code>&#39;kde&#39;</code> 或 <code>&#39;density&#39;</code></td>
<td>数据分布平滑估计</td>
<td><code>bw_method</code>（带宽调整）</td>
<td><code>df[&#39;price&#39;].plot(kind=&#39;kde&#39;)</code></td>
</tr>
<tr>
<td>​<strong>面积图</strong></td>
<td><code>&#39;area&#39;</code></td>
<td>多变量累积趋势分析（如市场份额）</td>
<td><code>stacked</code>（是否堆叠）</td>
<td><code>df.plot(kind=&#39;area&#39;, stacked=True)</code></td>
</tr>
<tr>
<td>​<strong>饼图</strong></td>
<td><code>&#39;pie&#39;</code></td>
<td>占比分析（如销售额占比）</td>
<td><code>labels</code>, <code>autopct</code>（百分比格式）</td>
<td><code>df[&#39;category&#39;].value_counts().plot(kind=&#39;pie&#39;, autopct=&#39;%.1f%%&#39;)</code></td>
</tr>
<tr>
<td>​<strong>散点图</strong></td>
<td><code>&#39;scatter&#39;</code></td>
<td>两变量相关性分析（仅限 DataFrame）</td>
<td><code>x</code>, <code>y</code>, <code>c</code>（颜色映射）</td>
<td><code>df.plot(kind=&#39;scatter&#39;, x=&#39;height&#39;, y=&#39;weight&#39;, c=&#39;age&#39;, colormap=&#39;viridis&#39;)</code></td>
</tr>
</tbody></table>
<p>通过 <code>DataFrame.plot()</code> 或 <code>Series.plot()</code> 快速生成图表，常用参数：</p>
<ul>
<li><code>kind</code>：指定图表类型（如 <code>&#39;line&#39;</code>, <code>&#39;bar&#39;</code>, <code>&#39;scatter&#39;</code> 等）</li>
<li><code>figsize</code>：图表尺寸（如 <code>(10,6)</code>）</li>
<li><code>title</code>：图表标题</li>
<li><code>xlabel</code>/<code>ylabel</code>：坐标轴标签</li>
<li><code>color</code>：指定颜色（支持颜色名或十六进制码）</li>
<li><code>alpha</code>：透明度（0~1）</li>
<li><code>grid</code>：是否显示网格线（<code>True/False</code>）</li>
</ul>
<h3 id="数据基础处理"><a href="#数据基础处理" class="headerlink" title="数据基础处理"></a>数据基础处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取并合并数据文件（处理空列和空行）</span></span><br><span class="line">files = <span class="built_in">list</span>(glob.glob(<span class="string">&#x27;./data/C3.9 数据的分组与聚合/*.csv&#x27;</span>))</span><br><span class="line">df = pd.concat([pd.read_csv(f) <span class="keyword">for</span> f <span class="keyword">in</span> files], ignore_index=<span class="literal">True</span>)</span><br><span class="line">df = df.dropna(axis=<span class="string">&#x27;columns&#x27;</span>, how=<span class="string">&#x27;all&#x27;</span>).dropna(axis=<span class="string">&#x27;index&#x27;</span>, how=<span class="string">&#x27;any&#x27;</span>)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323144036.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并日期和时间字段，转换为时间戳</span></span><br><span class="line">df[<span class="string">&#x27;time&#x27;</span>] = df[<span class="string">&#x27;date&#x27;</span>].astype(<span class="string">&#x27;str&#x27;</span>) + df[<span class="string">&#x27;hour&#x27;</span>].astype(<span class="string">&#x27;str&#x27;</span>).apply(<span class="keyword">lambda</span> x: x.zfill(<span class="number">2</span>))  <span class="comment"># 小时补零</span></span><br><span class="line">df[<span class="string">&#x27;time&#x27;</span>] = df[<span class="string">&#x27;time&#x27;</span>].apply(<span class="keyword">lambda</span> x: pd.to_datetime(x, <span class="built_in">format</span>=<span class="string">&#x27;%Y%m%d%H&#x27;</span>))  <span class="comment"># 格式化为时间序列</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323144010.png" alt="image.png"></p>
<h3 id="折线图"><a href="#折线图" class="headerlink" title="折线图"></a>折线图</h3><h4 id="单个地点"><a href="#单个地点" class="headerlink" title="单个地点"></a>单个地点</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建数据透视表（按时间分组，污染物类型为列，东四站数据为值）</span></span><br><span class="line">data = df.drop(columns=[<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>]) <span class="comment"># 剔除两个字段</span></span><br><span class="line">data = data.pivot_table(index=<span class="string">&#x27;time&#x27;</span>, columns=<span class="string">&#x27;type&#x27;</span>, values=<span class="string">&#x27;东四&#x27;</span>) <span class="comment"># 按时间分组，污染物类型为列，东四站数据为值</span></span><br><span class="line">data</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323144100.png" alt="image.png"></p>
<p>提取 AQI 数据并绘制时序图（使用 Plotly 后端）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aqi = data[<span class="string">&#x27;AQI&#x27;</span>]</span><br><span class="line">aqi</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323144123.png" alt="image.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi.plot(backend=<span class="string">&#x27;plotly&#x27;</span>)  <span class="comment"># 生成交互式可视化图表</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323144142.png" alt="image.png"></p>
<h4 id="多个地点"><a href="#多个地点" class="headerlink" title="多个地点"></a>多个地点</h4><p>创建多站点数据透视表（按时间分组，污染物类型为列，多站点数据为值）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建多站点数据透视表（按时间分组，污染物类型为列，多站点数据为值）</span></span><br><span class="line"><span class="comment"># 列索引为两层结构：(站点, 污染物类型)</span></span><br><span class="line">data = df.drop(columns=[<span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;hour&#x27;</span>]).pivot_table(</span><br><span class="line">    index=<span class="string">&#x27;time&#x27;</span>, </span><br><span class="line">    columns=<span class="string">&#x27;type&#x27;</span>, </span><br><span class="line">    values=[<span class="string">&#x27;东四&#x27;</span>, <span class="string">&#x27;天坛&#x27;</span>, <span class="string">&#x27;官园&#x27;</span>]  <span class="comment"># 同时提取多个站点的数据</span></span><br><span class="line">)</span><br><span class="line">data</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145614.png" alt="image.png"></p>
<p>获取所有站点的 AQI 数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取AQI数据并调整列索引层级（交换站点与污染物类型的层级）</span></span><br><span class="line"><span class="comment"># 转换后列索引结构变为：(污染物类型, 站点) -&gt; 方便按污染物类型切片</span></span><br><span class="line">aqi = data.swaplevel(axis=<span class="string">&#x27;columns&#x27;</span>)[<span class="string">&#x27;AQI&#x27;</span>]  <span class="comment"># 获取所有站点的AQI数据</span></span><br></pre></td></tr></table></figure>

<ul>
<li>​<strong>第一层</strong>：站点（如 <code>东四</code>, <code>天坛</code>）</li>
<li>​<strong>第二层</strong>：污染物类型（如 <code>AQI</code>, <code>PM2.5</code>）</li>
<li><code>swaplevel()</code> 是 Pandas 中用于 ​<strong>交换多层索引（MultiIndex）层级顺序</strong>的方法<ul>
<li>原始数据列索引结构：<code>列索引 = [(&#39;东四&#39;, &#39;AQI&#39;), (&#39;东四&#39;, &#39;PM2.5&#39;), (&#39;天坛&#39;, &#39;AQI&#39;), (&#39;天坛&#39;, &#39;PM2.5&#39;)]</code></li>
<li>交换后的列索引结构变为：<code>列索引 = [(&#39;AQI&#39;, &#39;东四&#39;), (&#39;PM2.5&#39;, &#39;东四&#39;), (&#39;AQI&#39;, &#39;天坛&#39;), (&#39;PM2.5&#39;, &#39;天坛&#39;)]</code></li>
</ul>
</li>
</ul>
<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145634.png" alt="image.png"></p>
<p>绘制多站点 AQI 时序曲线图（默认显示全部站点）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi.plot(backend=<span class="string">&#x27;plotly&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145649.png" alt="image.png"></p>
<p> 指定绘制单个站点的 AQI 曲线（天坛站）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aqi.plot(y=<span class="string">&#x27;天坛&#x27;</span>, backend=<span class="string">&#x27;plotly&#x27;</span>,)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145753.png" alt="image.png"></p>
<h2 id="柱状图"><a href="#柱状图" class="headerlink" title="柱状图"></a>柱状图</h2><p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323150528.png" alt="image.png|594"></p>
<p>按月聚合计算 AQI 均值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.index</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323150638.png" alt="image.png|435"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按月聚合计算AQI均值（index.month提取月份）</span></span><br><span class="line"><span class="comment"># 结果结构：行索引为月份，列索引为 (站点, 污染物类型)</span></span><br><span class="line">monthly_mean = data.groupby(data.index.month).mean()</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145817.png" alt="image.png"></p>
<p>提取各站点 AQI 的月度均值数据（调整列索引层级）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取各站点AQI的月度均值数据（调整列索引层级）</span></span><br><span class="line"><span class="comment"># 转换后列索引结构：站点 -&gt; 方便按站点分析月度趋势</span></span><br><span class="line">aqi_monthly = monthly_mean.swaplevel(axis=<span class="string">&#x27;columns&#x27;</span>)[<span class="string">&#x27;AQI&#x27;</span>]</span><br><span class="line">aqi</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145831.png" alt="image.png"></p>
<p>关注的焦点是不同区域在不同月份 AQI 的差异</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aqi.plot.bar(</span><br><span class="line">    backend=<span class="string">&#x27;plotly&#x27;</span>, </span><br><span class="line">    barmode=<span class="string">&#x27;group&#x27;</span>,</span><br><span class="line">    height=<span class="number">500</span>, <span class="comment"># 图表高度</span></span><br><span class="line">    width=<span class="number">800</span>, <span class="comment"># 图表宽度</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145850.png" alt="image.png"></p>
<p>关注的焦点是不同地点半年内 AQI 的总和</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">aqi.T.plot.bar(</span><br><span class="line">    backend=<span class="string">&#x27;plotly&#x27;</span>,</span><br><span class="line">    height=<span class="number">500</span>, <span class="comment"># 图表高度</span></span><br><span class="line">    width=<span class="number">800</span>, <span class="comment"># 图表宽度</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<p><img src="https://picgocloud.oss-cn-shanghai.aliyuncs.com/picgo/20250323145908.png" alt="image.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://VernalScenery.github.io">Scenery</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://vernalscenery.github.io/2025/03/20/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/02_Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_Pandas/">https://vernalscenery.github.io/2025/03/20/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/02_Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_Pandas/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://VernalScenery.github.io" target="_blank">春和景明的记事本</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a><a class="post-meta__tags" href="/tags/python/">python</a></div><div class="post_share"><div class="social-share" data-image="/./img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/03/26/%E5%9B%BE%E5%BD%A2%E5%AD%A6/WebGL/00_WebGL_%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%88%9D%E8%AF%86/" title="00_WebGL_图形学初识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">00_WebGL_图形学初识</div></div></a></div><div class="next-post pull-right"><a href="/2025/03/19/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/01_Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_Numpy/" title="01_Python数据分析_Numpy"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">01_Python数据分析_Numpy</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2025/03/19/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/01_Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_Numpy/" title="01_Python数据分析_Numpy"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-19</div><div class="title">01_Python数据分析_Numpy</div></div></a></div><div><a href="/2025/03/17/Python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/00_Python%E5%9F%8E%E5%B8%82%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90_%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" title="00_Python城市数据分析_环境配置"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="title">00_Python城市数据分析_环境配置</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Scenery</div><div class="author-info__description">今天不想跑，所以才去跑</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/chjm0121" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1595718686@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Series"><span class="toc-text">1 Series</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%88%9B%E5%BB%BA%E6%96%B9%E6%B3%95"><span class="toc-text">1.1 创建方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-ndarray-%E5%88%9B%E5%BB%BA"><span class="toc-text">1.1.1 ndarray 创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BA"><span class="toc-text">1.1.2 字典创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-%E6%A0%87%E9%87%8F%E5%88%9B%E5%BB%BA"><span class="toc-text">1.1.3 标量创建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Series-%E5%B1%9E%E6%80%A7%E4%B8%8E%E6%96%B9%E6%B3%95"><span class="toc-text">1.2 Series 属性与方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="toc-text">1.2.1 常用属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">1.2.2 常用方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-DataFrame"><span class="toc-text">2 DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F"><span class="toc-text">2.1 创建方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-ndarrays-Lists-%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BA"><span class="toc-text">2.1.1 ndarrays&#x2F;Lists 字典创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-Series-%E5%88%9B%E5%BB%BA"><span class="toc-text">2.1.2 Series 创建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-DataFrame-%E7%9A%84%E5%B1%9E%E6%80%A7%E4%B8%8E%E6%96%B9%E6%B3%95"><span class="toc-text">2.2 DataFrame 的属性与方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="toc-text">2.2.1 常用属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">2.2.2 常用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E6%9F%A5%E7%9C%8B%E4%B8%8E%E7%BB%9F%E8%AE%A1"><span class="toc-text">1. 数据查看与统计</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-text">2. 数据操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E9%80%89%E6%8B%A9%E4%B8%8E%E7%AD%9B%E9%80%89"><span class="toc-text">3. 数据选择与筛选</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E4%B8%8E%E8%AE%A1%E7%AE%97"><span class="toc-text">4. 类型转换与计算</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E8%AF%BB%E5%8F%96"><span class="toc-text">数据的读取</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-csv-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-text">1 csv 文件读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%9F%BA%E6%9C%AC%E5%8F%82%E6%95%B0"><span class="toc-text">1.1 基本参数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95-read-csv"><span class="toc-text">1.1.1 基本语法 read_csv()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-%E5%88%86%E9%9A%94%E7%AC%A6-sep"><span class="toc-text">1.1.2 分隔符 sep</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#sep-%E4%B8%8E-delimiter"><span class="toc-text">sep 与 delimiter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#delim-whitespace"><span class="toc-text">delim_whitespace</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-%E8%A1%A8%E5%A4%B4-header-%E4%B8%8E%E5%88%97%E5%90%8D-names"><span class="toc-text">1.1.3 表头 header 与列名 names</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A1%A8%E5%A4%B4-header"><span class="toc-text">表头 (header)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%97%E5%90%8D-names"><span class="toc-text">列名 (names)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-4-%E7%B4%A2%E5%BC%95-index-col"><span class="toc-text">1.1.4 索引 index_col</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-5-%E4%BD%BF%E7%94%A8%E9%83%A8%E5%88%86%E5%88%97-usecols"><span class="toc-text">1.1.5 使用部分列 usecols</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-6-%E8%B7%B3%E8%BF%87%E6%8C%87%E5%AE%9A%E8%A1%8C-skiprows"><span class="toc-text">1.1.6 跳过指定行 skiprows</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%80%BC%E4%B8%BA%E5%88%97%E8%A1%A8"><span class="toc-text">1、值为列表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E5%80%BC%E4%B8%BA%E6%95%B0"><span class="toc-text">2、值为数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E5%80%BC%E4%B8%BA%E5%87%BD%E6%95%B0"><span class="toc-text">3、值为函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-7-%E8%B7%B3%E8%BF%87%E7%A9%BA%E8%A1%8C-skip-blank-lines"><span class="toc-text">1.1.7 跳过空行 skip_blank_lines</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-8-%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E8%A1%8C-nrows"><span class="toc-text">1.1.8 读取指定行 nrows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-9-%E5%88%97%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86-converters"><span class="toc-text">1.1.9 列数据处理 converters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-10-%E7%A9%BA%E5%80%BC%E6%9B%BF%E6%8D%A2-na-values"><span class="toc-text">1.1.10 空值替换 na_values</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%97%B6%E9%97%B4%E8%A7%A3%E6%9E%90"><span class="toc-text">1.2 时间解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-txt-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-text">2 txt 文件读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-json-%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%8F%96"><span class="toc-text">3 json 文件的读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%9F%BA%E7%A1%80%E8%AF%BB%E5%8F%96"><span class="toc-text">3.1 基础读取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-path-or-buf"><span class="toc-text">3.1.1 path_or_buf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-typ"><span class="toc-text">3.1.2 typ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-orient"><span class="toc-text">3.1.3 orient</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%A7%84%E8%8C%83%E5%8C%96"><span class="toc-text">3.2 规范化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-excel-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%AF%BB%E5%8F%96"><span class="toc-text">4 excel 数据的读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-text">4.1 基本语法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BF%9D%E5%AD%98"><span class="toc-text">数据的保存</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-csv-%E6%96%87%E4%BB%B6%E7%9A%84%E5%86%99%E5%85%A5"><span class="toc-text">1 csv 文件的写入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-json-%E6%96%87%E4%BB%B6%E7%9A%84%E5%86%99%E5%85%A5"><span class="toc-text">2 json 文件的写入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-orient"><span class="toc-text">2.1 orient</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E5%8E%9F%E5%A7%8B-JSON-%E6%95%B0%E6%8D%AE"><span class="toc-text">2.1.1 原始 JSON 数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-orient-39-split-39"><span class="toc-text">2.1.2 orient&#x3D;&#39;split&#39;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-3-orient-39-records-39"><span class="toc-text">2.1.3 orient&#x3D;&#39;records&#39;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-%E2%80%8Borient-39-index-39-%E9%BB%98%E8%AE%A4%E6%A8%A1%E5%BC%8F"><span class="toc-text">2.1.4 ​orient&#x3D;&#39;index&#39; (默认模式)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-5-%E2%80%8Borient-39-columns-39"><span class="toc-text">2.1.5 ​orient&#x3D;&#39;columns&#39;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-6-%E2%80%8Borient-39-values-39"><span class="toc-text">2.1.6 ​orient&#x3D;&#39;values&#39;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-7-orient-39-table-39"><span class="toc-text">2.1.7 orient&#x3D;&#39;table&#39;</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Excel-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-text">3 Excel 文件写入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-to-excel-%E7%89%B9%E6%9C%89%E5%8F%82%E6%95%B0"><span class="toc-text">3.1 to_excel() 特有参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-to-csv-%E7%89%B9%E6%9C%89%E5%8F%82%E6%95%B0"><span class="toc-text">3.2 to_csv() 特有参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%88%87%E7%89%87"><span class="toc-text">数据的索引与切片</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-text">1 基本结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%B8%AD%E6%8B%AC%E5%8F%B7%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-text">2 中括号的方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-text">2.1 列索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-text">2.2 行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-text">2.3 联合索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-loc-%E7%B4%A2%E5%BC%95"><span class="toc-text">3 loc 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%8D%95%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-text">3.1 单行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%A4%9A%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-text">3.2 多行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-text">3.3 单列索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%A4%9A%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-text">3.4 多行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-text">3.5 联合索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-iloc-%E7%B4%A2%E5%BC%95"><span class="toc-text">4 iloc 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%8D%95%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-text">4.1 单行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%A4%9A%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="toc-text">4.2 多行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-text">4.3 单列索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%A4%9A%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-text">4.4 多列索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-text">4.5 联合索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%B8%83%E5%B0%94%E7%B4%A2%E5%BC%95"><span class="toc-text">5 布尔索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">5.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E4%B8%AD%E6%8B%AC%E5%8F%B7"><span class="toc-text">5.2 直接使用中括号 []</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E7%BB%93%E5%90%88-loc-%E6%96%B9%E6%B3%95"><span class="toc-text">5.3 结合 .loc 方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E7%AD%9B%E9%80%89%E7%89%B9%E5%AE%9A%E5%80%BC"><span class="toc-text">5.4 筛选特定值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-text">5.5 处理缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-text">5.6 更新数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E6%B8%85%E6%B4%97"><span class="toc-text">数据的清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-text">1 缺失数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%A3%80%E6%B5%8B%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-text">1.1 检测缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%88%A0%E9%99%A4%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-text">1.2 删除缺失值</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-Drop"><span class="toc-text">1.2.1 Drop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-Dropna"><span class="toc-text">1.2.2 Dropna</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%A1%AB%E5%85%85%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-text">1.3 填充缺失值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%87%8D%E5%A4%8D%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">2 重复值处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-duplicated-%E6%A3%80%E6%B5%8B%E9%87%8D%E5%A4%8D%E8%A1%8C"><span class="toc-text">2.1 duplicated() 检测重复行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-drop-duplicates-%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E8%A1%8C"><span class="toc-text">2.2 drop_duplicates() 删除重复行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E6%9B%BF%E6%8D%A2"><span class="toc-text">3 数据替换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-replace"><span class="toc-text">3.1 replace</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-apply-%E4%B8%8E-applymap"><span class="toc-text">3.2 apply 与 applymap</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-text">时间字符串的处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-text">1 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-1%E3%80%81Python-%E5%8E%9F%E7%94%9F-datetime-%E6%A8%A1%E5%9D%97"><span class="toc-text">1.1 1、Python 原生 datetime 模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E3%80%81NumPy-%E7%9A%84-datetime64-%E7%B1%BB%E5%9E%8B"><span class="toc-text">1.2 、NumPy 的 datetime64 类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E2%80%8B3%E3%80%81Pandas-%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-text">1.3 ​3、Pandas 时间序列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%97%B6%E9%97%B4%E6%88%B3-Timestamp"><span class="toc-text">2 时间戳 Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E6%88%B3"><span class="toc-text">2.1 生成时间戳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-text">2.2 生成时间序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%97%B6%E9%97%B4%E7%9A%84%E7%B4%A2%E5%BC%95"><span class="toc-text">2.3 时间的索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%97%B6%E9%97%B4%E5%91%A8%E6%9C%9F-Period"><span class="toc-text">3 时间周期 Period</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E5%91%A8%E6%9C%9F"><span class="toc-text">3.1 生成时间周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-text">3.2 生成时间序列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%97%B6%E9%97%B4%E5%A2%9E%E9%87%8F"><span class="toc-text">4 时间增量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E5%A2%9E%E9%87%8F%EF%BC%88Timedelta%EF%BC%89"><span class="toc-text">4.1 生成时间增量（Timedelta）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E5%88%9B%E5%BB%BA-Timedelta-%E5%AF%B9%E8%B1%A1"><span class="toc-text">4.1.1 创建 Timedelta 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-%E6%97%B6%E9%97%B4%E8%BF%90%E7%AE%97"><span class="toc-text">4.1.2 时间运算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%97%A5%E6%9C%9F%E5%81%8F%E7%A7%BB%EF%BC%88DateOffset%EF%BC%89"><span class="toc-text">4.2 日期偏移（DateOffset）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E5%88%9B%E5%BB%BA-DateOffset-%E5%AF%B9%E8%B1%A1"><span class="toc-text">4.2.1 创建 DateOffset 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E4%B8%8E-Timedelta-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">4.2.2 与 Timedelta 的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%97%B6%E9%97%B4%E5%A2%9E%E9%87%8F%E7%B4%A2%E5%BC%95%EF%BC%88TimedeltaIndex%EF%BC%89"><span class="toc-text">4.3 时间增量索引（TimedeltaIndex）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E5%88%9B%E5%BB%BA-TimedeltaIndex"><span class="toc-text">4.3.1 创建 TimedeltaIndex</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-text">4.3.2 参数说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-%E7%94%9F%E6%88%90%E7%A4%BA%E4%BE%8B"><span class="toc-text">4.3.3 生成示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">4.4 应用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%81%8F%E7%A7%BB"><span class="toc-text">4.4.1 时间序列偏移</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E5%B7%AE%E5%BA%8F%E5%88%97"><span class="toc-text">4.4.2 生成时间差序列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-%E5%91%A8%E6%9C%9F%E6%80%A7%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6"><span class="toc-text">4.4.3 周期性任务调度</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%91%E9%87%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">向量化字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Python-%E4%B8%AD%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E6%B3%95"><span class="toc-text">1 Python 中字符串方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-pandas-%E5%90%91%E9%87%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E6%96%B9%E6%B3%95"><span class="toc-text">2 pandas 向量化字符方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-pandas-%E5%90%91%E9%87%8F%E5%8C%96%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">3 pandas 向量化正则表达式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8B%BC%E6%8E%A5%E5%92%8C%E5%90%88%E5%B9%B6"><span class="toc-text">数据的拼接和合并</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-concat-%E6%96%B9%E6%B3%95"><span class="toc-text">1 concat 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E7%BA%B5%E5%90%91%E5%90%88%E5%B9%B6%EF%BC%88%E9%BB%98%E8%AE%A4-axis-0%EF%BC%89"><span class="toc-text">1.1 纵向合并（默认 axis&#x3D;0）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%A8%AA%E5%90%91%E5%90%88%E5%B9%B6%EF%BC%88axis-1%EF%BC%89"><span class="toc-text">1.2 横向合并（axis&#x3D;1）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-merge-%E6%96%B9%E6%B3%95"><span class="toc-text">2 merge 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E5%90%88%E5%B9%B6%E6%96%B9%E5%BC%8F%EF%BC%9A"><span class="toc-text">2.1.1 使用不同的合并方式：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%88how-39-inner-39-%EF%BC%89"><span class="toc-text">2.2 内连接（how&#x3D;&#39;inner&#39;）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%B7%A6%E8%BF%9E%E6%8E%A5%EF%BC%88how-39-left-39-%EF%BC%89%E4%B8%8E%E5%88%97%E5%90%8D%E5%86%B2%E7%AA%81%E5%A4%84%E7%90%86"><span class="toc-text">2.3 左连接（how&#x3D;&#39;left&#39;）与列名冲突处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-join-%E6%96%B9%E6%B3%95"><span class="toc-text">3 join 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%97%E5%90%8D%E6%97%A0%E9%87%8D%E5%8F%A0"><span class="toc-text">3.1 列名无重叠</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%88%97%E5%90%8D%E6%9C%89%E9%87%8D%E5%8F%A0"><span class="toc-text">3.2 列名有重叠</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%88%86%E7%BB%84%E4%B8%8E%E8%81%9A%E5%90%88"><span class="toc-text">数据的分组与聚合</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%86%E7%BB%84"><span class="toc-text">1 分组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-text">1.1 基础数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E4%B8%8E%E5%90%88%E5%B9%B6%E6%95%B0%E6%8D%AE"><span class="toc-text">1.1.1 读取文件路径与合并数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-%E6%97%A5%E6%9C%9F%E5%88%97%E5%A4%84%E7%90%86%E4%BC%98%E5%8C%96"><span class="toc-text">1.1.2 日期列处理优化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E7%AE%80%E5%8D%95%E5%88%86%E7%BB%84"><span class="toc-text">1.2 简单分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%A4%9A%E9%87%8D%E5%88%86%E7%BB%84"><span class="toc-text">1.3 多重分组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%81%9A%E5%90%88"><span class="toc-text">2 聚合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E4%BD%BF%E7%94%A8%E5%86%85%E7%BD%AE%E7%BB%9F%E8%AE%A1%E6%96%B9%E6%B3%95%E8%81%9A%E5%90%88%E6%95%B0%E6%8D%AE"><span class="toc-text">2.1 使用内置统计方法聚合数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%88%A9%E7%94%A8-agg-%E8%BF%9B%E8%A1%8C%E7%AE%80%E5%8D%95%E7%9A%84%E8%81%9A%E5%90%88"><span class="toc-text">2.2 利用 agg 进行简单的聚合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-transform-%E5%87%BD%E6%95%B0"><span class="toc-text">2.3 transform 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%AF%B9%E6%AF%94-agg-%E4%B8%8E-transform"><span class="toc-text">2.4 对比 agg 与 transform</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E9%87%8D%E5%A1%91"><span class="toc-text">数据的重塑</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%B4%E5%90%91%E6%97%8B%E8%BD%AC"><span class="toc-text">轴向旋转</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-pivot%EF%BC%9A%E5%B0%86%E9%95%BF%E8%A1%A8%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%AE%BD%E8%A1%A8"><span class="toc-text">(1) pivot：将长表转换为宽表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-pivot-table%EF%BC%9A%E6%94%AF%E6%8C%81%E8%81%9A%E5%90%88%E7%9A%84%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="toc-text">(2) pivot_table：支持聚合的透视表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0"><span class="toc-text">堆叠</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-stack%EF%BC%9A%E5%B0%86%E5%88%97%E5%B1%82%E7%BA%A7%E7%B4%A2%E5%BC%95%E5%A0%86%E5%8F%A0%E5%88%B0%E8%A1%8C"><span class="toc-text">(1) stack：将列层级索引堆叠到行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-unstack%EF%BC%9A%E5%B0%86%E8%A1%8C%E5%B1%82%E7%BA%A7%E7%B4%A2%E5%BC%95%E5%B1%95%E5%BC%80%E5%88%B0%E5%88%97"><span class="toc-text">(2) unstack：将行层级索引展开到列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-text">表格数据可视化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%9F%BA%E7%A1%80%E5%A4%84%E7%90%86"><span class="toc-text">数据基础处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%98%E7%BA%BF%E5%9B%BE"><span class="toc-text">折线图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E5%9C%B0%E7%82%B9"><span class="toc-text">单个地点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E5%9C%B0%E7%82%B9"><span class="toc-text">多个地点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%B1%E7%8A%B6%E5%9B%BE"><span class="toc-text">柱状图</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/29/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/13_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E6%A6%82%E7%8E%87%E5%9B%BE%E6%A8%A1%E5%9E%8B/" title="13_机器学习_概率图模型">13_机器学习_概率图模型</a><time datetime="2025-07-29T00:29:02.000Z" title="发表于 2025-07-29 08:29:02">2025-07-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/11_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E8%81%9A%E7%B1%BB/" title="11_机器学习_聚类">11_机器学习_聚类</a><time datetime="2025-07-28T00:19:53.000Z" title="发表于 2025-07-28 08:19:53">2025-07-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/12_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E9%99%8D%E7%BB%B4/" title="12_机器学习_降维">12_机器学习_降维</a><time datetime="2025-07-27T20:48:42.000Z" title="发表于 2025-07-28 04:48:42">2025-07-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/26/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/10_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/" title="10_机器学习_集成学习">10_机器学习_集成学习</a><time datetime="2025-07-26T01:58:53.000Z" title="发表于 2025-07-26 09:58:53">2025-07-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/09_%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0_%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/" title="09_机器学习_朴素贝叶斯">09_机器学习_朴素贝叶斯</a><time datetime="2025-07-25T03:08:47.000Z" title="发表于 2025-07-25 11:08:47">2025-07-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./img/1.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Scenery</div><div class="footer_custom_text"><div>波澜不惊</div><div class="footer-div"><img class="footer-icon" src="./img/备案图标.png"><a class="footer-a" target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">皖ICP备2021016944号-1</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>